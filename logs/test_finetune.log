INFO:datadog.api:No agent or invalid configuration file found
WARNING:root:command line args [-c confs/fine_tune/progressive.json -s amazon-beauty -l amazon-100K -i test.pth -p confs/pre_train/config_dict_100K.json -o fine_tuned_checkpoint.pth] will not be used in RecBole
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
INFO:faiss.loader:Loading faiss.
INFO:faiss.loader:Successfully loaded faiss.
INFO:root:[1;35m[Training]: [0m[1;36mtrain_batch_size[0m = [1;33m[128][0m[1;36m train_neg_sample_args[0m: [1;33m[{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}][0m
INFO:root:[1;35m[Evaluation]: [0m[1;36meval_batch_size[0m = [1;33m[128][0m[1;36m eval_args[0m: [1;33m[{'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}][0m
2024-07-10 10:40:48 pid 8099 | starting to iterate fitting ewc (total=3000), updating every 1 seconds
2024-07-10 10:40:50 pid 8099 | 4 of 3000, 0.1% of fitting ewc, speed: 2.02 it/s, elapsed 0.50 seconds, eta 24.77 minutes
2024-07-10 10:40:51 pid 8099 | 7 of 3000, 0.2% of fitting ewc, speed: 2.04 it/s, elapsed 1.96 seconds, eta 24.41 minutes
2024-07-10 10:40:53 pid 8099 | 10 of 3000, 0.3% of fitting ewc, speed: 2.04 it/s, elapsed 3.42 seconds, eta 24.38 minutes
2024-07-10 10:40:54 pid 8099 | 13 of 3000, 0.4% of fitting ewc, speed: 2.04 it/s, elapsed 4.90 seconds, eta 24.38 minutes
2024-07-10 10:40:56 pid 8099 | 16 of 3000, 0.5% of fitting ewc, speed: 2.04 it/s, elapsed 6.37 seconds, eta 24.37 minutes
2024-07-10 10:40:57 pid 8099 | 19 of 3000, 0.6% of fitting ewc, speed: 2.01 it/s, elapsed 7.96 seconds, eta 24.72 minutes
2024-07-10 10:40:59 pid 8099 | 22 of 3000, 0.7% of fitting ewc, speed: 2.01 it/s, elapsed 9.45 seconds, eta 24.69 minutes
2024-07-10 10:41:00 pid 8099 | print interval is now 5s
2024-07-10 10:41:04 pid 8099 | 33 of 3000, 1.1% of fitting ewc, speed: 2.02 it/s, elapsed 14.86 seconds, eta 24.49 minutes
2024-07-10 10:41:10 pid 8099 | 44 of 3000, 1.5% of fitting ewc, speed: 2.02 it/s, elapsed 20.27 seconds, eta 24.36 minutes
2024-07-10 10:41:15 pid 8099 | 55 of 3000, 1.8% of fitting ewc, speed: 2.03 it/s, elapsed 25.67 seconds, eta 24.23 minutes
2024-07-10 10:41:19 pid 8099 | print interval is now 30s
2024-07-10 10:41:45 pid 8099 | 116 of 3000, 3.9% of fitting ewc, speed: 2.02 it/s, elapsed 55.86 seconds, eta 23.76 minutes
2024-07-10 10:42:15 pid 8099 | 177 of 3000, 5.9% of fitting ewc, speed: 2.02 it/s, elapsed 1.43 minutes, eta 23.24 minutes
2024-07-10 10:42:45 pid 8099 | 238 of 3000, 7.9% of fitting ewc, speed: 2.02 it/s, elapsed 1.93 minutes, eta 22.73 minutes
2024-07-10 10:43:15 pid 8099 | 299 of 3000, 10.0% of fitting ewc, speed: 2.03 it/s, elapsed 2.43 minutes, eta 22.22 minutes
2024-07-10 10:43:46 pid 8099 | 360 of 3000, 12.0% of fitting ewc, speed: 2.03 it/s, elapsed 2.94 minutes, eta 21.72 minutes
2024-07-10 10:44:16 pid 8099 | 421 of 3000, 14.0% of fitting ewc, speed: 2.02 it/s, elapsed 3.44 minutes, eta 21.23 minutes
2024-07-10 10:44:46 pid 8099 | 482 of 3000, 16.1% of fitting ewc, speed: 2.03 it/s, elapsed 3.94 minutes, eta 20.72 minutes
2024-07-10 10:45:16 pid 8099 | 543 of 3000, 18.1% of fitting ewc, speed: 2.02 it/s, elapsed 4.45 minutes, eta 20.23 minutes
2024-07-10 10:45:47 pid 8099 | 605 of 3000, 20.2% of fitting ewc, speed: 2.03 it/s, elapsed 4.95 minutes, eta 19.71 minutes
2024-07-10 10:45:49 pid 8099 | print interval is now 60s
2024-07-10 10:46:00 pid 8099 | 632 of 3000, 21.1% of fitting ewc, speed: 2.03 it/s, elapsed 5.18 minutes, eta 19.48 minutes
2024-07-10 10:46:00 pid 8099 | finished fitting ewc. Total time: 5.18 minutes
WARNING:root:command line args [-c confs/fine_tune/progressive.json -s amazon-beauty -l amazon-100K -i test.pth -p confs/pre_train/config_dict_100K.json -o fine_tuned_checkpoint.pth] will not be used in RecBole
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
INFO:faiss.loader:Loading faiss.
INFO:faiss.loader:Successfully loaded faiss.
Large dataset
INFO:root:[1;35mamazon-100K[0m
[1;34mThe number of users[0m: 6211
[1;34mAverage actions of users[0m: 16.010305958132044
[1;34mThe number of items[0m: 86909
[1;34mAverage actions of items[0m: 1.1440143600128871
[1;34mThe number of inters[0m: 99424
[1;34mThe sparsity of the dataset[0m: 99.98158104658422%
[1;34mRemain Fields[0m: ['user_id', 'item_id', 'rating', 'timestamp', 'title', 'brand']
INFO:root:[1;35m[Training]: [0m[1;36mtrain_batch_size[0m = [1;33m[128][0m[1;36m train_neg_sample_args[0m: [1;33m[{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}][0m
INFO:root:[1;35m[Evaluation]: [0m[1;36meval_batch_size[0m = [1;33m[128][0m[1;36m eval_args[0m: [1;33m[{'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}][0m
WARNING:root:command line args [-c confs/fine_tune/progressive.json -s amazon-beauty -l amazon-100K -i test.pth -p confs/pre_train/config_dict_100K.json -o fine_tuned_checkpoint.pth] will not be used in RecBole
Small dataset
INFO:root:[1;35mamazon-beauty[0m
[1;34mThe number of users[0m: 5591
[1;34mAverage actions of users[0m: 1.2733452593917711
[1;34mThe number of items[0m: 504
[1;34mAverage actions of items[0m: 14.151093439363818
[1;34mThe number of inters[0m: 7118
[1;34mThe sparsity of the dataset[0m: 99.74739731938801%
[1;34mRemain Fields[0m: ['user_id', 'item_id', 'rating', 'timestamp', 'title', 'brand']
INFO:root:[1;35m[Training]: [0m[1;36mtrain_batch_size[0m = [1;33m[200][0m[1;36m train_neg_sample_args[0m: [1;33m[{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}][0m
INFO:root:[1;35m[Evaluation]: [0m[1;36meval_batch_size[0m = [1;33m[128][0m[1;36m eval_args[0m: [1;33m[{'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}][0m
item features
The batch_size of interaction: 504
    item_id, torch.Size([504]), cuda, torch.int64
    title, torch.Size([504, 40]), cuda, torch.int64
    brand, torch.Size([504, 7]), cuda, torch.int64


example
['‚ñÅcra' 'bt' 'ree' '‚ñÅamp' '‚ñÅevelyn' '‚ñÅgardener' '‚ñÅs' '‚ñÅultra' '‚ñÅmoistur'
 'ising' '‚ñÅhand' '‚ñÅtherapy' '‚ñÅpump' '‚ñÅ250' 'g' '‚ñÅ8' '‚ñÅ8' '‚ñÅoz' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]']
INFO:alembic.runtime.migration:Context impl SQLiteImpl.
INFO:alembic.runtime.migration:Will assume non-transactional DDL.
2024-07-10 10:46:17 pid 8138 | starting to iterate Evaluate in test    (total=3), updating every 1 seconds
2024-07-10 10:46:17 pid 8138 | 0 of 3, 0.0% of Evaluate in test   , speed: -0.00 s/it, elapsed 0.05 seconds, GPU RAM: 4.21 G/15.78 G
2024-07-10 10:46:17 pid 8138 | finished Evaluate in test   . Total time: 0.05 seconds
OrderedDict([('recall@5', 0.0951), ('mrr@5', 0.0389), ('ndcg@5', 0.053), ('hit@5', 0.0951), ('precision@5', 0.019), ('test_loss', 5.833066463470459)])
Saving adapted model to /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/adapted_model.pth
INFO:root:[1;34mSaving current[0m: /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/adapted_model.pth
Saving adapted dataset to /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/amazon-beauty.pkl
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
INFO:faiss.loader:Loading faiss.
INFO:faiss.loader:Successfully loaded faiss.
WARNING:root:command line args [-c confs/fine_tune/progressive.json -s amazon-beauty -l amazon-100K -i test.pth -p confs/pre_train/config_dict_100K.json -o fine_tuned_checkpoint.pth] will not be used in RecBole

[1;35mGeneral Hyper Parameters:
[0m[1;36mgpu_id[0m =[1;33m 0[0m
[1;36muse_gpu[0m =[1;33m True[0m
[1;36mseed[0m =[1;33m 2020[0m
[1;36mstate[0m =[1;33m INFO[0m
[1;36mreproducibility[0m =[1;33m True[0m
[1;36mdata_path[0m =[1;33m /alloc/data/srt/data/output/amazon-beauty[0m
[1;36mcheckpoint_dir[0m =[1;33m saved[0m
[1;36mshow_progress[0m =[1;33m True[0m
[1;36msave_dataset[0m =[1;33m False[0m
[1;36mdataset_save_path[0m =[1;33m None[0m
[1;36msave_dataloaders[0m =[1;33m False[0m
[1;36mdataloaders_save_path[0m =[1;33m None[0m
[1;36mlog_wandb[0m =[1;33m False[0m

[1;35mTraining Hyper Parameters:
[0m[1;36mepochs[0m =[1;33m 2[0m
[1;36mtrain_batch_size[0m =[1;33m 128[0m
[1;36mlearner[0m =[1;33m adam[0m
[1;36mlearning_rate[0m =[1;33m 0.0001[0m
[1;36mtrain_neg_sample_args[0m =[1;33m {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}[0m
[1;36meval_step[0m =[1;33m 1[0m
[1;36mstopping_step[0m =[1;33m 20[0m
[1;36mclip_grad_norm[0m =[1;33m None[0m
[1;36mweight_decay[0m =[1;33m 1e-05[0m
[1;36mloss_decimal_place[0m =[1;33m 4[0m

[1;35mEvaluation Hyper Parameters:
[0m[1;36meval_args[0m =[1;33m {'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}[0m
[1;36mrepeatable[0m =[1;33m True[0m
[1;36mmetrics[0m =[1;33m ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision'][0m
[1;36mtopk[0m =[1;33m [5][0m
[1;36mvalid_metric[0m =[1;33m mrr@5[0m
[1;36mvalid_metric_bigger[0m =[1;33m True[0m
[1;36meval_batch_size[0m =[1;33m 128[0m
[1;36mmetric_decimal_place[0m =[1;33m 4[0m

[1;35mDataset Hyper Parameters:
[0m[1;36mfield_separator[0m =[1;33m 	[0m
[1;36mseq_separator[0m =[1;33m  [0m
[1;36mUSER_ID_FIELD[0m =[1;33m user_id[0m
[1;36mITEM_ID_FIELD[0m =[1;33m item_id[0m
[1;36mRATING_FIELD[0m =[1;33m rating[0m
[1;36mTIME_FIELD[0m =[1;33m timestamp[0m
[1;36mseq_len[0m =[1;33m None[0m
[1;36mLABEL_FIELD[0m =[1;33m label[0m
[1;36mthreshold[0m =[1;33m None[0m
[1;36mNEG_PREFIX[0m =[1;33m neg_[0m
[1;36mload_col[0m =[1;33m {'inter': ['user_id', 'item_id', 'rating', 'timestamp'], 'item': ['item_id', 'title', 'brand']}[0m
[1;36munload_col[0m =[1;33m None[0m
[1;36munused_col[0m =[1;33m None[0m
[1;36madditional_feat_suffix[0m =[1;33m None[0m
[1;36mrm_dup_inter[0m =[1;33m None[0m
[1;36mval_interval[0m =[1;33m None[0m
[1;36mfilter_inter_by_user_or_item[0m =[1;33m True[0m
[1;36muser_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36mitem_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36malias_of_user_id[0m =[1;33m None[0m
[1;36malias_of_item_id[0m =[1;33m None[0m
[1;36malias_of_entity_id[0m =[1;33m None[0m
[1;36malias_of_relation_id[0m =[1;33m None[0m
[1;36mpreload_weight[0m =[1;33m None[0m
[1;36mnormalize_field[0m =[1;33m None[0m
[1;36mnormalize_all[0m =[1;33m None[0m
[1;36mITEM_LIST_LENGTH_FIELD[0m =[1;33m item_length[0m
[1;36mLIST_SUFFIX[0m =[1;33m _list[0m
[1;36mMAX_ITEM_LIST_LENGTH[0m =[1;33m 50[0m
[1;36mPOSITION_FIELD[0m =[1;33m position_id[0m
[1;36mHEAD_ENTITY_ID_FIELD[0m =[1;33m head_id[0m
[1;36mTAIL_ENTITY_ID_FIELD[0m =[1;33m tail_id[0m
[1;36mRELATION_ID_FIELD[0m =[1;33m relation_id[0m
[1;36mENTITY_ID_FIELD[0m =[1;33m entity_id[0m
[1;36mbenchmark_filename[0m =[1;33m None[0m

[1;35mOther Hyper Parameters: 
[0m[1;36mworker[0m = [1;33m0[0m
[1;36mwandb_project[0m = [1;33mrecbole[0m
[1;36mshuffle[0m = [1;33mTrue[0m
[1;36mrequire_pow[0m = [1;33mFalse[0m
[1;36menable_amp[0m = [1;33mFalse[0m
[1;36menable_scaler[0m = [1;33mFalse[0m
[1;36mtransform[0m = [1;33mNone[0m
[1;36mn_layers[0m = [1;33m16[0m
[1;36mn_heads[0m = [1;33m4[0m
[1;36mhidden_size[0m = [1;33m256[0m
[1;36minner_size[0m = [1;33m256[0m
[1;36mhidden_dropout_prob[0m = [1;33m0.5[0m
[1;36mattn_dropout_prob[0m = [1;33m0.5[0m
[1;36mhidden_act[0m = [1;33mgelu[0m
[1;36mlayer_norm_eps[0m = [1;33m1e-12[0m
[1;36minitializer_range[0m = [1;33m0.02[0m
[1;36mselected_features[0m = [1;33m['title', 'brand'][0m
[1;36mpooling_mode[0m = [1;33msum[0m
[1;36mloss_type[0m = [1;33mInfoNCE-quick[0m
[1;36mnumerical_features[0m = [1;33m[][0m
[1;36mdiscretization[0m = [1;33mNone[0m
[1;36mkg_reverse_r[0m = [1;33mFalse[0m
[1;36mentity_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mrelation_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mMODEL_TYPE[0m = [1;33mModelType.SEQUENTIAL[0m
[1;36mmlflow[0m = [1;33m{'enable': True, 'experiment_name': 'fine-tune', 'run_name': '0f5d1302-97f4-4127-9cee-a6a702a5625b', 'tracking_uri': 'sqlite:///mlruns.sqlite', 'auto_continue': True}[0m
[1;36mmax_grad_norm[0m = [1;33m1.0[0m
[1;36mscheduler[0m = [1;33m{'type': 'one-cycle'}[0m
[1;36mnce_temperature[0m = [1;33m1[0m
[1;36mnce_label_smoothing[0m = [1;33m0.0[0m
[1;36mnormalize_embedding[0m = [1;33mFalse[0m
[1;36mevaluation_mode[0m = [1;33msampled50000[0m
[1;36mestimate_batch_size[0m = [1;33mFalse[0m
[1;36mnce_num_negatives[0m = [1;33m300[0m
[1;36mnce_sampling_strategy[0m = [1;33mpopularity[0m
[1;36mnce_global_negatives[0m = [1;33mFalse[0m
[1;36mgradient_accumulation_steps[0m = [1;33m10[0m
[1;36meval_type[0m = [1;33mEvaluatorType.RANKING[0m
[1;36msingle_spec[0m = [1;33mTrue[0m
[1;36mlocal_rank[0m = [1;33m0[0m
[1;36mdevice[0m = [1;33mcuda[0m
[1;36mvalid_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m
[1;36mtest_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m


INFO:root:[1;35m[Training]: [0m[1;36mtrain_batch_size[0m = [1;33m[128][0m[1;36m train_neg_sample_args[0m: [1;33m[{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}][0m
INFO:root:[1;35m[Evaluation]: [0m[1;36meval_batch_size[0m = [1;33m[128][0m[1;36m eval_args[0m: [1;33m[{'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}][0m
item features
The batch_size of interaction: 504
    item_id, torch.Size([504]), cuda, torch.int64
    title, torch.Size([504, 40]), cuda, torch.int64
    brand, torch.Size([504, 7]), cuda, torch.int64


example
['‚ñÅcra' 'bt' 'ree' '‚ñÅamp' '‚ñÅevelyn' '‚ñÅgardener' '‚ñÅs' '‚ñÅultra' '‚ñÅmoistur'
 'ising' '‚ñÅhand' '‚ñÅtherapy' '‚ñÅpump' '‚ñÅ250' 'g' '‚ñÅ8' '‚ñÅ8' '‚ñÅoz' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]']
INFO:alembic.runtime.migration:Context impl SQLiteImpl.
INFO:alembic.runtime.migration:Will assume non-transactional DDL.
Continuing run e881606f1e3a48a18e06b815e9d7c501
Evaluation sanity
****************************************
2024-07-10 10:46:21 pid 8147 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:46:22 pid 8147 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.61 seconds, [1;33mGPU RAM: 2.27 G/15.78 G[0m
2024-07-10 10:46:22 pid 8147 | finished [1;35mEvaluate in test   [0m. Total time: 0.61 seconds
OrderedDict([('recall@5', 0.1351), ('mrr@5', 0.0613), ('ndcg@5', 0.0798), ('hit@5', 0.1351), ('precision@5', 0.027), ('test_loss', 6.291838645935059)])
****************************************
Freezing embeddings
Freezing layer 0
Freezing layer 1
Freezing layer 2
Freezing layer 3
Freezing layer 4
Freezing layer 5
Freezing layer 6
Freezing layer 7
Freezing layer 8
Freezing layer 9
Freezing layer 10
Freezing layer 11
Freezing layer 12
Freezing layer 13
Freezing layer 14
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 527616 but failed
tried to log param model_non_emb_params with value -10727680 but failed
2024-07-10 10:46:22 pid 8147 | starting to iterate Train     0 (total=3), updating every 1 seconds
2024-07-10 10:46:24 pid 8147 | 0 of 3, 0.0% of Train     0, speed: -0.00 s/it, elapsed 0.43 seconds, [1;31mGPU RAM: 5.26 G/15.78 G loss: 6.09669[0m
2024-07-10 10:46:24 pid 8147 | finished Train     0. Total time: 0.43 seconds
INFO:root:[1;32mepoch 0 training[0m [[1;34mtime[0m: 1.38s, [1;34mtrain loss[0m: 6.1333]
2024-07-10 10:46:24 pid 8147 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:46:24 pid 8147 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.28 G/15.78 G[0m
2024-07-10 10:46:24 pid 8147 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.0588), ('mrr@5', 0.0196), ('ndcg@5', 0.0294), ('hit@5', 0.0588), ('precision@5', 0.0118), ('valid_loss', 6.326618671417236)])
INFO:root:[1;32mepoch 0 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.019600]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.0588    mrr@5 : 0.0196    ndcg@5 : 0.0294    hit@5 : 0.0588    precision@5 : 0.0118    valid_loss : 6.326618671417236
2024-07-10 10:46:24 pid 8147 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.0859), ('mrr@5', 0.0417), ('ndcg@5', 0.053), ('hit@5', 0.0859), ('precision@5', 0.0172)])
2024-07-10 10:46:24 pid 8147 | starting to iterate Train     1 (total=3), updating every 1 seconds
2024-07-10 10:46:25 pid 8147 | 0 of 3, 0.0% of Train     1, speed: -0.00 s/it, elapsed 0.43 seconds, [1;31mGPU RAM: 5.28 G/15.78 G loss: 6.19010[0m
2024-07-10 10:46:25 pid 8147 | finished Train     1. Total time: 0.43 seconds
INFO:root:[1;32mepoch 1 training[0m [[1;34mtime[0m: 1.38s, [1;34mtrain loss[0m: 6.1463]
2024-07-10 10:46:25 pid 8147 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:46:25 pid 8147 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.28 G/15.78 G[0m
2024-07-10 10:46:25 pid 8147 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.0588), ('mrr@5', 0.0196), ('ndcg@5', 0.0294), ('hit@5', 0.0588), ('precision@5', 0.0118), ('valid_loss', 6.32512092590332)])
INFO:root:[1;32mepoch 1 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.019600]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.0588    mrr@5 : 0.0196    ndcg@5 : 0.0294    hit@5 : 0.0588    precision@5 : 0.0118    valid_loss : 6.32512092590332
2024-07-10 10:46:25 pid 8147 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.0859), ('mrr@5', 0.0417), ('ndcg@5', 0.053), ('hit@5', 0.0859), ('precision@5', 0.0172)])
2024-07-10 10:46:26 pid 8147 | starting to iterate Train     2 (total=3), updating every 1 seconds
2024-07-10 10:46:27 pid 8147 | 0 of 3, 0.0% of Train     2, speed: -0.00 s/it, elapsed 0.43 seconds, [1;31mGPU RAM: 5.28 G/15.78 G loss: 6.03336[0m
2024-07-10 10:46:27 pid 8147 | finished Train     2. Total time: 0.43 seconds
INFO:root:[1;32mepoch 2 training[0m [[1;34mtime[0m: 1.36s, [1;34mtrain loss[0m: 6.2618]
2024-07-10 10:46:27 pid 8147 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:46:27 pid 8147 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.28 G/15.78 G[0m
2024-07-10 10:46:27 pid 8147 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.0588), ('mrr@5', 0.0196), ('ndcg@5', 0.0294), ('hit@5', 0.0588), ('precision@5', 0.0118), ('valid_loss', 6.36663293838501)])
INFO:root:[1;32mepoch 2 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.019600]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.0588    mrr@5 : 0.0196    ndcg@5 : 0.0294    hit@5 : 0.0588    precision@5 : 0.0118    valid_loss : 6.36663293838501
2024-07-10 10:46:27 pid 8147 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.0938), ('mrr@5', 0.0432), ('ndcg@5', 0.056), ('hit@5', 0.0938), ('precision@5', 0.0188)])
2024-07-10 10:46:27 pid 8147 | starting to iterate Train     3 (total=3), updating every 1 seconds
2024-07-10 10:46:29 pid 8147 | 0 of 3, 0.0% of Train     3, speed: -0.00 s/it, elapsed 0.43 seconds, [1;31mGPU RAM: 5.28 G/15.78 G loss: 6.13012[0m
2024-07-10 10:46:29 pid 8147 | finished Train     3. Total time: 0.43 seconds
INFO:root:[1;32mepoch 3 training[0m [[1;34mtime[0m: 1.35s, [1;34mtrain loss[0m: 6.1236]
2024-07-10 10:46:29 pid 8147 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:46:29 pid 8147 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.28 G/15.78 G[0m
2024-07-10 10:46:29 pid 8147 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.0588), ('mrr@5', 0.0196), ('ndcg@5', 0.0294), ('hit@5', 0.0588), ('precision@5', 0.0118), ('valid_loss', 6.383991241455078)])
INFO:root:[1;32mepoch 3 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.019600]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.0588    mrr@5 : 0.0196    ndcg@5 : 0.0294    hit@5 : 0.0588    precision@5 : 0.0118    valid_loss : 6.383991241455078
2024-07-10 10:46:29 pid 8147 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.0938), ('mrr@5', 0.0439), ('ndcg@5', 0.0565), ('hit@5', 0.0938), ('precision@5', 0.0188)])
2024-07-10 10:46:29 pid 8147 | starting to iterate Train     4 (total=3), updating every 1 seconds
2024-07-10 10:46:30 pid 8147 | 0 of 3, 0.0% of Train     4, speed: -0.00 s/it, elapsed 0.43 seconds, [1;31mGPU RAM: 5.28 G/15.78 G loss: 6.17711[0m
2024-07-10 10:46:30 pid 8147 | finished Train     4. Total time: 0.43 seconds
INFO:root:[1;32mepoch 4 training[0m [[1;34mtime[0m: 1.37s, [1;34mtrain loss[0m: 6.1172]
2024-07-10 10:46:30 pid 8147 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:46:30 pid 8147 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.28 G/15.78 G[0m
2024-07-10 10:46:30 pid 8147 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.0588), ('mrr@5', 0.0196), ('ndcg@5', 0.0294), ('hit@5', 0.0588), ('precision@5', 0.0118), ('valid_loss', 6.3528618812561035)])
INFO:root:[1;32mepoch 4 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.019600]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.0588    mrr@5 : 0.0196    ndcg@5 : 0.0294    hit@5 : 0.0588    precision@5 : 0.0118    valid_loss : 6.3528618812561035
2024-07-10 10:46:30 pid 8147 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.0938), ('mrr@5', 0.0426), ('ndcg@5', 0.0555), ('hit@5', 0.0938), ('precision@5', 0.0188)])
2024-07-10 10:46:30 pid 8147 | starting to iterate Train     5 (total=3), updating every 1 seconds
2024-07-10 10:46:32 pid 8147 | 0 of 3, 0.0% of Train     5, speed: -0.00 s/it, elapsed 0.43 seconds, [1;31mGPU RAM: 5.28 G/15.78 G loss: 6.07265[0m
2024-07-10 10:46:32 pid 8147 | finished Train     5. Total time: 0.43 seconds
INFO:root:[1;32mepoch 5 training[0m [[1;34mtime[0m: 1.37s, [1;34mtrain loss[0m: 6.1746]
2024-07-10 10:46:32 pid 8147 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:46:32 pid 8147 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.28 G/15.78 G[0m
2024-07-10 10:46:32 pid 8147 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.0588), ('mrr@5', 0.0196), ('ndcg@5', 0.0294), ('hit@5', 0.0588), ('precision@5', 0.0118), ('valid_loss', 6.395691871643066)])
INFO:root:[1;32mepoch 5 evaluating[0m [[1;34mtime[0m: 0.15s, [1;34mvalid_score[0m: 0.019600]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.0588    mrr@5 : 0.0196    ndcg@5 : 0.0294    hit@5 : 0.0588    precision@5 : 0.0118    valid_loss : 6.395691871643066
2024-07-10 10:46:32 pid 8147 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.0938), ('mrr@5', 0.0423), ('ndcg@5', 0.0553), ('hit@5', 0.0938), ('precision@5', 0.0188)])
2024-07-10 10:46:32 pid 8147 | starting to iterate Train     6 (total=3), updating every 1 seconds
2024-07-10 10:46:34 pid 8147 | 0 of 3, 0.0% of Train     6, speed: -0.00 s/it, elapsed 0.44 seconds, [1;31mGPU RAM: 5.28 G/15.78 G loss: 6.03542[0m
2024-07-10 10:46:34 pid 8147 | finished Train     6. Total time: 0.44 seconds
INFO:root:[1;32mepoch 6 training[0m [[1;34mtime[0m: 1.37s, [1;34mtrain loss[0m: 6.1085]
2024-07-10 10:46:34 pid 8147 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:46:34 pid 8147 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.28 G/15.78 G[0m
2024-07-10 10:46:34 pid 8147 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.0588), ('mrr@5', 0.0196), ('ndcg@5', 0.0294), ('hit@5', 0.0588), ('precision@5', 0.0118), ('valid_loss', 6.349034309387207)])
INFO:root:[1;32mepoch 6 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.019600]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.0588    mrr@5 : 0.0196    ndcg@5 : 0.0294    hit@5 : 0.0588    precision@5 : 0.0118    valid_loss : 6.349034309387207
2024-07-10 10:46:34 pid 8147 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.0938), ('mrr@5', 0.0462), ('ndcg@5', 0.0582), ('hit@5', 0.0938), ('precision@5', 0.0188)])
2024-07-10 10:46:34 pid 8147 | starting to iterate Train     7 (total=3), updating every 1 seconds
2024-07-10 10:46:35 pid 8147 | 0 of 3, 0.0% of Train     7, speed: -0.00 s/it, elapsed 0.43 seconds, [1;31mGPU RAM: 5.28 G/15.78 G loss: 5.98765[0m
2024-07-10 10:46:35 pid 8147 | finished Train     7. Total time: 0.43 seconds
INFO:root:[1;32mepoch 7 training[0m [[1;34mtime[0m: 1.37s, [1;34mtrain loss[0m: 6.0848]
2024-07-10 10:46:35 pid 8147 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:46:35 pid 8147 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.28 G/15.78 G[0m
2024-07-10 10:46:35 pid 8147 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.0588), ('mrr@5', 0.0196), ('ndcg@5', 0.0294), ('hit@5', 0.0588), ('precision@5', 0.0118), ('valid_loss', 6.3253679275512695)])
INFO:root:[1;32mepoch 7 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.019600]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.0588    mrr@5 : 0.0196    ndcg@5 : 0.0294    hit@5 : 0.0588    precision@5 : 0.0118    valid_loss : 6.3253679275512695
2024-07-10 10:46:35 pid 8147 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.0938), ('mrr@5', 0.0462), ('ndcg@5', 0.0582), ('hit@5', 0.0938), ('precision@5', 0.0188)])
2024-07-10 10:46:35 pid 8147 | starting to iterate Train     8 (total=3), updating every 1 seconds
2024-07-10 10:46:37 pid 8147 | 0 of 3, 0.0% of Train     8, speed: -0.00 s/it, elapsed 0.43 seconds, [1;31mGPU RAM: 5.28 G/15.78 G loss: 6.01915[0m
2024-07-10 10:46:37 pid 8147 | finished Train     8. Total time: 0.43 seconds
INFO:root:[1;32mepoch 8 training[0m [[1;34mtime[0m: 1.36s, [1;34mtrain loss[0m: 6.0216]
2024-07-10 10:46:37 pid 8147 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:46:37 pid 8147 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.28 G/15.78 G[0m
2024-07-10 10:46:37 pid 8147 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.0588), ('mrr@5', 0.0196), ('ndcg@5', 0.0294), ('hit@5', 0.0588), ('precision@5', 0.0118), ('valid_loss', 6.460474967956543)])
INFO:root:[1;32mepoch 8 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.019600]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.0588    mrr@5 : 0.0196    ndcg@5 : 0.0294    hit@5 : 0.0588    precision@5 : 0.0118    valid_loss : 6.460474967956543
2024-07-10 10:46:37 pid 8147 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1016), ('mrr@5', 0.0478), ('ndcg@5', 0.0612), ('hit@5', 0.1016), ('precision@5', 0.0203)])
2024-07-10 10:46:37 pid 8147 | starting to iterate Train     9 (total=3), updating every 1 seconds
2024-07-10 10:46:38 pid 8147 | 0 of 3, 0.0% of Train     9, speed: -0.00 s/it, elapsed 0.43 seconds, [1;31mGPU RAM: 5.28 G/15.78 G loss: 5.85494[0m
2024-07-10 10:46:38 pid 8147 | finished Train     9. Total time: 0.43 seconds
INFO:root:[1;32mepoch 9 training[0m [[1;34mtime[0m: 1.37s, [1;34mtrain loss[0m: 6.1462]
2024-07-10 10:46:39 pid 8147 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:46:39 pid 8147 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.28 G/15.78 G[0m
2024-07-10 10:46:39 pid 8147 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.0588), ('mrr@5', 0.0196), ('ndcg@5', 0.0294), ('hit@5', 0.0588), ('precision@5', 0.0118), ('valid_loss', 6.339641094207764)])
INFO:root:[1;32mepoch 9 evaluating[0m [[1;34mtime[0m: 0.15s, [1;34mvalid_score[0m: 0.019600]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.0588    mrr@5 : 0.0196    ndcg@5 : 0.0294    hit@5 : 0.0588    precision@5 : 0.0118    valid_loss : 6.339641094207764
2024-07-10 10:46:39 pid 8147 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1016), ('mrr@5', 0.0474), ('ndcg@5', 0.0609), ('hit@5', 0.1016), ('precision@5', 0.0203)])
Saving checkpoint on /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/01.pth
INFO:root:[1;34mSaving current[0m: /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/01.pth
2024-07-10 10:46:39 pid 8147 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:46:39 pid 8147 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.28 G/15.78 G[0m
2024-07-10 10:46:39 pid 8147 | finished [1;35mEvaluate in test   [0m. Total time: 0.05 seconds
OrderedDict([('recall@5', 0.1351), ('mrr@5', 0.0541), ('ndcg@5', 0.0745), ('hit@5', 0.1351), ('precision@5', 0.027), ('test_loss', 6.240971565246582)])
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
INFO:faiss.loader:Loading faiss.
INFO:faiss.loader:Successfully loaded faiss.
WARNING:root:command line args [-c confs/fine_tune/progressive.json -s amazon-beauty -l amazon-100K -i test.pth -p confs/pre_train/config_dict_100K.json -o fine_tuned_checkpoint.pth] will not be used in RecBole

[1;35mGeneral Hyper Parameters:
[0m[1;36mgpu_id[0m =[1;33m 0[0m
[1;36muse_gpu[0m =[1;33m True[0m
[1;36mseed[0m =[1;33m 2020[0m
[1;36mstate[0m =[1;33m INFO[0m
[1;36mreproducibility[0m =[1;33m True[0m
[1;36mdata_path[0m =[1;33m /alloc/data/srt/data/output/amazon-beauty[0m
[1;36mcheckpoint_dir[0m =[1;33m saved[0m
[1;36mshow_progress[0m =[1;33m True[0m
[1;36msave_dataset[0m =[1;33m False[0m
[1;36mdataset_save_path[0m =[1;33m None[0m
[1;36msave_dataloaders[0m =[1;33m False[0m
[1;36mdataloaders_save_path[0m =[1;33m None[0m
[1;36mlog_wandb[0m =[1;33m False[0m

[1;35mTraining Hyper Parameters:
[0m[1;36mepochs[0m =[1;33m 2[0m
[1;36mtrain_batch_size[0m =[1;33m 128[0m
[1;36mlearner[0m =[1;33m adam[0m
[1;36mlearning_rate[0m =[1;33m 0.0001[0m
[1;36mtrain_neg_sample_args[0m =[1;33m {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}[0m
[1;36meval_step[0m =[1;33m 1[0m
[1;36mstopping_step[0m =[1;33m 20[0m
[1;36mclip_grad_norm[0m =[1;33m None[0m
[1;36mweight_decay[0m =[1;33m 1e-05[0m
[1;36mloss_decimal_place[0m =[1;33m 4[0m

[1;35mEvaluation Hyper Parameters:
[0m[1;36meval_args[0m =[1;33m {'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}[0m
[1;36mrepeatable[0m =[1;33m True[0m
[1;36mmetrics[0m =[1;33m ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision'][0m
[1;36mtopk[0m =[1;33m [5][0m
[1;36mvalid_metric[0m =[1;33m mrr@5[0m
[1;36mvalid_metric_bigger[0m =[1;33m True[0m
[1;36meval_batch_size[0m =[1;33m 128[0m
[1;36mmetric_decimal_place[0m =[1;33m 4[0m

[1;35mDataset Hyper Parameters:
[0m[1;36mfield_separator[0m =[1;33m 	[0m
[1;36mseq_separator[0m =[1;33m  [0m
[1;36mUSER_ID_FIELD[0m =[1;33m user_id[0m
[1;36mITEM_ID_FIELD[0m =[1;33m item_id[0m
[1;36mRATING_FIELD[0m =[1;33m rating[0m
[1;36mTIME_FIELD[0m =[1;33m timestamp[0m
[1;36mseq_len[0m =[1;33m None[0m
[1;36mLABEL_FIELD[0m =[1;33m label[0m
[1;36mthreshold[0m =[1;33m None[0m
[1;36mNEG_PREFIX[0m =[1;33m neg_[0m
[1;36mload_col[0m =[1;33m {'inter': ['user_id', 'item_id', 'rating', 'timestamp'], 'item': ['item_id', 'title', 'brand']}[0m
[1;36munload_col[0m =[1;33m None[0m
[1;36munused_col[0m =[1;33m None[0m
[1;36madditional_feat_suffix[0m =[1;33m None[0m
[1;36mrm_dup_inter[0m =[1;33m None[0m
[1;36mval_interval[0m =[1;33m None[0m
[1;36mfilter_inter_by_user_or_item[0m =[1;33m True[0m
[1;36muser_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36mitem_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36malias_of_user_id[0m =[1;33m None[0m
[1;36malias_of_item_id[0m =[1;33m None[0m
[1;36malias_of_entity_id[0m =[1;33m None[0m
[1;36malias_of_relation_id[0m =[1;33m None[0m
[1;36mpreload_weight[0m =[1;33m None[0m
[1;36mnormalize_field[0m =[1;33m None[0m
[1;36mnormalize_all[0m =[1;33m None[0m
[1;36mITEM_LIST_LENGTH_FIELD[0m =[1;33m item_length[0m
[1;36mLIST_SUFFIX[0m =[1;33m _list[0m
[1;36mMAX_ITEM_LIST_LENGTH[0m =[1;33m 50[0m
[1;36mPOSITION_FIELD[0m =[1;33m position_id[0m
[1;36mHEAD_ENTITY_ID_FIELD[0m =[1;33m head_id[0m
[1;36mTAIL_ENTITY_ID_FIELD[0m =[1;33m tail_id[0m
[1;36mRELATION_ID_FIELD[0m =[1;33m relation_id[0m
[1;36mENTITY_ID_FIELD[0m =[1;33m entity_id[0m
[1;36mbenchmark_filename[0m =[1;33m None[0m

[1;35mOther Hyper Parameters: 
[0m[1;36mworker[0m = [1;33m0[0m
[1;36mwandb_project[0m = [1;33mrecbole[0m
[1;36mshuffle[0m = [1;33mTrue[0m
[1;36mrequire_pow[0m = [1;33mFalse[0m
[1;36menable_amp[0m = [1;33mFalse[0m
[1;36menable_scaler[0m = [1;33mFalse[0m
[1;36mtransform[0m = [1;33mNone[0m
[1;36mn_layers[0m = [1;33m16[0m
[1;36mn_heads[0m = [1;33m4[0m
[1;36mhidden_size[0m = [1;33m256[0m
[1;36minner_size[0m = [1;33m256[0m
[1;36mhidden_dropout_prob[0m = [1;33m0.5[0m
[1;36mattn_dropout_prob[0m = [1;33m0.5[0m
[1;36mhidden_act[0m = [1;33mgelu[0m
[1;36mlayer_norm_eps[0m = [1;33m1e-12[0m
[1;36minitializer_range[0m = [1;33m0.02[0m
[1;36mselected_features[0m = [1;33m['title', 'brand'][0m
[1;36mpooling_mode[0m = [1;33msum[0m
[1;36mloss_type[0m = [1;33mInfoNCE-quick[0m
[1;36mnumerical_features[0m = [1;33m[][0m
[1;36mdiscretization[0m = [1;33mNone[0m
[1;36mkg_reverse_r[0m = [1;33mFalse[0m
[1;36mentity_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mrelation_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mMODEL_TYPE[0m = [1;33mModelType.SEQUENTIAL[0m
[1;36mmlflow[0m = [1;33m{'enable': True, 'experiment_name': 'fine-tune', 'run_name': '0f5d1302-97f4-4127-9cee-a6a702a5625b', 'tracking_uri': 'sqlite:///mlruns.sqlite', 'auto_continue': True}[0m
[1;36mmax_grad_norm[0m = [1;33m1.0[0m
[1;36mscheduler[0m = [1;33m{'type': 'one-cycle'}[0m
[1;36mnce_temperature[0m = [1;33m1[0m
[1;36mnce_label_smoothing[0m = [1;33m0.0[0m
[1;36mnormalize_embedding[0m = [1;33mFalse[0m
[1;36mevaluation_mode[0m = [1;33msampled50000[0m
[1;36mestimate_batch_size[0m = [1;33mFalse[0m
[1;36mnce_num_negatives[0m = [1;33m300[0m
[1;36mnce_sampling_strategy[0m = [1;33mpopularity[0m
[1;36mnce_global_negatives[0m = [1;33mFalse[0m
[1;36mgradient_accumulation_steps[0m = [1;33m10[0m
[1;36meval_type[0m = [1;33mEvaluatorType.RANKING[0m
[1;36msingle_spec[0m = [1;33mTrue[0m
[1;36mlocal_rank[0m = [1;33m0[0m
[1;36mdevice[0m = [1;33mcuda[0m
[1;36mvalid_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m
[1;36mtest_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m


INFO:root:[1;35m[Training]: [0m[1;36mtrain_batch_size[0m = [1;33m[128][0m[1;36m train_neg_sample_args[0m: [1;33m[{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}][0m
INFO:root:[1;35m[Evaluation]: [0m[1;36meval_batch_size[0m = [1;33m[128][0m[1;36m eval_args[0m: [1;33m[{'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}][0m
item features
The batch_size of interaction: 504
    item_id, torch.Size([504]), cuda, torch.int64
    title, torch.Size([504, 40]), cuda, torch.int64
    brand, torch.Size([504, 7]), cuda, torch.int64


example
['‚ñÅcra' 'bt' 'ree' '‚ñÅamp' '‚ñÅevelyn' '‚ñÅgardener' '‚ñÅs' '‚ñÅultra' '‚ñÅmoistur'
 'ising' '‚ñÅhand' '‚ñÅtherapy' '‚ñÅpump' '‚ñÅ250' 'g' '‚ñÅ8' '‚ñÅ8' '‚ñÅoz' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]']
INFO:alembic.runtime.migration:Context impl SQLiteImpl.
INFO:alembic.runtime.migration:Will assume non-transactional DDL.
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 6477056 but failed
tried to log param model_non_emb_params with value -4778240 but failed
tried to log param unfreeze_n_layers with value 2 but failed
Evaluation sanity
****************************************
2024-07-10 10:46:43 pid 8159 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:46:43 pid 8159 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.60 seconds, [1;33mGPU RAM: 2.28 G/15.78 G[0m
2024-07-10 10:46:43 pid 8159 | finished [1;35mEvaluate in test   [0m. Total time: 0.60 seconds
OrderedDict([('recall@5', 0.1351), ('mrr@5', 0.0541), ('ndcg@5', 0.0745), ('hit@5', 0.1351), ('precision@5', 0.027), ('test_loss', 6.2594380378723145)])
****************************************
Freezing embeddings
Freezing layer 0
Freezing layer 1
Freezing layer 2
Freezing layer 3
Freezing layer 4
Freezing layer 5
Freezing layer 6
Freezing layer 7
Freezing layer 8
Freezing layer 9
Freezing layer 10
Freezing layer 11
Freezing layer 12
Freezing layer 13
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 923392 but failed
tried to log param model_non_emb_params with value -10331904 but failed
2024-07-10 10:46:43 pid 8159 | starting to iterate Train     0 (total=3), updating every 1 seconds
2024-07-10 10:46:45 pid 8159 | 0 of 3, 0.0% of Train     0, speed: -0.00 s/it, elapsed 0.47 seconds, [1;31mGPU RAM: 5.28 G/15.78 G loss: 5.98716[0m
2024-07-10 10:46:45 pid 8159 | finished Train     0. Total time: 0.47 seconds
INFO:root:[1;32mepoch 0 training[0m [[1;34mtime[0m: 1.50s, [1;34mtrain loss[0m: 5.9943]
2024-07-10 10:46:45 pid 8159 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:46:45 pid 8159 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.29 G/15.78 G[0m
2024-07-10 10:46:45 pid 8159 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.0588), ('mrr@5', 0.0196), ('ndcg@5', 0.0294), ('hit@5', 0.0588), ('precision@5', 0.0118), ('valid_loss', 6.304722309112549)])
INFO:root:[1;32mepoch 0 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.019600]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.0588    mrr@5 : 0.0196    ndcg@5 : 0.0294    hit@5 : 0.0588    precision@5 : 0.0118    valid_loss : 6.304722309112549
2024-07-10 10:46:45 pid 8159 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1016), ('mrr@5', 0.0474), ('ndcg@5', 0.0609), ('hit@5', 0.1016), ('precision@5', 0.0203)])
2024-07-10 10:46:45 pid 8159 | starting to iterate Train     1 (total=3), updating every 1 seconds
2024-07-10 10:46:47 pid 8159 | 0 of 3, 0.0% of Train     1, speed: -0.00 s/it, elapsed 0.48 seconds, [1;31mGPU RAM: 5.29 G/15.78 G loss: 6.06791[0m
2024-07-10 10:46:47 pid 8159 | finished Train     1. Total time: 0.49 seconds
INFO:root:[1;32mepoch 1 training[0m [[1;34mtime[0m: 1.48s, [1;34mtrain loss[0m: 5.9805]
2024-07-10 10:46:47 pid 8159 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:46:47 pid 8159 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.29 G/15.78 G[0m
2024-07-10 10:46:47 pid 8159 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.0588), ('mrr@5', 0.0196), ('ndcg@5', 0.0294), ('hit@5', 0.0588), ('precision@5', 0.0118), ('valid_loss', 6.295191287994385)])
INFO:root:[1;32mepoch 1 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.019600]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.0588    mrr@5 : 0.0196    ndcg@5 : 0.0294    hit@5 : 0.0588    precision@5 : 0.0118    valid_loss : 6.295191287994385
2024-07-10 10:46:47 pid 8159 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1016), ('mrr@5', 0.0474), ('ndcg@5', 0.0609), ('hit@5', 0.1016), ('precision@5', 0.0203)])
2024-07-10 10:46:47 pid 8159 | starting to iterate Train     2 (total=3), updating every 1 seconds
2024-07-10 10:46:48 pid 8159 | 0 of 3, 0.0% of Train     2, speed: -0.00 s/it, elapsed 0.46 seconds, [1;31mGPU RAM: 5.29 G/15.78 G loss: 5.90684[0m
2024-07-10 10:46:48 pid 8159 | finished Train     2. Total time: 0.46 seconds
INFO:root:[1;32mepoch 2 training[0m [[1;34mtime[0m: 1.46s, [1;34mtrain loss[0m: 6.0831]
2024-07-10 10:46:48 pid 8159 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:46:49 pid 8159 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.29 G/15.78 G[0m
2024-07-10 10:46:49 pid 8159 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.0588), ('mrr@5', 0.0196), ('ndcg@5', 0.0294), ('hit@5', 0.0588), ('precision@5', 0.0118), ('valid_loss', 6.348791122436523)])
INFO:root:[1;32mepoch 2 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.019600]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.0588    mrr@5 : 0.0196    ndcg@5 : 0.0294    hit@5 : 0.0588    precision@5 : 0.0118    valid_loss : 6.348791122436523
2024-07-10 10:46:49 pid 8159 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1094), ('mrr@5', 0.049), ('ndcg@5', 0.0639), ('hit@5', 0.1094), ('precision@5', 0.0219)])
2024-07-10 10:46:49 pid 8159 | starting to iterate Train     3 (total=3), updating every 1 seconds
2024-07-10 10:46:50 pid 8159 | 0 of 3, 0.0% of Train     3, speed: -0.00 s/it, elapsed 0.46 seconds, [1;31mGPU RAM: 5.29 G/15.78 G loss: 6.00182[0m
2024-07-10 10:46:50 pid 8159 | finished Train     3. Total time: 0.46 seconds
INFO:root:[1;32mepoch 3 training[0m [[1;34mtime[0m: 1.46s, [1;34mtrain loss[0m: 5.9642]
2024-07-10 10:46:50 pid 8159 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:46:50 pid 8159 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.29 G/15.78 G[0m
2024-07-10 10:46:50 pid 8159 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.358816146850586)])
INFO:root:[1;32mepoch 3 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.358816146850586
2024-07-10 10:46:50 pid 8159 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1094), ('mrr@5', 0.049), ('ndcg@5', 0.0639), ('hit@5', 0.1094), ('precision@5', 0.0219)])
2024-07-10 10:46:51 pid 8159 | starting to iterate Train     4 (total=3), updating every 1 seconds
2024-07-10 10:46:52 pid 8159 | 0 of 3, 0.0% of Train     4, speed: -0.00 s/it, elapsed 0.46 seconds, [1;31mGPU RAM: 5.29 G/15.78 G loss: 6.04226[0m
2024-07-10 10:46:52 pid 8159 | finished Train     4. Total time: 0.46 seconds
INFO:root:[1;32mepoch 4 training[0m [[1;34mtime[0m: 1.49s, [1;34mtrain loss[0m: 5.9843]
2024-07-10 10:46:52 pid 8159 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:46:52 pid 8159 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.29 G/15.78 G[0m
2024-07-10 10:46:52 pid 8159 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.330019474029541)])
INFO:root:[1;32mepoch 4 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.330019474029541
2024-07-10 10:46:52 pid 8159 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1172), ('mrr@5', 0.0503), ('ndcg@5', 0.0667), ('hit@5', 0.1172), ('precision@5', 0.0234)])
2024-07-10 10:46:52 pid 8159 | starting to iterate Train     5 (total=3), updating every 1 seconds
2024-07-10 10:46:54 pid 8159 | 0 of 3, 0.0% of Train     5, speed: -0.00 s/it, elapsed 0.46 seconds, [1;31mGPU RAM: 5.29 G/15.78 G loss: 5.94313[0m
2024-07-10 10:46:54 pid 8159 | finished Train     5. Total time: 0.46 seconds
INFO:root:[1;32mepoch 5 training[0m [[1;34mtime[0m: 1.45s, [1;34mtrain loss[0m: 6.0412]
2024-07-10 10:46:54 pid 8159 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:46:54 pid 8159 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.29 G/15.78 G[0m
2024-07-10 10:46:54 pid 8159 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.374632835388184)])
INFO:root:[1;32mepoch 5 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.374632835388184
2024-07-10 10:46:54 pid 8159 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1172), ('mrr@5', 0.0503), ('ndcg@5', 0.0667), ('hit@5', 0.1172), ('precision@5', 0.0234)])
2024-07-10 10:46:54 pid 8159 | starting to iterate Train     6 (total=3), updating every 1 seconds
2024-07-10 10:46:55 pid 8159 | 0 of 3, 0.0% of Train     6, speed: -0.00 s/it, elapsed 0.47 seconds, [1;31mGPU RAM: 5.29 G/15.78 G loss: 5.93437[0m
2024-07-10 10:46:55 pid 8159 | finished Train     6. Total time: 0.47 seconds
INFO:root:[1;32mepoch 6 training[0m [[1;34mtime[0m: 1.48s, [1;34mtrain loss[0m: 5.9795]
2024-07-10 10:46:56 pid 8159 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:46:56 pid 8159 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.29 G/15.78 G[0m
2024-07-10 10:46:56 pid 8159 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.334047794342041)])
INFO:root:[1;32mepoch 6 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.334047794342041
2024-07-10 10:46:56 pid 8159 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1328), ('mrr@5', 0.0534), ('ndcg@5', 0.0727), ('hit@5', 0.1328), ('precision@5', 0.0266)])
2024-07-10 10:46:56 pid 8159 | starting to iterate Train     7 (total=3), updating every 1 seconds
2024-07-10 10:46:57 pid 8159 | 0 of 3, 0.0% of Train     7, speed: -0.00 s/it, elapsed 0.47 seconds, [1;31mGPU RAM: 5.29 G/15.78 G loss: 5.89089[0m
2024-07-10 10:46:57 pid 8159 | finished Train     7. Total time: 0.47 seconds
INFO:root:[1;32mepoch 7 training[0m [[1;34mtime[0m: 1.47s, [1;34mtrain loss[0m: 5.9716]
2024-07-10 10:46:57 pid 8159 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:46:57 pid 8159 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.29 G/15.78 G[0m
2024-07-10 10:46:57 pid 8159 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.305135250091553)])
INFO:root:[1;32mepoch 7 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.305135250091553
2024-07-10 10:46:57 pid 8159 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1328), ('mrr@5', 0.0538), ('ndcg@5', 0.0731), ('hit@5', 0.1328), ('precision@5', 0.0266)])
2024-07-10 10:46:58 pid 8159 | starting to iterate Train     8 (total=3), updating every 1 seconds
2024-07-10 10:46:59 pid 8159 | 0 of 3, 0.0% of Train     8, speed: -0.00 s/it, elapsed 0.45 seconds, [1;31mGPU RAM: 5.29 G/15.78 G loss: 5.90541[0m
2024-07-10 10:46:59 pid 8159 | finished Train     8. Total time: 0.45 seconds
INFO:root:[1;32mepoch 8 training[0m [[1;34mtime[0m: 1.46s, [1;34mtrain loss[0m: 5.9093]
2024-07-10 10:46:59 pid 8159 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:46:59 pid 8159 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.29 G/15.78 G[0m
2024-07-10 10:46:59 pid 8159 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.437038898468018)])
INFO:root:[1;32mepoch 8 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.437038898468018
2024-07-10 10:46:59 pid 8159 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1406), ('mrr@5', 0.0549), ('ndcg@5', 0.0758), ('hit@5', 0.1406), ('precision@5', 0.0281)])
2024-07-10 10:46:59 pid 8159 | starting to iterate Train     9 (total=3), updating every 1 seconds
2024-07-10 10:47:01 pid 8159 | 0 of 3, 0.0% of Train     9, speed: -0.00 s/it, elapsed 0.46 seconds, [1;31mGPU RAM: 5.29 G/15.78 G loss: 5.74555[0m
2024-07-10 10:47:01 pid 8159 | finished Train     9. Total time: 0.46 seconds
INFO:root:[1;32mepoch 9 training[0m [[1;34mtime[0m: 1.47s, [1;34mtrain loss[0m: 6.0364]
2024-07-10 10:47:01 pid 8159 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:01 pid 8159 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.29 G/15.78 G[0m
2024-07-10 10:47:01 pid 8159 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.324784755706787)])
INFO:root:[1;32mepoch 9 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.324784755706787
2024-07-10 10:47:01 pid 8159 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1406), ('mrr@5', 0.0556), ('ndcg@5', 0.0763), ('hit@5', 0.1406), ('precision@5', 0.0281)])
Saving checkpoint on /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/02.pth
INFO:root:[1;34mSaving current[0m: /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/02.pth
2024-07-10 10:47:01 pid 8159 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:01 pid 8159 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.06 seconds, [1;33mGPU RAM: 5.29 G/15.78 G[0m
2024-07-10 10:47:01 pid 8159 | finished [1;35mEvaluate in test   [0m. Total time: 0.06 seconds
OrderedDict([('recall@5', 0.1216), ('mrr@5', 0.0495), ('ndcg@5', 0.0678), ('hit@5', 0.1216), ('precision@5', 0.0243), ('test_loss', 6.209973335266113)])
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
INFO:faiss.loader:Loading faiss.
INFO:faiss.loader:Successfully loaded faiss.
WARNING:root:command line args [-c confs/fine_tune/progressive.json -s amazon-beauty -l amazon-100K -i test.pth -p confs/pre_train/config_dict_100K.json -o fine_tuned_checkpoint.pth] will not be used in RecBole

[1;35mGeneral Hyper Parameters:
[0m[1;36mgpu_id[0m =[1;33m 0[0m
[1;36muse_gpu[0m =[1;33m True[0m
[1;36mseed[0m =[1;33m 2020[0m
[1;36mstate[0m =[1;33m INFO[0m
[1;36mreproducibility[0m =[1;33m True[0m
[1;36mdata_path[0m =[1;33m /alloc/data/srt/data/output/amazon-beauty[0m
[1;36mcheckpoint_dir[0m =[1;33m saved[0m
[1;36mshow_progress[0m =[1;33m True[0m
[1;36msave_dataset[0m =[1;33m False[0m
[1;36mdataset_save_path[0m =[1;33m None[0m
[1;36msave_dataloaders[0m =[1;33m False[0m
[1;36mdataloaders_save_path[0m =[1;33m None[0m
[1;36mlog_wandb[0m =[1;33m False[0m

[1;35mTraining Hyper Parameters:
[0m[1;36mepochs[0m =[1;33m 2[0m
[1;36mtrain_batch_size[0m =[1;33m 128[0m
[1;36mlearner[0m =[1;33m adam[0m
[1;36mlearning_rate[0m =[1;33m 0.0001[0m
[1;36mtrain_neg_sample_args[0m =[1;33m {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}[0m
[1;36meval_step[0m =[1;33m 1[0m
[1;36mstopping_step[0m =[1;33m 20[0m
[1;36mclip_grad_norm[0m =[1;33m None[0m
[1;36mweight_decay[0m =[1;33m 1e-05[0m
[1;36mloss_decimal_place[0m =[1;33m 4[0m

[1;35mEvaluation Hyper Parameters:
[0m[1;36meval_args[0m =[1;33m {'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}[0m
[1;36mrepeatable[0m =[1;33m True[0m
[1;36mmetrics[0m =[1;33m ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision'][0m
[1;36mtopk[0m =[1;33m [5][0m
[1;36mvalid_metric[0m =[1;33m mrr@5[0m
[1;36mvalid_metric_bigger[0m =[1;33m True[0m
[1;36meval_batch_size[0m =[1;33m 128[0m
[1;36mmetric_decimal_place[0m =[1;33m 4[0m

[1;35mDataset Hyper Parameters:
[0m[1;36mfield_separator[0m =[1;33m 	[0m
[1;36mseq_separator[0m =[1;33m  [0m
[1;36mUSER_ID_FIELD[0m =[1;33m user_id[0m
[1;36mITEM_ID_FIELD[0m =[1;33m item_id[0m
[1;36mRATING_FIELD[0m =[1;33m rating[0m
[1;36mTIME_FIELD[0m =[1;33m timestamp[0m
[1;36mseq_len[0m =[1;33m None[0m
[1;36mLABEL_FIELD[0m =[1;33m label[0m
[1;36mthreshold[0m =[1;33m None[0m
[1;36mNEG_PREFIX[0m =[1;33m neg_[0m
[1;36mload_col[0m =[1;33m {'inter': ['user_id', 'item_id', 'rating', 'timestamp'], 'item': ['item_id', 'title', 'brand']}[0m
[1;36munload_col[0m =[1;33m None[0m
[1;36munused_col[0m =[1;33m None[0m
[1;36madditional_feat_suffix[0m =[1;33m None[0m
[1;36mrm_dup_inter[0m =[1;33m None[0m
[1;36mval_interval[0m =[1;33m None[0m
[1;36mfilter_inter_by_user_or_item[0m =[1;33m True[0m
[1;36muser_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36mitem_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36malias_of_user_id[0m =[1;33m None[0m
[1;36malias_of_item_id[0m =[1;33m None[0m
[1;36malias_of_entity_id[0m =[1;33m None[0m
[1;36malias_of_relation_id[0m =[1;33m None[0m
[1;36mpreload_weight[0m =[1;33m None[0m
[1;36mnormalize_field[0m =[1;33m None[0m
[1;36mnormalize_all[0m =[1;33m None[0m
[1;36mITEM_LIST_LENGTH_FIELD[0m =[1;33m item_length[0m
[1;36mLIST_SUFFIX[0m =[1;33m _list[0m
[1;36mMAX_ITEM_LIST_LENGTH[0m =[1;33m 50[0m
[1;36mPOSITION_FIELD[0m =[1;33m position_id[0m
[1;36mHEAD_ENTITY_ID_FIELD[0m =[1;33m head_id[0m
[1;36mTAIL_ENTITY_ID_FIELD[0m =[1;33m tail_id[0m
[1;36mRELATION_ID_FIELD[0m =[1;33m relation_id[0m
[1;36mENTITY_ID_FIELD[0m =[1;33m entity_id[0m
[1;36mbenchmark_filename[0m =[1;33m None[0m

[1;35mOther Hyper Parameters: 
[0m[1;36mworker[0m = [1;33m0[0m
[1;36mwandb_project[0m = [1;33mrecbole[0m
[1;36mshuffle[0m = [1;33mTrue[0m
[1;36mrequire_pow[0m = [1;33mFalse[0m
[1;36menable_amp[0m = [1;33mFalse[0m
[1;36menable_scaler[0m = [1;33mFalse[0m
[1;36mtransform[0m = [1;33mNone[0m
[1;36mn_layers[0m = [1;33m16[0m
[1;36mn_heads[0m = [1;33m4[0m
[1;36mhidden_size[0m = [1;33m256[0m
[1;36minner_size[0m = [1;33m256[0m
[1;36mhidden_dropout_prob[0m = [1;33m0.5[0m
[1;36mattn_dropout_prob[0m = [1;33m0.5[0m
[1;36mhidden_act[0m = [1;33mgelu[0m
[1;36mlayer_norm_eps[0m = [1;33m1e-12[0m
[1;36minitializer_range[0m = [1;33m0.02[0m
[1;36mselected_features[0m = [1;33m['title', 'brand'][0m
[1;36mpooling_mode[0m = [1;33msum[0m
[1;36mloss_type[0m = [1;33mInfoNCE-quick[0m
[1;36mnumerical_features[0m = [1;33m[][0m
[1;36mdiscretization[0m = [1;33mNone[0m
[1;36mkg_reverse_r[0m = [1;33mFalse[0m
[1;36mentity_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mrelation_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mMODEL_TYPE[0m = [1;33mModelType.SEQUENTIAL[0m
[1;36mmlflow[0m = [1;33m{'enable': True, 'experiment_name': 'fine-tune', 'run_name': '0f5d1302-97f4-4127-9cee-a6a702a5625b', 'tracking_uri': 'sqlite:///mlruns.sqlite', 'auto_continue': True}[0m
[1;36mmax_grad_norm[0m = [1;33m1.0[0m
[1;36mscheduler[0m = [1;33m{'type': 'one-cycle'}[0m
[1;36mnce_temperature[0m = [1;33m1[0m
[1;36mnce_label_smoothing[0m = [1;33m0.0[0m
[1;36mnormalize_embedding[0m = [1;33mFalse[0m
[1;36mevaluation_mode[0m = [1;33msampled50000[0m
[1;36mestimate_batch_size[0m = [1;33mFalse[0m
[1;36mnce_num_negatives[0m = [1;33m300[0m
[1;36mnce_sampling_strategy[0m = [1;33mpopularity[0m
[1;36mnce_global_negatives[0m = [1;33mFalse[0m
[1;36mgradient_accumulation_steps[0m = [1;33m10[0m
[1;36meval_type[0m = [1;33mEvaluatorType.RANKING[0m
[1;36msingle_spec[0m = [1;33mTrue[0m
[1;36mlocal_rank[0m = [1;33m0[0m
[1;36mdevice[0m = [1;33mcuda[0m
[1;36mvalid_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m
[1;36mtest_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m


INFO:root:[1;35m[Training]: [0m[1;36mtrain_batch_size[0m = [1;33m[128][0m[1;36m train_neg_sample_args[0m: [1;33m[{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}][0m
INFO:root:[1;35m[Evaluation]: [0m[1;36meval_batch_size[0m = [1;33m[128][0m[1;36m eval_args[0m: [1;33m[{'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}][0m
item features
The batch_size of interaction: 504
    item_id, torch.Size([504]), cuda, torch.int64
    title, torch.Size([504, 40]), cuda, torch.int64
    brand, torch.Size([504, 7]), cuda, torch.int64


example
['‚ñÅcra' 'bt' 'ree' '‚ñÅamp' '‚ñÅevelyn' '‚ñÅgardener' '‚ñÅs' '‚ñÅultra' '‚ñÅmoistur'
 'ising' '‚ñÅhand' '‚ñÅtherapy' '‚ñÅpump' '‚ñÅ250' 'g' '‚ñÅ8' '‚ñÅ8' '‚ñÅoz' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]']
INFO:alembic.runtime.migration:Context impl SQLiteImpl.
INFO:alembic.runtime.migration:Will assume non-transactional DDL.
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 6477056 but failed
tried to log param model_non_emb_params with value -4778240 but failed
tried to log param unfreeze_n_layers with value 3 but failed
Evaluation sanity
****************************************
2024-07-10 10:47:05 pid 8171 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:05 pid 8171 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.60 seconds, [1;33mGPU RAM: 2.29 G/15.78 G[0m
2024-07-10 10:47:05 pid 8171 | finished [1;35mEvaluate in test   [0m. Total time: 0.60 seconds
OrderedDict([('recall@5', 0.1216), ('mrr@5', 0.0495), ('ndcg@5', 0.0678), ('hit@5', 0.1216), ('precision@5', 0.0243), ('test_loss', 6.2339396476745605)])
****************************************
Freezing embeddings
Freezing layer 0
Freezing layer 1
Freezing layer 2
Freezing layer 3
Freezing layer 4
Freezing layer 5
Freezing layer 6
Freezing layer 7
Freezing layer 8
Freezing layer 9
Freezing layer 10
Freezing layer 11
Freezing layer 12
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 1319168 but failed
tried to log param model_non_emb_params with value -9936128 but failed
2024-07-10 10:47:06 pid 8171 | starting to iterate Train     0 (total=3), updating every 1 seconds
2024-07-10 10:47:07 pid 8171 | 0 of 3, 0.0% of Train     0, speed: -0.00 s/it, elapsed 0.49 seconds, [1;31mGPU RAM: 5.29 G/15.78 G loss: 5.87300[0m
2024-07-10 10:47:07 pid 8171 | finished Train     0. Total time: 0.49 seconds
INFO:root:[1;32mepoch 0 training[0m [[1;34mtime[0m: 1.57s, [1;34mtrain loss[0m: 5.8394]
2024-07-10 10:47:07 pid 8171 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:07 pid 8171 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.30 G/15.78 G[0m
2024-07-10 10:47:07 pid 8171 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.2910332679748535)])
INFO:root:[1;32mepoch 0 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.2910332679748535
2024-07-10 10:47:07 pid 8171 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1406), ('mrr@5', 0.0556), ('ndcg@5', 0.0763), ('hit@5', 0.1406), ('precision@5', 0.0281)])
2024-07-10 10:47:08 pid 8171 | starting to iterate Train     1 (total=3), updating every 1 seconds
2024-07-10 10:47:09 pid 8171 | 0 of 3, 0.0% of Train     1, speed: -0.00 s/it, elapsed 0.49 seconds, [1;31mGPU RAM: 5.30 G/15.78 G loss: 5.93799[0m
2024-07-10 10:47:09 pid 8171 | finished Train     1. Total time: 0.49 seconds
INFO:root:[1;32mepoch 1 training[0m [[1;34mtime[0m: 1.54s, [1;34mtrain loss[0m: 5.7940]
2024-07-10 10:47:09 pid 8171 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:09 pid 8171 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.30 G/15.78 G[0m
2024-07-10 10:47:09 pid 8171 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.275182247161865)])
INFO:root:[1;32mepoch 1 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.275182247161865
2024-07-10 10:47:09 pid 8171 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1406), ('mrr@5', 0.056), ('ndcg@5', 0.0767), ('hit@5', 0.1406), ('precision@5', 0.0281)])
2024-07-10 10:47:09 pid 8171 | starting to iterate Train     2 (total=3), updating every 1 seconds
2024-07-10 10:47:11 pid 8171 | 0 of 3, 0.0% of Train     2, speed: -0.00 s/it, elapsed 0.48 seconds, [1;31mGPU RAM: 5.30 G/15.78 G loss: 5.76882[0m
2024-07-10 10:47:11 pid 8171 | finished Train     2. Total time: 0.48 seconds
INFO:root:[1;32mepoch 2 training[0m [[1;34mtime[0m: 1.55s, [1;34mtrain loss[0m: 5.8853]
2024-07-10 10:47:11 pid 8171 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:11 pid 8171 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.30 G/15.78 G[0m
2024-07-10 10:47:11 pid 8171 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.339129447937012)])
INFO:root:[1;32mepoch 2 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.339129447937012
2024-07-10 10:47:11 pid 8171 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1406), ('mrr@5', 0.056), ('ndcg@5', 0.0767), ('hit@5', 0.1406), ('precision@5', 0.0281)])
2024-07-10 10:47:11 pid 8171 | starting to iterate Train     3 (total=3), updating every 1 seconds
2024-07-10 10:47:13 pid 8171 | 0 of 3, 0.0% of Train     3, speed: -0.00 s/it, elapsed 0.51 seconds, [1;31mGPU RAM: 5.30 G/15.78 G loss: 5.86132[0m
2024-07-10 10:47:13 pid 8171 | finished Train     3. Total time: 0.51 seconds
INFO:root:[1;32mepoch 3 training[0m [[1;34mtime[0m: 1.58s, [1;34mtrain loss[0m: 5.7856]
2024-07-10 10:47:13 pid 8171 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:13 pid 8171 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.30 G/15.78 G[0m
2024-07-10 10:47:13 pid 8171 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.340522289276123)])
INFO:root:[1;32mepoch 3 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.340522289276123
2024-07-10 10:47:13 pid 8171 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1406), ('mrr@5', 0.0566), ('ndcg@5', 0.0772), ('hit@5', 0.1406), ('precision@5', 0.0281)])
2024-07-10 10:47:13 pid 8171 | starting to iterate Train     4 (total=3), updating every 1 seconds
2024-07-10 10:47:15 pid 8171 | 0 of 3, 0.0% of Train     4, speed: -0.00 s/it, elapsed 0.49 seconds, [1;31mGPU RAM: 5.30 G/15.78 G loss: 5.89853[0m
2024-07-10 10:47:15 pid 8171 | finished Train     4. Total time: 0.49 seconds
INFO:root:[1;32mepoch 4 training[0m [[1;34mtime[0m: 1.54s, [1;34mtrain loss[0m: 5.8381]
2024-07-10 10:47:15 pid 8171 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:15 pid 8171 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.30 G/15.78 G[0m
2024-07-10 10:47:15 pid 8171 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.317182540893555)])
INFO:root:[1;32mepoch 4 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.317182540893555
2024-07-10 10:47:15 pid 8171 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1406), ('mrr@5', 0.057), ('ndcg@5', 0.0775), ('hit@5', 0.1406), ('precision@5', 0.0281)])
2024-07-10 10:47:15 pid 8171 | starting to iterate Train     5 (total=3), updating every 1 seconds
2024-07-10 10:47:17 pid 8171 | 0 of 3, 0.0% of Train     5, speed: -0.00 s/it, elapsed 0.48 seconds, [1;31mGPU RAM: 5.30 G/15.78 G loss: 5.80984[0m
2024-07-10 10:47:17 pid 8171 | finished Train     5. Total time: 0.48 seconds
INFO:root:[1;32mepoch 5 training[0m [[1;34mtime[0m: 1.53s, [1;34mtrain loss[0m: 5.8980]
2024-07-10 10:47:17 pid 8171 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:17 pid 8171 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.30 G/15.78 G[0m
2024-07-10 10:47:17 pid 8171 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.360852241516113)])
INFO:root:[1;32mepoch 5 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.360852241516113
2024-07-10 10:47:17 pid 8171 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1406), ('mrr@5', 0.0566), ('ndcg@5', 0.0772), ('hit@5', 0.1406), ('precision@5', 0.0281)])
2024-07-10 10:47:17 pid 8171 | starting to iterate Train     6 (total=3), updating every 1 seconds
2024-07-10 10:47:18 pid 8171 | 0 of 3, 0.0% of Train     6, speed: -0.00 s/it, elapsed 0.49 seconds, [1;31mGPU RAM: 5.30 G/15.78 G loss: 5.82682[0m
2024-07-10 10:47:18 pid 8171 | finished Train     6. Total time: 0.49 seconds
INFO:root:[1;32mepoch 6 training[0m [[1;34mtime[0m: 1.55s, [1;34mtrain loss[0m: 5.8452]
2024-07-10 10:47:18 pid 8171 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:18 pid 8171 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.30 G/15.78 G[0m
2024-07-10 10:47:18 pid 8171 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.330911159515381)])
INFO:root:[1;32mepoch 6 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.330911159515381
2024-07-10 10:47:19 pid 8171 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1406), ('mrr@5', 0.0562), ('ndcg@5', 0.0769), ('hit@5', 0.1406), ('precision@5', 0.0281)])
2024-07-10 10:47:19 pid 8171 | starting to iterate Train     7 (total=3), updating every 1 seconds
2024-07-10 10:47:20 pid 8171 | 0 of 3, 0.0% of Train     7, speed: -0.00 s/it, elapsed 0.49 seconds, [1;31mGPU RAM: 5.30 G/15.78 G loss: 5.79084[0m
2024-07-10 10:47:20 pid 8171 | finished Train     7. Total time: 0.49 seconds
INFO:root:[1;32mepoch 7 training[0m [[1;34mtime[0m: 1.56s, [1;34mtrain loss[0m: 5.8546]
2024-07-10 10:47:20 pid 8171 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:20 pid 8171 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.30 G/15.78 G[0m
2024-07-10 10:47:20 pid 8171 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.290262222290039)])
INFO:root:[1;32mepoch 7 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.290262222290039
2024-07-10 10:47:20 pid 8171 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1406), ('mrr@5', 0.0559), ('ndcg@5', 0.0765), ('hit@5', 0.1406), ('precision@5', 0.0281)])
2024-07-10 10:47:21 pid 8171 | starting to iterate Train     8 (total=3), updating every 1 seconds
2024-07-10 10:47:22 pid 8171 | 0 of 3, 0.0% of Train     8, speed: -0.00 s/it, elapsed 0.50 seconds, [1;31mGPU RAM: 5.30 G/15.78 G loss: 5.78872[0m
2024-07-10 10:47:22 pid 8171 | finished Train     8. Total time: 0.50 seconds
INFO:root:[1;32mepoch 8 training[0m [[1;34mtime[0m: 1.58s, [1;34mtrain loss[0m: 5.7960]
2024-07-10 10:47:22 pid 8171 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:22 pid 8171 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.30 G/15.78 G[0m
2024-07-10 10:47:22 pid 8171 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.422605514526367)])
INFO:root:[1;32mepoch 8 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.422605514526367
2024-07-10 10:47:22 pid 8171 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1484), ('mrr@5', 0.0611), ('ndcg@5', 0.0825), ('hit@5', 0.1484), ('precision@5', 0.0297)])
2024-07-10 10:47:22 pid 8171 | starting to iterate Train     9 (total=3), updating every 1 seconds
2024-07-10 10:47:24 pid 8171 | 0 of 3, 0.0% of Train     9, speed: -0.00 s/it, elapsed 0.49 seconds, [1;31mGPU RAM: 5.30 G/15.78 G loss: 5.63846[0m
2024-07-10 10:47:24 pid 8171 | finished Train     9. Total time: 0.49 seconds
INFO:root:[1;32mepoch 9 training[0m [[1;34mtime[0m: 1.55s, [1;34mtrain loss[0m: 5.9279]
2024-07-10 10:47:24 pid 8171 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:24 pid 8171 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.30 G/15.78 G[0m
2024-07-10 10:47:24 pid 8171 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.317967414855957)])
INFO:root:[1;32mepoch 9 evaluating[0m [[1;34mtime[0m: 0.15s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.317967414855957
2024-07-10 10:47:24 pid 8171 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1484), ('mrr@5', 0.0611), ('ndcg@5', 0.0825), ('hit@5', 0.1484), ('precision@5', 0.0297)])
Saving checkpoint on /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/03.pth
INFO:root:[1;34mSaving current[0m: /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/03.pth
2024-07-10 10:47:24 pid 8171 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:24 pid 8171 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.30 G/15.78 G[0m
2024-07-10 10:47:24 pid 8171 | finished [1;35mEvaluate in test   [0m. Total time: 0.05 seconds
OrderedDict([('recall@5', 0.1216), ('mrr@5', 0.0495), ('ndcg@5', 0.0678), ('hit@5', 0.1216), ('precision@5', 0.0243), ('test_loss', 6.183331489562988)])
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
INFO:faiss.loader:Loading faiss.
INFO:faiss.loader:Successfully loaded faiss.
WARNING:root:command line args [-c confs/fine_tune/progressive.json -s amazon-beauty -l amazon-100K -i test.pth -p confs/pre_train/config_dict_100K.json -o fine_tuned_checkpoint.pth] will not be used in RecBole

[1;35mGeneral Hyper Parameters:
[0m[1;36mgpu_id[0m =[1;33m 0[0m
[1;36muse_gpu[0m =[1;33m True[0m
[1;36mseed[0m =[1;33m 2020[0m
[1;36mstate[0m =[1;33m INFO[0m
[1;36mreproducibility[0m =[1;33m True[0m
[1;36mdata_path[0m =[1;33m /alloc/data/srt/data/output/amazon-beauty[0m
[1;36mcheckpoint_dir[0m =[1;33m saved[0m
[1;36mshow_progress[0m =[1;33m True[0m
[1;36msave_dataset[0m =[1;33m False[0m
[1;36mdataset_save_path[0m =[1;33m None[0m
[1;36msave_dataloaders[0m =[1;33m False[0m
[1;36mdataloaders_save_path[0m =[1;33m None[0m
[1;36mlog_wandb[0m =[1;33m False[0m

[1;35mTraining Hyper Parameters:
[0m[1;36mepochs[0m =[1;33m 2[0m
[1;36mtrain_batch_size[0m =[1;33m 128[0m
[1;36mlearner[0m =[1;33m adam[0m
[1;36mlearning_rate[0m =[1;33m 0.0001[0m
[1;36mtrain_neg_sample_args[0m =[1;33m {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}[0m
[1;36meval_step[0m =[1;33m 1[0m
[1;36mstopping_step[0m =[1;33m 20[0m
[1;36mclip_grad_norm[0m =[1;33m None[0m
[1;36mweight_decay[0m =[1;33m 1e-05[0m
[1;36mloss_decimal_place[0m =[1;33m 4[0m

[1;35mEvaluation Hyper Parameters:
[0m[1;36meval_args[0m =[1;33m {'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}[0m
[1;36mrepeatable[0m =[1;33m True[0m
[1;36mmetrics[0m =[1;33m ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision'][0m
[1;36mtopk[0m =[1;33m [5][0m
[1;36mvalid_metric[0m =[1;33m mrr@5[0m
[1;36mvalid_metric_bigger[0m =[1;33m True[0m
[1;36meval_batch_size[0m =[1;33m 128[0m
[1;36mmetric_decimal_place[0m =[1;33m 4[0m

[1;35mDataset Hyper Parameters:
[0m[1;36mfield_separator[0m =[1;33m 	[0m
[1;36mseq_separator[0m =[1;33m  [0m
[1;36mUSER_ID_FIELD[0m =[1;33m user_id[0m
[1;36mITEM_ID_FIELD[0m =[1;33m item_id[0m
[1;36mRATING_FIELD[0m =[1;33m rating[0m
[1;36mTIME_FIELD[0m =[1;33m timestamp[0m
[1;36mseq_len[0m =[1;33m None[0m
[1;36mLABEL_FIELD[0m =[1;33m label[0m
[1;36mthreshold[0m =[1;33m None[0m
[1;36mNEG_PREFIX[0m =[1;33m neg_[0m
[1;36mload_col[0m =[1;33m {'inter': ['user_id', 'item_id', 'rating', 'timestamp'], 'item': ['item_id', 'title', 'brand']}[0m
[1;36munload_col[0m =[1;33m None[0m
[1;36munused_col[0m =[1;33m None[0m
[1;36madditional_feat_suffix[0m =[1;33m None[0m
[1;36mrm_dup_inter[0m =[1;33m None[0m
[1;36mval_interval[0m =[1;33m None[0m
[1;36mfilter_inter_by_user_or_item[0m =[1;33m True[0m
[1;36muser_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36mitem_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36malias_of_user_id[0m =[1;33m None[0m
[1;36malias_of_item_id[0m =[1;33m None[0m
[1;36malias_of_entity_id[0m =[1;33m None[0m
[1;36malias_of_relation_id[0m =[1;33m None[0m
[1;36mpreload_weight[0m =[1;33m None[0m
[1;36mnormalize_field[0m =[1;33m None[0m
[1;36mnormalize_all[0m =[1;33m None[0m
[1;36mITEM_LIST_LENGTH_FIELD[0m =[1;33m item_length[0m
[1;36mLIST_SUFFIX[0m =[1;33m _list[0m
[1;36mMAX_ITEM_LIST_LENGTH[0m =[1;33m 50[0m
[1;36mPOSITION_FIELD[0m =[1;33m position_id[0m
[1;36mHEAD_ENTITY_ID_FIELD[0m =[1;33m head_id[0m
[1;36mTAIL_ENTITY_ID_FIELD[0m =[1;33m tail_id[0m
[1;36mRELATION_ID_FIELD[0m =[1;33m relation_id[0m
[1;36mENTITY_ID_FIELD[0m =[1;33m entity_id[0m
[1;36mbenchmark_filename[0m =[1;33m None[0m

[1;35mOther Hyper Parameters: 
[0m[1;36mworker[0m = [1;33m0[0m
[1;36mwandb_project[0m = [1;33mrecbole[0m
[1;36mshuffle[0m = [1;33mTrue[0m
[1;36mrequire_pow[0m = [1;33mFalse[0m
[1;36menable_amp[0m = [1;33mFalse[0m
[1;36menable_scaler[0m = [1;33mFalse[0m
[1;36mtransform[0m = [1;33mNone[0m
[1;36mn_layers[0m = [1;33m16[0m
[1;36mn_heads[0m = [1;33m4[0m
[1;36mhidden_size[0m = [1;33m256[0m
[1;36minner_size[0m = [1;33m256[0m
[1;36mhidden_dropout_prob[0m = [1;33m0.5[0m
[1;36mattn_dropout_prob[0m = [1;33m0.5[0m
[1;36mhidden_act[0m = [1;33mgelu[0m
[1;36mlayer_norm_eps[0m = [1;33m1e-12[0m
[1;36minitializer_range[0m = [1;33m0.02[0m
[1;36mselected_features[0m = [1;33m['title', 'brand'][0m
[1;36mpooling_mode[0m = [1;33msum[0m
[1;36mloss_type[0m = [1;33mInfoNCE-quick[0m
[1;36mnumerical_features[0m = [1;33m[][0m
[1;36mdiscretization[0m = [1;33mNone[0m
[1;36mkg_reverse_r[0m = [1;33mFalse[0m
[1;36mentity_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mrelation_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mMODEL_TYPE[0m = [1;33mModelType.SEQUENTIAL[0m
[1;36mmlflow[0m = [1;33m{'enable': True, 'experiment_name': 'fine-tune', 'run_name': '0f5d1302-97f4-4127-9cee-a6a702a5625b', 'tracking_uri': 'sqlite:///mlruns.sqlite', 'auto_continue': True}[0m
[1;36mmax_grad_norm[0m = [1;33m1.0[0m
[1;36mscheduler[0m = [1;33m{'type': 'one-cycle'}[0m
[1;36mnce_temperature[0m = [1;33m1[0m
[1;36mnce_label_smoothing[0m = [1;33m0.0[0m
[1;36mnormalize_embedding[0m = [1;33mFalse[0m
[1;36mevaluation_mode[0m = [1;33msampled50000[0m
[1;36mestimate_batch_size[0m = [1;33mFalse[0m
[1;36mnce_num_negatives[0m = [1;33m300[0m
[1;36mnce_sampling_strategy[0m = [1;33mpopularity[0m
[1;36mnce_global_negatives[0m = [1;33mFalse[0m
[1;36mgradient_accumulation_steps[0m = [1;33m10[0m
[1;36meval_type[0m = [1;33mEvaluatorType.RANKING[0m
[1;36msingle_spec[0m = [1;33mTrue[0m
[1;36mlocal_rank[0m = [1;33m0[0m
[1;36mdevice[0m = [1;33mcuda[0m
[1;36mvalid_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m
[1;36mtest_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m


INFO:root:[1;35m[Training]: [0m[1;36mtrain_batch_size[0m = [1;33m[128][0m[1;36m train_neg_sample_args[0m: [1;33m[{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}][0m
INFO:root:[1;35m[Evaluation]: [0m[1;36meval_batch_size[0m = [1;33m[128][0m[1;36m eval_args[0m: [1;33m[{'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}][0m
item features
The batch_size of interaction: 504
    item_id, torch.Size([504]), cuda, torch.int64
    title, torch.Size([504, 40]), cuda, torch.int64
    brand, torch.Size([504, 7]), cuda, torch.int64


example
['‚ñÅcra' 'bt' 'ree' '‚ñÅamp' '‚ñÅevelyn' '‚ñÅgardener' '‚ñÅs' '‚ñÅultra' '‚ñÅmoistur'
 'ising' '‚ñÅhand' '‚ñÅtherapy' '‚ñÅpump' '‚ñÅ250' 'g' '‚ñÅ8' '‚ñÅ8' '‚ñÅoz' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]']
INFO:alembic.runtime.migration:Context impl SQLiteImpl.
INFO:alembic.runtime.migration:Will assume non-transactional DDL.
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 6477056 but failed
tried to log param model_non_emb_params with value -4778240 but failed
tried to log param unfreeze_n_layers with value 4 but failed
Evaluation sanity
****************************************
2024-07-10 10:47:28 pid 8183 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:29 pid 8183 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.60 seconds, [1;33mGPU RAM: 2.29 G/15.78 G[0m
2024-07-10 10:47:29 pid 8183 | finished [1;35mEvaluate in test   [0m. Total time: 0.60 seconds
OrderedDict([('recall@5', 0.1216), ('mrr@5', 0.0495), ('ndcg@5', 0.0678), ('hit@5', 0.1216), ('precision@5', 0.0243), ('test_loss', 6.212787628173828)])
****************************************
Freezing embeddings
Freezing layer 0
Freezing layer 1
Freezing layer 2
Freezing layer 3
Freezing layer 4
Freezing layer 5
Freezing layer 6
Freezing layer 7
Freezing layer 8
Freezing layer 9
Freezing layer 10
Freezing layer 11
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 1714944 but failed
tried to log param model_non_emb_params with value -9540352 but failed
2024-07-10 10:47:29 pid 8183 | starting to iterate Train     0 (total=3), updating every 1 seconds
2024-07-10 10:47:31 pid 8183 | 0 of 3, 0.0% of Train     0, speed: -0.00 s/it, elapsed 0.52 seconds, [1;31mGPU RAM: 5.30 G/15.78 G loss: 5.75530[0m
2024-07-10 10:47:31 pid 8183 | finished Train     0. Total time: 0.52 seconds
INFO:root:[1;32mepoch 0 training[0m [[1;34mtime[0m: 1.66s, [1;34mtrain loss[0m: 5.6692]
2024-07-10 10:47:31 pid 8183 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:31 pid 8183 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.31 G/15.78 G[0m
2024-07-10 10:47:31 pid 8183 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.28349494934082)])
INFO:root:[1;32mepoch 0 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.28349494934082
2024-07-10 10:47:31 pid 8183 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1484), ('mrr@5', 0.0611), ('ndcg@5', 0.0825), ('hit@5', 0.1484), ('precision@5', 0.0297)])
2024-07-10 10:47:31 pid 8183 | starting to iterate Train     1 (total=3), updating every 1 seconds
2024-07-10 10:47:32 pid 8183 | 0 of 3, 0.0% of Train     1, speed: -0.00 s/it, elapsed 0.53 seconds, [1;31mGPU RAM: 5.31 G/15.78 G loss: 5.80207[0m
2024-07-10 10:47:32 pid 8183 | finished Train     1. Total time: 0.53 seconds
INFO:root:[1;32mepoch 1 training[0m [[1;34mtime[0m: 1.67s, [1;34mtrain loss[0m: 5.5892]
2024-07-10 10:47:33 pid 8183 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:33 pid 8183 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.31 G/15.78 G[0m
2024-07-10 10:47:33 pid 8183 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.262784004211426)])
INFO:root:[1;32mepoch 1 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.262784004211426
2024-07-10 10:47:33 pid 8183 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1484), ('mrr@5', 0.0611), ('ndcg@5', 0.0825), ('hit@5', 0.1484), ('precision@5', 0.0297)])
2024-07-10 10:47:33 pid 8183 | starting to iterate Train     2 (total=3), updating every 1 seconds
2024-07-10 10:47:34 pid 8183 | 0 of 3, 0.0% of Train     2, speed: -0.00 s/it, elapsed 0.55 seconds, [1;31mGPU RAM: 5.31 G/15.78 G loss: 5.62114[0m
2024-07-10 10:47:34 pid 8183 | finished Train     2. Total time: 0.55 seconds
INFO:root:[1;32mepoch 2 training[0m [[1;34mtime[0m: 1.65s, [1;34mtrain loss[0m: 5.6691]
2024-07-10 10:47:34 pid 8183 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:35 pid 8183 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.31 G/15.78 G[0m
2024-07-10 10:47:35 pid 8183 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.333960056304932)])
INFO:root:[1;32mepoch 2 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.333960056304932
2024-07-10 10:47:35 pid 8183 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1484), ('mrr@5', 0.0615), ('ndcg@5', 0.0828), ('hit@5', 0.1484), ('precision@5', 0.0297)])
2024-07-10 10:47:35 pid 8183 | starting to iterate Train     3 (total=3), updating every 1 seconds
2024-07-10 10:47:36 pid 8183 | 0 of 3, 0.0% of Train     3, speed: -0.00 s/it, elapsed 0.52 seconds, [1;31mGPU RAM: 5.31 G/15.78 G loss: 5.70997[0m
2024-07-10 10:47:36 pid 8183 | finished Train     3. Total time: 0.52 seconds
INFO:root:[1;32mepoch 3 training[0m [[1;34mtime[0m: 1.65s, [1;34mtrain loss[0m: 5.5938]
2024-07-10 10:47:36 pid 8183 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:36 pid 8183 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.31 G/15.78 G[0m
2024-07-10 10:47:36 pid 8183 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.3285369873046875)])
INFO:root:[1;32mepoch 3 evaluating[0m [[1;34mtime[0m: 0.15s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.3285369873046875
2024-07-10 10:47:37 pid 8183 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1484), ('mrr@5', 0.0621), ('ndcg@5', 0.0833), ('hit@5', 0.1484), ('precision@5', 0.0297)])
2024-07-10 10:47:37 pid 8183 | starting to iterate Train     4 (total=3), updating every 1 seconds
2024-07-10 10:47:38 pid 8183 | 0 of 3, 0.0% of Train     4, speed: -0.00 s/it, elapsed 0.51 seconds, [1;31mGPU RAM: 5.31 G/15.78 G loss: 5.74694[0m
2024-07-10 10:47:38 pid 8183 | finished Train     4. Total time: 0.51 seconds
INFO:root:[1;32mepoch 4 training[0m [[1;34mtime[0m: 1.63s, [1;34mtrain loss[0m: 5.6797]
2024-07-10 10:47:38 pid 8183 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:38 pid 8183 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.31 G/15.78 G[0m
2024-07-10 10:47:38 pid 8183 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.30853271484375)])
INFO:root:[1;32mepoch 4 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.30853271484375
2024-07-10 10:47:38 pid 8183 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1406), ('mrr@5', 0.0596), ('ndcg@5', 0.0796), ('hit@5', 0.1406), ('precision@5', 0.0281)])
2024-07-10 10:47:39 pid 8183 | starting to iterate Train     5 (total=3), updating every 1 seconds
2024-07-10 10:47:40 pid 8183 | 0 of 3, 0.0% of Train     5, speed: -0.00 s/it, elapsed 0.51 seconds, [1;31mGPU RAM: 5.31 G/15.78 G loss: 5.67537[0m
2024-07-10 10:47:40 pid 8183 | finished Train     5. Total time: 0.51 seconds
INFO:root:[1;32mepoch 5 training[0m [[1;34mtime[0m: 1.63s, [1;34mtrain loss[0m: 5.7469]
2024-07-10 10:47:40 pid 8183 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:40 pid 8183 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.31 G/15.78 G[0m
2024-07-10 10:47:40 pid 8183 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.352668285369873)])
INFO:root:[1;32mepoch 5 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.352668285369873
2024-07-10 10:47:40 pid 8183 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1328), ('mrr@5', 0.0587), ('ndcg@5', 0.0772), ('hit@5', 0.1328), ('precision@5', 0.0266)])
2024-07-10 10:47:41 pid 8183 | starting to iterate Train     6 (total=3), updating every 1 seconds
2024-07-10 10:47:42 pid 8183 | 0 of 3, 0.0% of Train     6, speed: -0.00 s/it, elapsed 0.52 seconds, [1;31mGPU RAM: 5.31 G/15.78 G loss: 5.71256[0m
2024-07-10 10:47:42 pid 8183 | finished Train     6. Total time: 0.52 seconds
INFO:root:[1;32mepoch 6 training[0m [[1;34mtime[0m: 1.66s, [1;34mtrain loss[0m: 5.7076]
2024-07-10 10:47:42 pid 8183 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:42 pid 8183 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.31 G/15.78 G[0m
2024-07-10 10:47:42 pid 8183 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.33423376083374)])
INFO:root:[1;32mepoch 6 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.33423376083374
2024-07-10 10:47:42 pid 8183 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1328), ('mrr@5', 0.0594), ('ndcg@5', 0.0777), ('hit@5', 0.1328), ('precision@5', 0.0266)])
2024-07-10 10:47:42 pid 8183 | starting to iterate Train     7 (total=3), updating every 1 seconds
2024-07-10 10:47:44 pid 8183 | 0 of 3, 0.0% of Train     7, speed: -0.00 s/it, elapsed 0.51 seconds, [1;31mGPU RAM: 5.31 G/15.78 G loss: 5.68808[0m
2024-07-10 10:47:44 pid 8183 | finished Train     7. Total time: 0.51 seconds
INFO:root:[1;32mepoch 7 training[0m [[1;34mtime[0m: 1.63s, [1;34mtrain loss[0m: 5.7350]
2024-07-10 10:47:44 pid 8183 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:44 pid 8183 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.31 G/15.78 G[0m
2024-07-10 10:47:44 pid 8183 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.2785563468933105)])
INFO:root:[1;32mepoch 7 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.2785563468933105
2024-07-10 10:47:44 pid 8183 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1328), ('mrr@5', 0.0594), ('ndcg@5', 0.0777), ('hit@5', 0.1328), ('precision@5', 0.0266)])
2024-07-10 10:47:44 pid 8183 | starting to iterate Train     8 (total=3), updating every 1 seconds
2024-07-10 10:47:46 pid 8183 | 0 of 3, 0.0% of Train     8, speed: -0.00 s/it, elapsed 0.51 seconds, [1;31mGPU RAM: 5.31 G/15.78 G loss: 5.67168[0m
2024-07-10 10:47:46 pid 8183 | finished Train     8. Total time: 0.51 seconds
INFO:root:[1;32mepoch 8 training[0m [[1;34mtime[0m: 1.62s, [1;34mtrain loss[0m: 5.6829]
2024-07-10 10:47:46 pid 8183 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:46 pid 8183 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.31 G/15.78 G[0m
2024-07-10 10:47:46 pid 8183 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.413975715637207)])
INFO:root:[1;32mepoch 8 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.413975715637207
2024-07-10 10:47:46 pid 8183 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1328), ('mrr@5', 0.0607), ('ndcg@5', 0.0787), ('hit@5', 0.1328), ('precision@5', 0.0266)])
2024-07-10 10:47:46 pid 8183 | starting to iterate Train     9 (total=3), updating every 1 seconds
2024-07-10 10:47:48 pid 8183 | 0 of 3, 0.0% of Train     9, speed: -0.00 s/it, elapsed 0.52 seconds, [1;31mGPU RAM: 5.31 G/15.78 G loss: 5.53316[0m
2024-07-10 10:47:48 pid 8183 | finished Train     9. Total time: 0.52 seconds
INFO:root:[1;32mepoch 9 training[0m [[1;34mtime[0m: 1.64s, [1;34mtrain loss[0m: 5.8228]
2024-07-10 10:47:48 pid 8183 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:48 pid 8183 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.31 G/15.78 G[0m
2024-07-10 10:47:48 pid 8183 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.3131256103515625)])
INFO:root:[1;32mepoch 9 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.3131256103515625
2024-07-10 10:47:48 pid 8183 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1328), ('mrr@5', 0.0607), ('ndcg@5', 0.0787), ('hit@5', 0.1328), ('precision@5', 0.0266)])
Saving checkpoint on /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/04.pth
INFO:root:[1;34mSaving current[0m: /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/04.pth
2024-07-10 10:47:48 pid 8183 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:48 pid 8183 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.06 seconds, [1;33mGPU RAM: 5.31 G/15.78 G[0m
2024-07-10 10:47:48 pid 8183 | finished [1;35mEvaluate in test   [0m. Total time: 0.06 seconds
OrderedDict([('recall@5', 0.1216), ('mrr@5', 0.0466), ('ndcg@5', 0.0654), ('hit@5', 0.1216), ('precision@5', 0.0243), ('test_loss', 6.160280227661133)])
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
INFO:faiss.loader:Loading faiss.
INFO:faiss.loader:Successfully loaded faiss.
WARNING:root:command line args [-c confs/fine_tune/progressive.json -s amazon-beauty -l amazon-100K -i test.pth -p confs/pre_train/config_dict_100K.json -o fine_tuned_checkpoint.pth] will not be used in RecBole

[1;35mGeneral Hyper Parameters:
[0m[1;36mgpu_id[0m =[1;33m 0[0m
[1;36muse_gpu[0m =[1;33m True[0m
[1;36mseed[0m =[1;33m 2020[0m
[1;36mstate[0m =[1;33m INFO[0m
[1;36mreproducibility[0m =[1;33m True[0m
[1;36mdata_path[0m =[1;33m /alloc/data/srt/data/output/amazon-beauty[0m
[1;36mcheckpoint_dir[0m =[1;33m saved[0m
[1;36mshow_progress[0m =[1;33m True[0m
[1;36msave_dataset[0m =[1;33m False[0m
[1;36mdataset_save_path[0m =[1;33m None[0m
[1;36msave_dataloaders[0m =[1;33m False[0m
[1;36mdataloaders_save_path[0m =[1;33m None[0m
[1;36mlog_wandb[0m =[1;33m False[0m

[1;35mTraining Hyper Parameters:
[0m[1;36mepochs[0m =[1;33m 2[0m
[1;36mtrain_batch_size[0m =[1;33m 128[0m
[1;36mlearner[0m =[1;33m adam[0m
[1;36mlearning_rate[0m =[1;33m 0.0001[0m
[1;36mtrain_neg_sample_args[0m =[1;33m {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}[0m
[1;36meval_step[0m =[1;33m 1[0m
[1;36mstopping_step[0m =[1;33m 20[0m
[1;36mclip_grad_norm[0m =[1;33m None[0m
[1;36mweight_decay[0m =[1;33m 1e-05[0m
[1;36mloss_decimal_place[0m =[1;33m 4[0m

[1;35mEvaluation Hyper Parameters:
[0m[1;36meval_args[0m =[1;33m {'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}[0m
[1;36mrepeatable[0m =[1;33m True[0m
[1;36mmetrics[0m =[1;33m ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision'][0m
[1;36mtopk[0m =[1;33m [5][0m
[1;36mvalid_metric[0m =[1;33m mrr@5[0m
[1;36mvalid_metric_bigger[0m =[1;33m True[0m
[1;36meval_batch_size[0m =[1;33m 128[0m
[1;36mmetric_decimal_place[0m =[1;33m 4[0m

[1;35mDataset Hyper Parameters:
[0m[1;36mfield_separator[0m =[1;33m 	[0m
[1;36mseq_separator[0m =[1;33m  [0m
[1;36mUSER_ID_FIELD[0m =[1;33m user_id[0m
[1;36mITEM_ID_FIELD[0m =[1;33m item_id[0m
[1;36mRATING_FIELD[0m =[1;33m rating[0m
[1;36mTIME_FIELD[0m =[1;33m timestamp[0m
[1;36mseq_len[0m =[1;33m None[0m
[1;36mLABEL_FIELD[0m =[1;33m label[0m
[1;36mthreshold[0m =[1;33m None[0m
[1;36mNEG_PREFIX[0m =[1;33m neg_[0m
[1;36mload_col[0m =[1;33m {'inter': ['user_id', 'item_id', 'rating', 'timestamp'], 'item': ['item_id', 'title', 'brand']}[0m
[1;36munload_col[0m =[1;33m None[0m
[1;36munused_col[0m =[1;33m None[0m
[1;36madditional_feat_suffix[0m =[1;33m None[0m
[1;36mrm_dup_inter[0m =[1;33m None[0m
[1;36mval_interval[0m =[1;33m None[0m
[1;36mfilter_inter_by_user_or_item[0m =[1;33m True[0m
[1;36muser_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36mitem_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36malias_of_user_id[0m =[1;33m None[0m
[1;36malias_of_item_id[0m =[1;33m None[0m
[1;36malias_of_entity_id[0m =[1;33m None[0m
[1;36malias_of_relation_id[0m =[1;33m None[0m
[1;36mpreload_weight[0m =[1;33m None[0m
[1;36mnormalize_field[0m =[1;33m None[0m
[1;36mnormalize_all[0m =[1;33m None[0m
[1;36mITEM_LIST_LENGTH_FIELD[0m =[1;33m item_length[0m
[1;36mLIST_SUFFIX[0m =[1;33m _list[0m
[1;36mMAX_ITEM_LIST_LENGTH[0m =[1;33m 50[0m
[1;36mPOSITION_FIELD[0m =[1;33m position_id[0m
[1;36mHEAD_ENTITY_ID_FIELD[0m =[1;33m head_id[0m
[1;36mTAIL_ENTITY_ID_FIELD[0m =[1;33m tail_id[0m
[1;36mRELATION_ID_FIELD[0m =[1;33m relation_id[0m
[1;36mENTITY_ID_FIELD[0m =[1;33m entity_id[0m
[1;36mbenchmark_filename[0m =[1;33m None[0m

[1;35mOther Hyper Parameters: 
[0m[1;36mworker[0m = [1;33m0[0m
[1;36mwandb_project[0m = [1;33mrecbole[0m
[1;36mshuffle[0m = [1;33mTrue[0m
[1;36mrequire_pow[0m = [1;33mFalse[0m
[1;36menable_amp[0m = [1;33mFalse[0m
[1;36menable_scaler[0m = [1;33mFalse[0m
[1;36mtransform[0m = [1;33mNone[0m
[1;36mn_layers[0m = [1;33m16[0m
[1;36mn_heads[0m = [1;33m4[0m
[1;36mhidden_size[0m = [1;33m256[0m
[1;36minner_size[0m = [1;33m256[0m
[1;36mhidden_dropout_prob[0m = [1;33m0.5[0m
[1;36mattn_dropout_prob[0m = [1;33m0.5[0m
[1;36mhidden_act[0m = [1;33mgelu[0m
[1;36mlayer_norm_eps[0m = [1;33m1e-12[0m
[1;36minitializer_range[0m = [1;33m0.02[0m
[1;36mselected_features[0m = [1;33m['title', 'brand'][0m
[1;36mpooling_mode[0m = [1;33msum[0m
[1;36mloss_type[0m = [1;33mInfoNCE-quick[0m
[1;36mnumerical_features[0m = [1;33m[][0m
[1;36mdiscretization[0m = [1;33mNone[0m
[1;36mkg_reverse_r[0m = [1;33mFalse[0m
[1;36mentity_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mrelation_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mMODEL_TYPE[0m = [1;33mModelType.SEQUENTIAL[0m
[1;36mmlflow[0m = [1;33m{'enable': True, 'experiment_name': 'fine-tune', 'run_name': '0f5d1302-97f4-4127-9cee-a6a702a5625b', 'tracking_uri': 'sqlite:///mlruns.sqlite', 'auto_continue': True}[0m
[1;36mmax_grad_norm[0m = [1;33m1.0[0m
[1;36mscheduler[0m = [1;33m{'type': 'one-cycle'}[0m
[1;36mnce_temperature[0m = [1;33m1[0m
[1;36mnce_label_smoothing[0m = [1;33m0.0[0m
[1;36mnormalize_embedding[0m = [1;33mFalse[0m
[1;36mevaluation_mode[0m = [1;33msampled50000[0m
[1;36mestimate_batch_size[0m = [1;33mFalse[0m
[1;36mnce_num_negatives[0m = [1;33m300[0m
[1;36mnce_sampling_strategy[0m = [1;33mpopularity[0m
[1;36mnce_global_negatives[0m = [1;33mFalse[0m
[1;36mgradient_accumulation_steps[0m = [1;33m10[0m
[1;36meval_type[0m = [1;33mEvaluatorType.RANKING[0m
[1;36msingle_spec[0m = [1;33mTrue[0m
[1;36mlocal_rank[0m = [1;33m0[0m
[1;36mdevice[0m = [1;33mcuda[0m
[1;36mvalid_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m
[1;36mtest_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m


INFO:root:[1;35m[Training]: [0m[1;36mtrain_batch_size[0m = [1;33m[128][0m[1;36m train_neg_sample_args[0m: [1;33m[{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}][0m
INFO:root:[1;35m[Evaluation]: [0m[1;36meval_batch_size[0m = [1;33m[128][0m[1;36m eval_args[0m: [1;33m[{'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}][0m
item features
The batch_size of interaction: 504
    item_id, torch.Size([504]), cuda, torch.int64
    title, torch.Size([504, 40]), cuda, torch.int64
    brand, torch.Size([504, 7]), cuda, torch.int64


example
['‚ñÅcra' 'bt' 'ree' '‚ñÅamp' '‚ñÅevelyn' '‚ñÅgardener' '‚ñÅs' '‚ñÅultra' '‚ñÅmoistur'
 'ising' '‚ñÅhand' '‚ñÅtherapy' '‚ñÅpump' '‚ñÅ250' 'g' '‚ñÅ8' '‚ñÅ8' '‚ñÅoz' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]']
INFO:alembic.runtime.migration:Context impl SQLiteImpl.
INFO:alembic.runtime.migration:Will assume non-transactional DDL.
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 6477056 but failed
tried to log param model_non_emb_params with value -4778240 but failed
tried to log param unfreeze_n_layers with value 5 but failed
Evaluation sanity
****************************************
2024-07-10 10:47:52 pid 8195 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:53 pid 8195 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.61 seconds, [1;33mGPU RAM: 2.30 G/15.78 G[0m
2024-07-10 10:47:53 pid 8195 | finished [1;35mEvaluate in test   [0m. Total time: 0.61 seconds
OrderedDict([('recall@5', 0.1216), ('mrr@5', 0.0466), ('ndcg@5', 0.0654), ('hit@5', 0.1216), ('precision@5', 0.0243), ('test_loss', 6.196314811706543)])
****************************************
Freezing embeddings
Freezing layer 0
Freezing layer 1
Freezing layer 2
Freezing layer 3
Freezing layer 4
Freezing layer 5
Freezing layer 6
Freezing layer 7
Freezing layer 8
Freezing layer 9
Freezing layer 10
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 2110720 but failed
tried to log param model_non_emb_params with value -9144576 but failed
2024-07-10 10:47:53 pid 8195 | starting to iterate Train     0 (total=3), updating every 1 seconds
2024-07-10 10:47:55 pid 8195 | 0 of 3, 0.0% of Train     0, speed: -0.00 s/it, elapsed 0.55 seconds, [1;31mGPU RAM: 5.32 G/15.78 G loss: 5.63239[0m
2024-07-10 10:47:55 pid 8195 | finished Train     0. Total time: 0.55 seconds
INFO:root:[1;32mepoch 0 training[0m [[1;34mtime[0m: 1.75s, [1;34mtrain loss[0m: 5.4861]
2024-07-10 10:47:55 pid 8195 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:55 pid 8195 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.33 G/15.78 G[0m
2024-07-10 10:47:55 pid 8195 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.277775287628174)])
INFO:root:[1;32mepoch 0 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.277775287628174
2024-07-10 10:47:55 pid 8195 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1328), ('mrr@5', 0.0607), ('ndcg@5', 0.0787), ('hit@5', 0.1328), ('precision@5', 0.0266)])
2024-07-10 10:47:55 pid 8195 | starting to iterate Train     1 (total=3), updating every 1 seconds
2024-07-10 10:47:57 pid 8195 | 0 of 3, 0.0% of Train     1, speed: -0.00 s/it, elapsed 0.54 seconds, [1;31mGPU RAM: 5.33 G/15.78 G loss: 5.65958[0m
2024-07-10 10:47:57 pid 8195 | finished Train     1. Total time: 0.54 seconds
INFO:root:[1;32mepoch 1 training[0m [[1;34mtime[0m: 1.72s, [1;34mtrain loss[0m: 5.3698]
2024-07-10 10:47:57 pid 8195 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:57 pid 8195 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.33 G/15.78 G[0m
2024-07-10 10:47:57 pid 8195 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.256067752838135)])
INFO:root:[1;32mepoch 1 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.256067752838135
2024-07-10 10:47:57 pid 8195 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1328), ('mrr@5', 0.0607), ('ndcg@5', 0.0787), ('hit@5', 0.1328), ('precision@5', 0.0266)])
2024-07-10 10:47:57 pid 8195 | starting to iterate Train     2 (total=3), updating every 1 seconds
2024-07-10 10:47:59 pid 8195 | 0 of 3, 0.0% of Train     2, speed: -0.00 s/it, elapsed 0.56 seconds, [1;31mGPU RAM: 5.33 G/15.78 G loss: 5.46392[0m
2024-07-10 10:47:59 pid 8195 | finished Train     2. Total time: 0.56 seconds
INFO:root:[1;32mepoch 2 training[0m [[1;34mtime[0m: 1.75s, [1;34mtrain loss[0m: 5.4345]
2024-07-10 10:47:59 pid 8195 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:47:59 pid 8195 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.33 G/15.78 G[0m
2024-07-10 10:47:59 pid 8195 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.332088470458984)])
INFO:root:[1;32mepoch 2 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.332088470458984
2024-07-10 10:47:59 pid 8195 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1406), ('mrr@5', 0.0622), ('ndcg@5', 0.0817), ('hit@5', 0.1406), ('precision@5', 0.0281)])
2024-07-10 10:47:59 pid 8195 | starting to iterate Train     3 (total=3), updating every 1 seconds
2024-07-10 10:48:01 pid 8195 | 0 of 3, 0.0% of Train     3, speed: -0.00 s/it, elapsed 0.54 seconds, [1;31mGPU RAM: 5.33 G/15.78 G loss: 5.54685[0m
2024-07-10 10:48:01 pid 8195 | finished Train     3. Total time: 0.54 seconds
INFO:root:[1;32mepoch 3 training[0m [[1;34mtime[0m: 1.73s, [1;34mtrain loss[0m: 5.3894]
2024-07-10 10:48:01 pid 8195 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:01 pid 8195 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.33 G/15.78 G[0m
2024-07-10 10:48:01 pid 8195 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.319723129272461)])
INFO:root:[1;32mepoch 3 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.319723129272461
2024-07-10 10:48:01 pid 8195 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1406), ('mrr@5', 0.0622), ('ndcg@5', 0.0817), ('hit@5', 0.1406), ('precision@5', 0.0281)])
2024-07-10 10:48:01 pid 8195 | starting to iterate Train     4 (total=3), updating every 1 seconds
2024-07-10 10:48:03 pid 8195 | 0 of 3, 0.0% of Train     4, speed: -0.00 s/it, elapsed 0.57 seconds, [1;31mGPU RAM: 5.33 G/15.78 G loss: 5.58679[0m
2024-07-10 10:48:03 pid 8195 | finished Train     4. Total time: 0.57 seconds
INFO:root:[1;32mepoch 4 training[0m [[1;34mtime[0m: 1.77s, [1;34mtrain loss[0m: 5.5090]
2024-07-10 10:48:03 pid 8195 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:03 pid 8195 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.33 G/15.78 G[0m
2024-07-10 10:48:03 pid 8195 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.302261829376221)])
INFO:root:[1;32mepoch 4 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.302261829376221
2024-07-10 10:48:03 pid 8195 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1406), ('mrr@5', 0.0616), ('ndcg@5', 0.0812), ('hit@5', 0.1406), ('precision@5', 0.0281)])
2024-07-10 10:48:03 pid 8195 | starting to iterate Train     5 (total=3), updating every 1 seconds
2024-07-10 10:48:05 pid 8195 | 0 of 3, 0.0% of Train     5, speed: -0.00 s/it, elapsed 0.59 seconds, [1;31mGPU RAM: 5.33 G/15.78 G loss: 5.53938[0m
2024-07-10 10:48:05 pid 8195 | finished Train     5. Total time: 0.59 seconds
INFO:root:[1;32mepoch 5 training[0m [[1;34mtime[0m: 1.77s, [1;34mtrain loss[0m: 5.5882]
2024-07-10 10:48:05 pid 8195 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:05 pid 8195 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.33 G/15.78 G[0m
2024-07-10 10:48:05 pid 8195 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.349740505218506)])
INFO:root:[1;32mepoch 5 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.349740505218506
2024-07-10 10:48:05 pid 8195 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1406), ('mrr@5', 0.0661), ('ndcg@5', 0.0846), ('hit@5', 0.1406), ('precision@5', 0.0281)])
2024-07-10 10:48:05 pid 8195 | starting to iterate Train     6 (total=3), updating every 1 seconds
2024-07-10 10:48:07 pid 8195 | 0 of 3, 0.0% of Train     6, speed: -0.00 s/it, elapsed 0.55 seconds, [1;31mGPU RAM: 5.33 G/15.78 G loss: 5.59226[0m
2024-07-10 10:48:07 pid 8195 | finished Train     6. Total time: 0.55 seconds
INFO:root:[1;32mepoch 6 training[0m [[1;34mtime[0m: 1.74s, [1;34mtrain loss[0m: 5.5659]
2024-07-10 10:48:07 pid 8195 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:07 pid 8195 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.33 G/15.78 G[0m
2024-07-10 10:48:07 pid 8195 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.34280252456665)])
INFO:root:[1;32mepoch 6 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.34280252456665
2024-07-10 10:48:07 pid 8195 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1406), ('mrr@5', 0.0665), ('ndcg@5', 0.085), ('hit@5', 0.1406), ('precision@5', 0.0281)])
2024-07-10 10:48:07 pid 8195 | starting to iterate Train     7 (total=3), updating every 1 seconds
2024-07-10 10:48:09 pid 8195 | 0 of 3, 0.0% of Train     7, speed: -0.00 s/it, elapsed 0.54 seconds, [1;31mGPU RAM: 5.33 G/15.78 G loss: 5.58112[0m
2024-07-10 10:48:09 pid 8195 | finished Train     7. Total time: 0.54 seconds
INFO:root:[1;32mepoch 7 training[0m [[1;34mtime[0m: 1.73s, [1;34mtrain loss[0m: 5.6119]
2024-07-10 10:48:09 pid 8195 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:09 pid 8195 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.33 G/15.78 G[0m
2024-07-10 10:48:09 pid 8195 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.273115158081055)])
INFO:root:[1;32mepoch 7 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.273115158081055
2024-07-10 10:48:09 pid 8195 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1406), ('mrr@5', 0.0665), ('ndcg@5', 0.085), ('hit@5', 0.1406), ('precision@5', 0.0281)])
2024-07-10 10:48:09 pid 8195 | starting to iterate Train     8 (total=3), updating every 1 seconds
2024-07-10 10:48:11 pid 8195 | 0 of 3, 0.0% of Train     8, speed: -0.00 s/it, elapsed 0.54 seconds, [1;31mGPU RAM: 5.33 G/15.78 G loss: 5.55442[0m
2024-07-10 10:48:11 pid 8195 | finished Train     8. Total time: 0.54 seconds
INFO:root:[1;32mepoch 8 training[0m [[1;34mtime[0m: 1.71s, [1;34mtrain loss[0m: 5.5692]
2024-07-10 10:48:11 pid 8195 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:11 pid 8195 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.33 G/15.78 G[0m
2024-07-10 10:48:11 pid 8195 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.409729957580566)])
INFO:root:[1;32mepoch 8 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.409729957580566
2024-07-10 10:48:11 pid 8195 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1484), ('mrr@5', 0.0685), ('ndcg@5', 0.0883), ('hit@5', 0.1484), ('precision@5', 0.0297)])
2024-07-10 10:48:11 pid 8195 | starting to iterate Train     9 (total=3), updating every 1 seconds
2024-07-10 10:48:13 pid 8195 | 0 of 3, 0.0% of Train     9, speed: -0.00 s/it, elapsed 0.54 seconds, [1;31mGPU RAM: 5.33 G/15.78 G loss: 5.42806[0m
2024-07-10 10:48:13 pid 8195 | finished Train     9. Total time: 0.54 seconds
INFO:root:[1;32mepoch 9 training[0m [[1;34mtime[0m: 1.71s, [1;34mtrain loss[0m: 5.7200]
2024-07-10 10:48:13 pid 8195 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:13 pid 8195 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.33 G/15.78 G[0m
2024-07-10 10:48:13 pid 8195 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.311626434326172)])
INFO:root:[1;32mepoch 9 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.311626434326172
2024-07-10 10:48:13 pid 8195 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1641), ('mrr@5', 0.0729), ('ndcg@5', 0.0954), ('hit@5', 0.1641), ('precision@5', 0.0328)])
Saving checkpoint on /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/05.pth
INFO:root:[1;34mSaving current[0m: /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/05.pth
2024-07-10 10:48:13 pid 8195 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:13 pid 8195 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.33 G/15.78 G[0m
2024-07-10 10:48:13 pid 8195 | finished [1;35mEvaluate in test   [0m. Total time: 0.05 seconds
OrderedDict([('recall@5', 0.1081), ('mrr@5', 0.0421), ('ndcg@5', 0.0587), ('hit@5', 0.1081), ('precision@5', 0.0216), ('test_loss', 6.139822959899902)])
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
INFO:faiss.loader:Loading faiss.
INFO:faiss.loader:Successfully loaded faiss.
WARNING:root:command line args [-c confs/fine_tune/progressive.json -s amazon-beauty -l amazon-100K -i test.pth -p confs/pre_train/config_dict_100K.json -o fine_tuned_checkpoint.pth] will not be used in RecBole

[1;35mGeneral Hyper Parameters:
[0m[1;36mgpu_id[0m =[1;33m 0[0m
[1;36muse_gpu[0m =[1;33m True[0m
[1;36mseed[0m =[1;33m 2020[0m
[1;36mstate[0m =[1;33m INFO[0m
[1;36mreproducibility[0m =[1;33m True[0m
[1;36mdata_path[0m =[1;33m /alloc/data/srt/data/output/amazon-beauty[0m
[1;36mcheckpoint_dir[0m =[1;33m saved[0m
[1;36mshow_progress[0m =[1;33m True[0m
[1;36msave_dataset[0m =[1;33m False[0m
[1;36mdataset_save_path[0m =[1;33m None[0m
[1;36msave_dataloaders[0m =[1;33m False[0m
[1;36mdataloaders_save_path[0m =[1;33m None[0m
[1;36mlog_wandb[0m =[1;33m False[0m

[1;35mTraining Hyper Parameters:
[0m[1;36mepochs[0m =[1;33m 2[0m
[1;36mtrain_batch_size[0m =[1;33m 128[0m
[1;36mlearner[0m =[1;33m adam[0m
[1;36mlearning_rate[0m =[1;33m 0.0001[0m
[1;36mtrain_neg_sample_args[0m =[1;33m {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}[0m
[1;36meval_step[0m =[1;33m 1[0m
[1;36mstopping_step[0m =[1;33m 20[0m
[1;36mclip_grad_norm[0m =[1;33m None[0m
[1;36mweight_decay[0m =[1;33m 1e-05[0m
[1;36mloss_decimal_place[0m =[1;33m 4[0m

[1;35mEvaluation Hyper Parameters:
[0m[1;36meval_args[0m =[1;33m {'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}[0m
[1;36mrepeatable[0m =[1;33m True[0m
[1;36mmetrics[0m =[1;33m ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision'][0m
[1;36mtopk[0m =[1;33m [5][0m
[1;36mvalid_metric[0m =[1;33m mrr@5[0m
[1;36mvalid_metric_bigger[0m =[1;33m True[0m
[1;36meval_batch_size[0m =[1;33m 128[0m
[1;36mmetric_decimal_place[0m =[1;33m 4[0m

[1;35mDataset Hyper Parameters:
[0m[1;36mfield_separator[0m =[1;33m 	[0m
[1;36mseq_separator[0m =[1;33m  [0m
[1;36mUSER_ID_FIELD[0m =[1;33m user_id[0m
[1;36mITEM_ID_FIELD[0m =[1;33m item_id[0m
[1;36mRATING_FIELD[0m =[1;33m rating[0m
[1;36mTIME_FIELD[0m =[1;33m timestamp[0m
[1;36mseq_len[0m =[1;33m None[0m
[1;36mLABEL_FIELD[0m =[1;33m label[0m
[1;36mthreshold[0m =[1;33m None[0m
[1;36mNEG_PREFIX[0m =[1;33m neg_[0m
[1;36mload_col[0m =[1;33m {'inter': ['user_id', 'item_id', 'rating', 'timestamp'], 'item': ['item_id', 'title', 'brand']}[0m
[1;36munload_col[0m =[1;33m None[0m
[1;36munused_col[0m =[1;33m None[0m
[1;36madditional_feat_suffix[0m =[1;33m None[0m
[1;36mrm_dup_inter[0m =[1;33m None[0m
[1;36mval_interval[0m =[1;33m None[0m
[1;36mfilter_inter_by_user_or_item[0m =[1;33m True[0m
[1;36muser_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36mitem_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36malias_of_user_id[0m =[1;33m None[0m
[1;36malias_of_item_id[0m =[1;33m None[0m
[1;36malias_of_entity_id[0m =[1;33m None[0m
[1;36malias_of_relation_id[0m =[1;33m None[0m
[1;36mpreload_weight[0m =[1;33m None[0m
[1;36mnormalize_field[0m =[1;33m None[0m
[1;36mnormalize_all[0m =[1;33m None[0m
[1;36mITEM_LIST_LENGTH_FIELD[0m =[1;33m item_length[0m
[1;36mLIST_SUFFIX[0m =[1;33m _list[0m
[1;36mMAX_ITEM_LIST_LENGTH[0m =[1;33m 50[0m
[1;36mPOSITION_FIELD[0m =[1;33m position_id[0m
[1;36mHEAD_ENTITY_ID_FIELD[0m =[1;33m head_id[0m
[1;36mTAIL_ENTITY_ID_FIELD[0m =[1;33m tail_id[0m
[1;36mRELATION_ID_FIELD[0m =[1;33m relation_id[0m
[1;36mENTITY_ID_FIELD[0m =[1;33m entity_id[0m
[1;36mbenchmark_filename[0m =[1;33m None[0m

[1;35mOther Hyper Parameters: 
[0m[1;36mworker[0m = [1;33m0[0m
[1;36mwandb_project[0m = [1;33mrecbole[0m
[1;36mshuffle[0m = [1;33mTrue[0m
[1;36mrequire_pow[0m = [1;33mFalse[0m
[1;36menable_amp[0m = [1;33mFalse[0m
[1;36menable_scaler[0m = [1;33mFalse[0m
[1;36mtransform[0m = [1;33mNone[0m
[1;36mn_layers[0m = [1;33m16[0m
[1;36mn_heads[0m = [1;33m4[0m
[1;36mhidden_size[0m = [1;33m256[0m
[1;36minner_size[0m = [1;33m256[0m
[1;36mhidden_dropout_prob[0m = [1;33m0.5[0m
[1;36mattn_dropout_prob[0m = [1;33m0.5[0m
[1;36mhidden_act[0m = [1;33mgelu[0m
[1;36mlayer_norm_eps[0m = [1;33m1e-12[0m
[1;36minitializer_range[0m = [1;33m0.02[0m
[1;36mselected_features[0m = [1;33m['title', 'brand'][0m
[1;36mpooling_mode[0m = [1;33msum[0m
[1;36mloss_type[0m = [1;33mInfoNCE-quick[0m
[1;36mnumerical_features[0m = [1;33m[][0m
[1;36mdiscretization[0m = [1;33mNone[0m
[1;36mkg_reverse_r[0m = [1;33mFalse[0m
[1;36mentity_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mrelation_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mMODEL_TYPE[0m = [1;33mModelType.SEQUENTIAL[0m
[1;36mmlflow[0m = [1;33m{'enable': True, 'experiment_name': 'fine-tune', 'run_name': '0f5d1302-97f4-4127-9cee-a6a702a5625b', 'tracking_uri': 'sqlite:///mlruns.sqlite', 'auto_continue': True}[0m
[1;36mmax_grad_norm[0m = [1;33m1.0[0m
[1;36mscheduler[0m = [1;33m{'type': 'one-cycle'}[0m
[1;36mnce_temperature[0m = [1;33m1[0m
[1;36mnce_label_smoothing[0m = [1;33m0.0[0m
[1;36mnormalize_embedding[0m = [1;33mFalse[0m
[1;36mevaluation_mode[0m = [1;33msampled50000[0m
[1;36mestimate_batch_size[0m = [1;33mFalse[0m
[1;36mnce_num_negatives[0m = [1;33m300[0m
[1;36mnce_sampling_strategy[0m = [1;33mpopularity[0m
[1;36mnce_global_negatives[0m = [1;33mFalse[0m
[1;36mgradient_accumulation_steps[0m = [1;33m10[0m
[1;36meval_type[0m = [1;33mEvaluatorType.RANKING[0m
[1;36msingle_spec[0m = [1;33mTrue[0m
[1;36mlocal_rank[0m = [1;33m0[0m
[1;36mdevice[0m = [1;33mcuda[0m
[1;36mvalid_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m
[1;36mtest_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m


INFO:root:[1;35m[Training]: [0m[1;36mtrain_batch_size[0m = [1;33m[128][0m[1;36m train_neg_sample_args[0m: [1;33m[{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}][0m
INFO:root:[1;35m[Evaluation]: [0m[1;36meval_batch_size[0m = [1;33m[128][0m[1;36m eval_args[0m: [1;33m[{'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}][0m
item features
The batch_size of interaction: 504
    item_id, torch.Size([504]), cuda, torch.int64
    title, torch.Size([504, 40]), cuda, torch.int64
    brand, torch.Size([504, 7]), cuda, torch.int64


example
['‚ñÅcra' 'bt' 'ree' '‚ñÅamp' '‚ñÅevelyn' '‚ñÅgardener' '‚ñÅs' '‚ñÅultra' '‚ñÅmoistur'
 'ising' '‚ñÅhand' '‚ñÅtherapy' '‚ñÅpump' '‚ñÅ250' 'g' '‚ñÅ8' '‚ñÅ8' '‚ñÅoz' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]']
INFO:alembic.runtime.migration:Context impl SQLiteImpl.
INFO:alembic.runtime.migration:Will assume non-transactional DDL.
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 6477056 but failed
tried to log param model_non_emb_params with value -4778240 but failed
tried to log param unfreeze_n_layers with value 6 but failed
Evaluation sanity
****************************************
2024-07-10 10:48:17 pid 8208 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:17 pid 8208 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.60 seconds, [1;33mGPU RAM: 2.30 G/15.78 G[0m
2024-07-10 10:48:17 pid 8208 | finished [1;35mEvaluate in test   [0m. Total time: 0.60 seconds
OrderedDict([('recall@5', 0.1081), ('mrr@5', 0.0421), ('ndcg@5', 0.0587), ('hit@5', 0.1081), ('precision@5', 0.0216), ('test_loss', 6.181418418884277)])
****************************************
Freezing embeddings
Freezing layer 0
Freezing layer 1
Freezing layer 2
Freezing layer 3
Freezing layer 4
Freezing layer 5
Freezing layer 6
Freezing layer 7
Freezing layer 8
Freezing layer 9
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 2506496 but failed
tried to log param model_non_emb_params with value -8748800 but failed
2024-07-10 10:48:18 pid 8208 | starting to iterate Train     0 (total=3), updating every 1 seconds
2024-07-10 10:48:20 pid 8208 | 0 of 3, 0.0% of Train     0, speed: -0.00 s/it, elapsed 0.60 seconds, [1;31mGPU RAM: 5.33 G/15.78 G loss: 5.50263[0m
2024-07-10 10:48:20 pid 8208 | finished Train     0. Total time: 0.60 seconds
INFO:root:[1;32mepoch 0 training[0m [[1;34mtime[0m: 1.86s, [1;34mtrain loss[0m: 5.2897]
2024-07-10 10:48:20 pid 8208 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:20 pid 8208 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.34 G/15.78 G[0m
2024-07-10 10:48:20 pid 8208 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.276093482971191)])
INFO:root:[1;32mepoch 0 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.276093482971191
2024-07-10 10:48:20 pid 8208 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1562), ('mrr@5', 0.0714), ('ndcg@5', 0.0924), ('hit@5', 0.1562), ('precision@5', 0.0313)])
2024-07-10 10:48:20 pid 8208 | starting to iterate Train     1 (total=3), updating every 1 seconds
2024-07-10 10:48:22 pid 8208 | 0 of 3, 0.0% of Train     1, speed: -0.00 s/it, elapsed 0.58 seconds, [1;31mGPU RAM: 5.34 G/15.78 G loss: 5.51033[0m
2024-07-10 10:48:22 pid 8208 | finished Train     1. Total time: 0.58 seconds
INFO:root:[1;32mepoch 1 training[0m [[1;34mtime[0m: 1.82s, [1;34mtrain loss[0m: 5.1350]
2024-07-10 10:48:22 pid 8208 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:22 pid 8208 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.34 G/15.78 G[0m
2024-07-10 10:48:22 pid 8208 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.255002021789551)])
INFO:root:[1;32mepoch 1 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.255002021789551
2024-07-10 10:48:22 pid 8208 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1641), ('mrr@5', 0.0729), ('ndcg@5', 0.0954), ('hit@5', 0.1641), ('precision@5', 0.0328)])
2024-07-10 10:48:22 pid 8208 | starting to iterate Train     2 (total=3), updating every 1 seconds
2024-07-10 10:48:24 pid 8208 | 0 of 3, 0.0% of Train     2, speed: -0.00 s/it, elapsed 0.56 seconds, [1;31mGPU RAM: 5.34 G/15.78 G loss: 5.29520[0m
2024-07-10 10:48:24 pid 8208 | finished Train     2. Total time: 0.56 seconds
INFO:root:[1;32mepoch 2 training[0m [[1;34mtime[0m: 1.81s, [1;34mtrain loss[0m: 5.1836]
2024-07-10 10:48:24 pid 8208 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:24 pid 8208 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.34 G/15.78 G[0m
2024-07-10 10:48:24 pid 8208 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.333080291748047)])
INFO:root:[1;32mepoch 2 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.333080291748047
2024-07-10 10:48:24 pid 8208 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1562), ('mrr@5', 0.0714), ('ndcg@5', 0.0924), ('hit@5', 0.1562), ('precision@5', 0.0313)])
2024-07-10 10:48:24 pid 8208 | starting to iterate Train     3 (total=3), updating every 1 seconds
2024-07-10 10:48:26 pid 8208 | 0 of 3, 0.0% of Train     3, speed: -0.00 s/it, elapsed 0.57 seconds, [1;31mGPU RAM: 5.34 G/15.78 G loss: 5.37245[0m
2024-07-10 10:48:26 pid 8208 | finished Train     3. Total time: 0.57 seconds
INFO:root:[1;32mepoch 3 training[0m [[1;34mtime[0m: 1.80s, [1;34mtrain loss[0m: 5.1758]
2024-07-10 10:48:26 pid 8208 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:26 pid 8208 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.34 G/15.78 G[0m
2024-07-10 10:48:26 pid 8208 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.315145015716553)])
INFO:root:[1;32mepoch 3 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.315145015716553
2024-07-10 10:48:26 pid 8208 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1641), ('mrr@5', 0.0729), ('ndcg@5', 0.0954), ('hit@5', 0.1641), ('precision@5', 0.0328)])
2024-07-10 10:48:26 pid 8208 | starting to iterate Train     4 (total=3), updating every 1 seconds
2024-07-10 10:48:28 pid 8208 | 0 of 3, 0.0% of Train     4, speed: -0.00 s/it, elapsed 0.56 seconds, [1;31mGPU RAM: 5.34 G/15.78 G loss: 5.41712[0m
2024-07-10 10:48:28 pid 8208 | finished Train     4. Total time: 0.56 seconds
INFO:root:[1;32mepoch 4 training[0m [[1;34mtime[0m: 1.80s, [1;34mtrain loss[0m: 5.3262]
2024-07-10 10:48:28 pid 8208 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:28 pid 8208 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.34 G/15.78 G[0m
2024-07-10 10:48:28 pid 8208 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.300208568572998)])
INFO:root:[1;32mepoch 4 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.300208568572998
2024-07-10 10:48:28 pid 8208 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1641), ('mrr@5', 0.0729), ('ndcg@5', 0.0954), ('hit@5', 0.1641), ('precision@5', 0.0328)])
2024-07-10 10:48:28 pid 8208 | starting to iterate Train     5 (total=3), updating every 1 seconds
2024-07-10 10:48:30 pid 8208 | 0 of 3, 0.0% of Train     5, speed: -0.00 s/it, elapsed 0.58 seconds, [1;31mGPU RAM: 5.34 G/15.78 G loss: 5.39896[0m
2024-07-10 10:48:30 pid 8208 | finished Train     5. Total time: 0.58 seconds
INFO:root:[1;32mepoch 5 training[0m [[1;34mtime[0m: 1.81s, [1;34mtrain loss[0m: 5.4206]
2024-07-10 10:48:30 pid 8208 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:30 pid 8208 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.34 G/15.78 G[0m
2024-07-10 10:48:30 pid 8208 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.352367401123047)])
INFO:root:[1;32mepoch 5 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.352367401123047
2024-07-10 10:48:30 pid 8208 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1719), ('mrr@5', 0.0745), ('ndcg@5', 0.0984), ('hit@5', 0.1719), ('precision@5', 0.0344)])
2024-07-10 10:48:30 pid 8208 | starting to iterate Train     6 (total=3), updating every 1 seconds
2024-07-10 10:48:32 pid 8208 | 0 of 3, 0.0% of Train     6, speed: -0.00 s/it, elapsed 0.58 seconds, [1;31mGPU RAM: 5.34 G/15.78 G loss: 5.46617[0m
2024-07-10 10:48:32 pid 8208 | finished Train     6. Total time: 0.58 seconds
INFO:root:[1;32mepoch 6 training[0m [[1;34mtime[0m: 1.82s, [1;34mtrain loss[0m: 5.4188]
2024-07-10 10:48:32 pid 8208 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:32 pid 8208 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.34 G/15.78 G[0m
2024-07-10 10:48:32 pid 8208 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.357768535614014)])
INFO:root:[1;32mepoch 6 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.357768535614014
2024-07-10 10:48:32 pid 8208 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1719), ('mrr@5', 0.0753), ('ndcg@5', 0.0991), ('hit@5', 0.1719), ('precision@5', 0.0344)])
2024-07-10 10:48:32 pid 8208 | starting to iterate Train     7 (total=3), updating every 1 seconds
2024-07-10 10:48:34 pid 8208 | 0 of 3, 0.0% of Train     7, speed: -0.00 s/it, elapsed 0.57 seconds, [1;31mGPU RAM: 5.34 G/15.78 G loss: 5.46775[0m
2024-07-10 10:48:34 pid 8208 | finished Train     7. Total time: 0.57 seconds
INFO:root:[1;32mepoch 7 training[0m [[1;34mtime[0m: 1.83s, [1;34mtrain loss[0m: 5.4840]
2024-07-10 10:48:34 pid 8208 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:34 pid 8208 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.34 G/15.78 G[0m
2024-07-10 10:48:34 pid 8208 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.273159503936768)])
INFO:root:[1;32mepoch 7 evaluating[0m [[1;34mtime[0m: 0.15s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.273159503936768
2024-07-10 10:48:34 pid 8208 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1719), ('mrr@5', 0.0757), ('ndcg@5', 0.0995), ('hit@5', 0.1719), ('precision@5', 0.0344)])
2024-07-10 10:48:35 pid 8208 | starting to iterate Train     8 (total=3), updating every 1 seconds
2024-07-10 10:48:36 pid 8208 | 0 of 3, 0.0% of Train     8, speed: -0.00 s/it, elapsed 0.57 seconds, [1;31mGPU RAM: 5.34 G/15.78 G loss: 5.43582[0m
2024-07-10 10:48:36 pid 8208 | finished Train     8. Total time: 0.57 seconds
INFO:root:[1;32mepoch 8 training[0m [[1;34mtime[0m: 1.84s, [1;34mtrain loss[0m: 5.4547]
2024-07-10 10:48:36 pid 8208 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:37 pid 8208 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.34 G/15.78 G[0m
2024-07-10 10:48:37 pid 8208 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.40979528427124)])
INFO:root:[1;32mepoch 8 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.40979528427124
2024-07-10 10:48:37 pid 8208 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1719), ('mrr@5', 0.075), ('ndcg@5', 0.099), ('hit@5', 0.1719), ('precision@5', 0.0344)])
2024-07-10 10:48:37 pid 8208 | starting to iterate Train     9 (total=3), updating every 1 seconds
2024-07-10 10:48:39 pid 8208 | 0 of 3, 0.0% of Train     9, speed: -0.00 s/it, elapsed 0.58 seconds, [1;31mGPU RAM: 5.34 G/15.78 G loss: 5.32129[0m
2024-07-10 10:48:39 pid 8208 | finished Train     9. Total time: 0.58 seconds
INFO:root:[1;32mepoch 9 training[0m [[1;34mtime[0m: 1.82s, [1;34mtrain loss[0m: 5.6177]
2024-07-10 10:48:39 pid 8208 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:39 pid 8208 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.34 G/15.78 G[0m
2024-07-10 10:48:39 pid 8208 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.314262390136719)])
INFO:root:[1;32mepoch 9 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.314262390136719
2024-07-10 10:48:39 pid 8208 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1719), ('mrr@5', 0.076), ('ndcg@5', 0.0999), ('hit@5', 0.1719), ('precision@5', 0.0344)])
Saving checkpoint on /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/06.pth
INFO:root:[1;34mSaving current[0m: /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/06.pth
2024-07-10 10:48:39 pid 8208 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:39 pid 8208 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.34 G/15.78 G[0m
2024-07-10 10:48:39 pid 8208 | finished [1;35mEvaluate in test   [0m. Total time: 0.05 seconds
OrderedDict([('recall@5', 0.0946), ('mrr@5', 0.0394), ('ndcg@5', 0.0534), ('hit@5', 0.0946), ('precision@5', 0.0189), ('test_loss', 6.123683452606201)])
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
INFO:faiss.loader:Loading faiss.
INFO:faiss.loader:Successfully loaded faiss.
WARNING:root:command line args [-c confs/fine_tune/progressive.json -s amazon-beauty -l amazon-100K -i test.pth -p confs/pre_train/config_dict_100K.json -o fine_tuned_checkpoint.pth] will not be used in RecBole

[1;35mGeneral Hyper Parameters:
[0m[1;36mgpu_id[0m =[1;33m 0[0m
[1;36muse_gpu[0m =[1;33m True[0m
[1;36mseed[0m =[1;33m 2020[0m
[1;36mstate[0m =[1;33m INFO[0m
[1;36mreproducibility[0m =[1;33m True[0m
[1;36mdata_path[0m =[1;33m /alloc/data/srt/data/output/amazon-beauty[0m
[1;36mcheckpoint_dir[0m =[1;33m saved[0m
[1;36mshow_progress[0m =[1;33m True[0m
[1;36msave_dataset[0m =[1;33m False[0m
[1;36mdataset_save_path[0m =[1;33m None[0m
[1;36msave_dataloaders[0m =[1;33m False[0m
[1;36mdataloaders_save_path[0m =[1;33m None[0m
[1;36mlog_wandb[0m =[1;33m False[0m

[1;35mTraining Hyper Parameters:
[0m[1;36mepochs[0m =[1;33m 2[0m
[1;36mtrain_batch_size[0m =[1;33m 128[0m
[1;36mlearner[0m =[1;33m adam[0m
[1;36mlearning_rate[0m =[1;33m 0.0001[0m
[1;36mtrain_neg_sample_args[0m =[1;33m {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}[0m
[1;36meval_step[0m =[1;33m 1[0m
[1;36mstopping_step[0m =[1;33m 20[0m
[1;36mclip_grad_norm[0m =[1;33m None[0m
[1;36mweight_decay[0m =[1;33m 1e-05[0m
[1;36mloss_decimal_place[0m =[1;33m 4[0m

[1;35mEvaluation Hyper Parameters:
[0m[1;36meval_args[0m =[1;33m {'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}[0m
[1;36mrepeatable[0m =[1;33m True[0m
[1;36mmetrics[0m =[1;33m ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision'][0m
[1;36mtopk[0m =[1;33m [5][0m
[1;36mvalid_metric[0m =[1;33m mrr@5[0m
[1;36mvalid_metric_bigger[0m =[1;33m True[0m
[1;36meval_batch_size[0m =[1;33m 128[0m
[1;36mmetric_decimal_place[0m =[1;33m 4[0m

[1;35mDataset Hyper Parameters:
[0m[1;36mfield_separator[0m =[1;33m 	[0m
[1;36mseq_separator[0m =[1;33m  [0m
[1;36mUSER_ID_FIELD[0m =[1;33m user_id[0m
[1;36mITEM_ID_FIELD[0m =[1;33m item_id[0m
[1;36mRATING_FIELD[0m =[1;33m rating[0m
[1;36mTIME_FIELD[0m =[1;33m timestamp[0m
[1;36mseq_len[0m =[1;33m None[0m
[1;36mLABEL_FIELD[0m =[1;33m label[0m
[1;36mthreshold[0m =[1;33m None[0m
[1;36mNEG_PREFIX[0m =[1;33m neg_[0m
[1;36mload_col[0m =[1;33m {'inter': ['user_id', 'item_id', 'rating', 'timestamp'], 'item': ['item_id', 'title', 'brand']}[0m
[1;36munload_col[0m =[1;33m None[0m
[1;36munused_col[0m =[1;33m None[0m
[1;36madditional_feat_suffix[0m =[1;33m None[0m
[1;36mrm_dup_inter[0m =[1;33m None[0m
[1;36mval_interval[0m =[1;33m None[0m
[1;36mfilter_inter_by_user_or_item[0m =[1;33m True[0m
[1;36muser_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36mitem_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36malias_of_user_id[0m =[1;33m None[0m
[1;36malias_of_item_id[0m =[1;33m None[0m
[1;36malias_of_entity_id[0m =[1;33m None[0m
[1;36malias_of_relation_id[0m =[1;33m None[0m
[1;36mpreload_weight[0m =[1;33m None[0m
[1;36mnormalize_field[0m =[1;33m None[0m
[1;36mnormalize_all[0m =[1;33m None[0m
[1;36mITEM_LIST_LENGTH_FIELD[0m =[1;33m item_length[0m
[1;36mLIST_SUFFIX[0m =[1;33m _list[0m
[1;36mMAX_ITEM_LIST_LENGTH[0m =[1;33m 50[0m
[1;36mPOSITION_FIELD[0m =[1;33m position_id[0m
[1;36mHEAD_ENTITY_ID_FIELD[0m =[1;33m head_id[0m
[1;36mTAIL_ENTITY_ID_FIELD[0m =[1;33m tail_id[0m
[1;36mRELATION_ID_FIELD[0m =[1;33m relation_id[0m
[1;36mENTITY_ID_FIELD[0m =[1;33m entity_id[0m
[1;36mbenchmark_filename[0m =[1;33m None[0m

[1;35mOther Hyper Parameters: 
[0m[1;36mworker[0m = [1;33m0[0m
[1;36mwandb_project[0m = [1;33mrecbole[0m
[1;36mshuffle[0m = [1;33mTrue[0m
[1;36mrequire_pow[0m = [1;33mFalse[0m
[1;36menable_amp[0m = [1;33mFalse[0m
[1;36menable_scaler[0m = [1;33mFalse[0m
[1;36mtransform[0m = [1;33mNone[0m
[1;36mn_layers[0m = [1;33m16[0m
[1;36mn_heads[0m = [1;33m4[0m
[1;36mhidden_size[0m = [1;33m256[0m
[1;36minner_size[0m = [1;33m256[0m
[1;36mhidden_dropout_prob[0m = [1;33m0.5[0m
[1;36mattn_dropout_prob[0m = [1;33m0.5[0m
[1;36mhidden_act[0m = [1;33mgelu[0m
[1;36mlayer_norm_eps[0m = [1;33m1e-12[0m
[1;36minitializer_range[0m = [1;33m0.02[0m
[1;36mselected_features[0m = [1;33m['title', 'brand'][0m
[1;36mpooling_mode[0m = [1;33msum[0m
[1;36mloss_type[0m = [1;33mInfoNCE-quick[0m
[1;36mnumerical_features[0m = [1;33m[][0m
[1;36mdiscretization[0m = [1;33mNone[0m
[1;36mkg_reverse_r[0m = [1;33mFalse[0m
[1;36mentity_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mrelation_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mMODEL_TYPE[0m = [1;33mModelType.SEQUENTIAL[0m
[1;36mmlflow[0m = [1;33m{'enable': True, 'experiment_name': 'fine-tune', 'run_name': '0f5d1302-97f4-4127-9cee-a6a702a5625b', 'tracking_uri': 'sqlite:///mlruns.sqlite', 'auto_continue': True}[0m
[1;36mmax_grad_norm[0m = [1;33m1.0[0m
[1;36mscheduler[0m = [1;33m{'type': 'one-cycle'}[0m
[1;36mnce_temperature[0m = [1;33m1[0m
[1;36mnce_label_smoothing[0m = [1;33m0.0[0m
[1;36mnormalize_embedding[0m = [1;33mFalse[0m
[1;36mevaluation_mode[0m = [1;33msampled50000[0m
[1;36mestimate_batch_size[0m = [1;33mFalse[0m
[1;36mnce_num_negatives[0m = [1;33m300[0m
[1;36mnce_sampling_strategy[0m = [1;33mpopularity[0m
[1;36mnce_global_negatives[0m = [1;33mFalse[0m
[1;36mgradient_accumulation_steps[0m = [1;33m10[0m
[1;36meval_type[0m = [1;33mEvaluatorType.RANKING[0m
[1;36msingle_spec[0m = [1;33mTrue[0m
[1;36mlocal_rank[0m = [1;33m0[0m
[1;36mdevice[0m = [1;33mcuda[0m
[1;36mvalid_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m
[1;36mtest_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m


INFO:root:[1;35m[Training]: [0m[1;36mtrain_batch_size[0m = [1;33m[128][0m[1;36m train_neg_sample_args[0m: [1;33m[{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}][0m
INFO:root:[1;35m[Evaluation]: [0m[1;36meval_batch_size[0m = [1;33m[128][0m[1;36m eval_args[0m: [1;33m[{'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}][0m
item features
The batch_size of interaction: 504
    item_id, torch.Size([504]), cuda, torch.int64
    title, torch.Size([504, 40]), cuda, torch.int64
    brand, torch.Size([504, 7]), cuda, torch.int64


example
['‚ñÅcra' 'bt' 'ree' '‚ñÅamp' '‚ñÅevelyn' '‚ñÅgardener' '‚ñÅs' '‚ñÅultra' '‚ñÅmoistur'
 'ising' '‚ñÅhand' '‚ñÅtherapy' '‚ñÅpump' '‚ñÅ250' 'g' '‚ñÅ8' '‚ñÅ8' '‚ñÅoz' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]']
INFO:alembic.runtime.migration:Context impl SQLiteImpl.
INFO:alembic.runtime.migration:Will assume non-transactional DDL.
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 6477056 but failed
tried to log param model_non_emb_params with value -4778240 but failed
tried to log param unfreeze_n_layers with value 7 but failed
Evaluation sanity
****************************************
2024-07-10 10:48:43 pid 8220 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:43 pid 8220 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.60 seconds, [1;33mGPU RAM: 2.31 G/15.78 G[0m
2024-07-10 10:48:43 pid 8220 | finished [1;35mEvaluate in test   [0m. Total time: 0.60 seconds
OrderedDict([('recall@5', 0.0946), ('mrr@5', 0.0394), ('ndcg@5', 0.0534), ('hit@5', 0.0946), ('precision@5', 0.0189), ('test_loss', 6.169954776763916)])
****************************************
Freezing embeddings
Freezing layer 0
Freezing layer 1
Freezing layer 2
Freezing layer 3
Freezing layer 4
Freezing layer 5
Freezing layer 6
Freezing layer 7
Freezing layer 8
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 2902272 but failed
tried to log param model_non_emb_params with value -8353024 but failed
2024-07-10 10:48:44 pid 8220 | starting to iterate Train     0 (total=3), updating every 1 seconds
2024-07-10 10:48:45 pid 8220 | 0 of 3, 0.0% of Train     0, speed: -0.00 s/it, elapsed 0.60 seconds, [1;31mGPU RAM: 5.35 G/15.78 G loss: 5.36410[0m
2024-07-10 10:48:45 pid 8220 | finished Train     0. Total time: 0.60 seconds
INFO:root:[1;32mepoch 0 training[0m [[1;34mtime[0m: 1.94s, [1;34mtrain loss[0m: 5.0790]
2024-07-10 10:48:46 pid 8220 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:46 pid 8220 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.35 G/15.78 G[0m
2024-07-10 10:48:46 pid 8220 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.278159141540527)])
INFO:root:[1;32mepoch 0 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.278159141540527
2024-07-10 10:48:46 pid 8220 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1797), ('mrr@5', 0.0786), ('ndcg@5', 0.1038), ('hit@5', 0.1797), ('precision@5', 0.0359)])
2024-07-10 10:48:46 pid 8220 | starting to iterate Train     1 (total=3), updating every 1 seconds
2024-07-10 10:48:48 pid 8220 | 0 of 3, 0.0% of Train     1, speed: -0.00 s/it, elapsed 0.60 seconds, [1;31mGPU RAM: 5.35 G/15.78 G loss: 5.35334[0m
2024-07-10 10:48:48 pid 8220 | finished Train     1. Total time: 0.60 seconds
INFO:root:[1;32mepoch 1 training[0m [[1;34mtime[0m: 1.90s, [1;34mtrain loss[0m: 4.8852]
2024-07-10 10:48:48 pid 8220 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:48 pid 8220 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.35 G/15.78 G[0m
2024-07-10 10:48:48 pid 8220 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.2592973709106445)])
INFO:root:[1;32mepoch 1 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.2592973709106445
2024-07-10 10:48:48 pid 8220 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1797), ('mrr@5', 0.0786), ('ndcg@5', 0.1038), ('hit@5', 0.1797), ('precision@5', 0.0359)])
2024-07-10 10:48:48 pid 8220 | starting to iterate Train     2 (total=3), updating every 1 seconds
2024-07-10 10:48:50 pid 8220 | 0 of 3, 0.0% of Train     2, speed: -0.00 s/it, elapsed 0.61 seconds, [1;31mGPU RAM: 5.35 G/15.78 G loss: 5.11579[0m
2024-07-10 10:48:50 pid 8220 | finished Train     2. Total time: 0.61 seconds
INFO:root:[1;32mepoch 2 training[0m [[1;34mtime[0m: 1.90s, [1;34mtrain loss[0m: 4.9183]
2024-07-10 10:48:50 pid 8220 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:50 pid 8220 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.35 G/15.78 G[0m
2024-07-10 10:48:50 pid 8220 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.3366241455078125)])
INFO:root:[1;32mepoch 2 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.3366241455078125
2024-07-10 10:48:50 pid 8220 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1875), ('mrr@5', 0.0802), ('ndcg@5', 0.1068), ('hit@5', 0.1875), ('precision@5', 0.0375)])
2024-07-10 10:48:50 pid 8220 | starting to iterate Train     3 (total=3), updating every 1 seconds
2024-07-10 10:48:52 pid 8220 | 0 of 3, 0.0% of Train     3, speed: -0.00 s/it, elapsed 0.60 seconds, [1;31mGPU RAM: 5.35 G/15.78 G loss: 5.18656[0m
2024-07-10 10:48:52 pid 8220 | finished Train     3. Total time: 0.60 seconds
INFO:root:[1;32mepoch 3 training[0m [[1;34mtime[0m: 1.90s, [1;34mtrain loss[0m: 4.9517]
2024-07-10 10:48:52 pid 8220 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:52 pid 8220 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.35 G/15.78 G[0m
2024-07-10 10:48:52 pid 8220 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.316677093505859)])
INFO:root:[1;32mepoch 3 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.316677093505859
2024-07-10 10:48:52 pid 8220 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.1875), ('mrr@5', 0.0802), ('ndcg@5', 0.1068), ('hit@5', 0.1875), ('precision@5', 0.0375)])
2024-07-10 10:48:52 pid 8220 | starting to iterate Train     4 (total=3), updating every 1 seconds
2024-07-10 10:48:54 pid 8220 | 0 of 3, 0.0% of Train     4, speed: -0.00 s/it, elapsed 0.60 seconds, [1;31mGPU RAM: 5.35 G/15.78 G loss: 5.23686[0m
2024-07-10 10:48:54 pid 8220 | finished Train     4. Total time: 0.60 seconds
INFO:root:[1;32mepoch 4 training[0m [[1;34mtime[0m: 1.92s, [1;34mtrain loss[0m: 5.1299]
2024-07-10 10:48:54 pid 8220 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:54 pid 8220 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.35 G/15.78 G[0m
2024-07-10 10:48:54 pid 8220 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.303873062133789)])
INFO:root:[1;32mepoch 4 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.303873062133789
2024-07-10 10:48:54 pid 8220 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2031), ('mrr@5', 0.0837), ('ndcg@5', 0.1132), ('hit@5', 0.2031), ('precision@5', 0.0406)])
2024-07-10 10:48:55 pid 8220 | starting to iterate Train     5 (total=3), updating every 1 seconds
2024-07-10 10:48:56 pid 8220 | 0 of 3, 0.0% of Train     5, speed: -0.00 s/it, elapsed 0.59 seconds, [1;31mGPU RAM: 5.35 G/15.78 G loss: 5.25150[0m
2024-07-10 10:48:56 pid 8220 | finished Train     5. Total time: 0.59 seconds
INFO:root:[1;32mepoch 5 training[0m [[1;34mtime[0m: 1.89s, [1;34mtrain loss[0m: 5.2429]
2024-07-10 10:48:56 pid 8220 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:57 pid 8220 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.35 G/15.78 G[0m
2024-07-10 10:48:57 pid 8220 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.361544609069824)])
INFO:root:[1;32mepoch 5 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.361544609069824
2024-07-10 10:48:57 pid 8220 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2188), ('mrr@5', 0.0888), ('ndcg@5', 0.1208), ('hit@5', 0.2188), ('precision@5', 0.0438)])
2024-07-10 10:48:57 pid 8220 | starting to iterate Train     6 (total=3), updating every 1 seconds
2024-07-10 10:48:59 pid 8220 | 0 of 3, 0.0% of Train     6, speed: -0.00 s/it, elapsed 0.62 seconds, [1;31mGPU RAM: 5.35 G/15.78 G loss: 5.33384[0m
2024-07-10 10:48:59 pid 8220 | finished Train     6. Total time: 0.62 seconds
INFO:root:[1;32mepoch 6 training[0m [[1;34mtime[0m: 1.92s, [1;34mtrain loss[0m: 5.2640]
2024-07-10 10:48:59 pid 8220 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:48:59 pid 8220 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.35 G/15.78 G[0m
2024-07-10 10:48:59 pid 8220 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.378734111785889)])
INFO:root:[1;32mepoch 6 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.378734111785889
2024-07-10 10:48:59 pid 8220 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2188), ('mrr@5', 0.0875), ('ndcg@5', 0.1198), ('hit@5', 0.2188), ('precision@5', 0.0438)])
2024-07-10 10:48:59 pid 8220 | starting to iterate Train     7 (total=3), updating every 1 seconds
2024-07-10 10:49:01 pid 8220 | 0 of 3, 0.0% of Train     7, speed: -0.00 s/it, elapsed 0.60 seconds, [1;31mGPU RAM: 5.35 G/15.78 G loss: 5.34733[0m
2024-07-10 10:49:01 pid 8220 | finished Train     7. Total time: 0.60 seconds
INFO:root:[1;32mepoch 7 training[0m [[1;34mtime[0m: 1.92s, [1;34mtrain loss[0m: 5.3511]
2024-07-10 10:49:01 pid 8220 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:49:01 pid 8220 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.35 G/15.78 G[0m
2024-07-10 10:49:01 pid 8220 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.2809553146362305)])
INFO:root:[1;32mepoch 7 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.2809553146362305
2024-07-10 10:49:01 pid 8220 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2188), ('mrr@5', 0.0885), ('ndcg@5', 0.1206), ('hit@5', 0.2188), ('precision@5', 0.0438)])
2024-07-10 10:49:01 pid 8220 | starting to iterate Train     8 (total=3), updating every 1 seconds
2024-07-10 10:49:03 pid 8220 | 0 of 3, 0.0% of Train     8, speed: -0.00 s/it, elapsed 0.62 seconds, [1;31mGPU RAM: 5.35 G/15.78 G loss: 5.31531[0m
2024-07-10 10:49:03 pid 8220 | finished Train     8. Total time: 0.62 seconds
INFO:root:[1;32mepoch 8 training[0m [[1;34mtime[0m: 1.92s, [1;34mtrain loss[0m: 5.3381]
2024-07-10 10:49:03 pid 8220 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:49:03 pid 8220 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.35 G/15.78 G[0m
2024-07-10 10:49:03 pid 8220 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.415158271789551)])
INFO:root:[1;32mepoch 8 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.415158271789551
2024-07-10 10:49:03 pid 8220 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2188), ('mrr@5', 0.0911), ('ndcg@5', 0.1227), ('hit@5', 0.2188), ('precision@5', 0.0438)])
2024-07-10 10:49:03 pid 8220 | starting to iterate Train     9 (total=3), updating every 1 seconds
2024-07-10 10:49:05 pid 8220 | 0 of 3, 0.0% of Train     9, speed: -0.00 s/it, elapsed 0.63 seconds, [1;31mGPU RAM: 5.35 G/15.78 G loss: 5.21178[0m
2024-07-10 10:49:05 pid 8220 | finished Train     9. Total time: 0.63 seconds
INFO:root:[1;32mepoch 9 training[0m [[1;34mtime[0m: 1.93s, [1;34mtrain loss[0m: 5.5141]
2024-07-10 10:49:05 pid 8220 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:49:05 pid 8220 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.35 G/15.78 G[0m
2024-07-10 10:49:05 pid 8220 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.322770118713379)])
INFO:root:[1;32mepoch 9 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.322770118713379
2024-07-10 10:49:05 pid 8220 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2266), ('mrr@5', 0.0914), ('ndcg@5', 0.1247), ('hit@5', 0.2266), ('precision@5', 0.0453)])
Saving checkpoint on /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/07.pth
INFO:root:[1;34mSaving current[0m: /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/07.pth
2024-07-10 10:49:06 pid 8220 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:49:06 pid 8220 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.35 G/15.78 G[0m
2024-07-10 10:49:06 pid 8220 | finished [1;35mEvaluate in test   [0m. Total time: 0.05 seconds
OrderedDict([('recall@5', 0.0946), ('mrr@5', 0.0394), ('ndcg@5', 0.0534), ('hit@5', 0.0946), ('precision@5', 0.0189), ('test_loss', 6.113431930541992)])
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
INFO:faiss.loader:Loading faiss.
INFO:faiss.loader:Successfully loaded faiss.
WARNING:root:command line args [-c confs/fine_tune/progressive.json -s amazon-beauty -l amazon-100K -i test.pth -p confs/pre_train/config_dict_100K.json -o fine_tuned_checkpoint.pth] will not be used in RecBole

[1;35mGeneral Hyper Parameters:
[0m[1;36mgpu_id[0m =[1;33m 0[0m
[1;36muse_gpu[0m =[1;33m True[0m
[1;36mseed[0m =[1;33m 2020[0m
[1;36mstate[0m =[1;33m INFO[0m
[1;36mreproducibility[0m =[1;33m True[0m
[1;36mdata_path[0m =[1;33m /alloc/data/srt/data/output/amazon-beauty[0m
[1;36mcheckpoint_dir[0m =[1;33m saved[0m
[1;36mshow_progress[0m =[1;33m True[0m
[1;36msave_dataset[0m =[1;33m False[0m
[1;36mdataset_save_path[0m =[1;33m None[0m
[1;36msave_dataloaders[0m =[1;33m False[0m
[1;36mdataloaders_save_path[0m =[1;33m None[0m
[1;36mlog_wandb[0m =[1;33m False[0m

[1;35mTraining Hyper Parameters:
[0m[1;36mepochs[0m =[1;33m 2[0m
[1;36mtrain_batch_size[0m =[1;33m 128[0m
[1;36mlearner[0m =[1;33m adam[0m
[1;36mlearning_rate[0m =[1;33m 0.0001[0m
[1;36mtrain_neg_sample_args[0m =[1;33m {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}[0m
[1;36meval_step[0m =[1;33m 1[0m
[1;36mstopping_step[0m =[1;33m 20[0m
[1;36mclip_grad_norm[0m =[1;33m None[0m
[1;36mweight_decay[0m =[1;33m 1e-05[0m
[1;36mloss_decimal_place[0m =[1;33m 4[0m

[1;35mEvaluation Hyper Parameters:
[0m[1;36meval_args[0m =[1;33m {'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}[0m
[1;36mrepeatable[0m =[1;33m True[0m
[1;36mmetrics[0m =[1;33m ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision'][0m
[1;36mtopk[0m =[1;33m [5][0m
[1;36mvalid_metric[0m =[1;33m mrr@5[0m
[1;36mvalid_metric_bigger[0m =[1;33m True[0m
[1;36meval_batch_size[0m =[1;33m 128[0m
[1;36mmetric_decimal_place[0m =[1;33m 4[0m

[1;35mDataset Hyper Parameters:
[0m[1;36mfield_separator[0m =[1;33m 	[0m
[1;36mseq_separator[0m =[1;33m  [0m
[1;36mUSER_ID_FIELD[0m =[1;33m user_id[0m
[1;36mITEM_ID_FIELD[0m =[1;33m item_id[0m
[1;36mRATING_FIELD[0m =[1;33m rating[0m
[1;36mTIME_FIELD[0m =[1;33m timestamp[0m
[1;36mseq_len[0m =[1;33m None[0m
[1;36mLABEL_FIELD[0m =[1;33m label[0m
[1;36mthreshold[0m =[1;33m None[0m
[1;36mNEG_PREFIX[0m =[1;33m neg_[0m
[1;36mload_col[0m =[1;33m {'inter': ['user_id', 'item_id', 'rating', 'timestamp'], 'item': ['item_id', 'title', 'brand']}[0m
[1;36munload_col[0m =[1;33m None[0m
[1;36munused_col[0m =[1;33m None[0m
[1;36madditional_feat_suffix[0m =[1;33m None[0m
[1;36mrm_dup_inter[0m =[1;33m None[0m
[1;36mval_interval[0m =[1;33m None[0m
[1;36mfilter_inter_by_user_or_item[0m =[1;33m True[0m
[1;36muser_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36mitem_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36malias_of_user_id[0m =[1;33m None[0m
[1;36malias_of_item_id[0m =[1;33m None[0m
[1;36malias_of_entity_id[0m =[1;33m None[0m
[1;36malias_of_relation_id[0m =[1;33m None[0m
[1;36mpreload_weight[0m =[1;33m None[0m
[1;36mnormalize_field[0m =[1;33m None[0m
[1;36mnormalize_all[0m =[1;33m None[0m
[1;36mITEM_LIST_LENGTH_FIELD[0m =[1;33m item_length[0m
[1;36mLIST_SUFFIX[0m =[1;33m _list[0m
[1;36mMAX_ITEM_LIST_LENGTH[0m =[1;33m 50[0m
[1;36mPOSITION_FIELD[0m =[1;33m position_id[0m
[1;36mHEAD_ENTITY_ID_FIELD[0m =[1;33m head_id[0m
[1;36mTAIL_ENTITY_ID_FIELD[0m =[1;33m tail_id[0m
[1;36mRELATION_ID_FIELD[0m =[1;33m relation_id[0m
[1;36mENTITY_ID_FIELD[0m =[1;33m entity_id[0m
[1;36mbenchmark_filename[0m =[1;33m None[0m

[1;35mOther Hyper Parameters: 
[0m[1;36mworker[0m = [1;33m0[0m
[1;36mwandb_project[0m = [1;33mrecbole[0m
[1;36mshuffle[0m = [1;33mTrue[0m
[1;36mrequire_pow[0m = [1;33mFalse[0m
[1;36menable_amp[0m = [1;33mFalse[0m
[1;36menable_scaler[0m = [1;33mFalse[0m
[1;36mtransform[0m = [1;33mNone[0m
[1;36mn_layers[0m = [1;33m16[0m
[1;36mn_heads[0m = [1;33m4[0m
[1;36mhidden_size[0m = [1;33m256[0m
[1;36minner_size[0m = [1;33m256[0m
[1;36mhidden_dropout_prob[0m = [1;33m0.5[0m
[1;36mattn_dropout_prob[0m = [1;33m0.5[0m
[1;36mhidden_act[0m = [1;33mgelu[0m
[1;36mlayer_norm_eps[0m = [1;33m1e-12[0m
[1;36minitializer_range[0m = [1;33m0.02[0m
[1;36mselected_features[0m = [1;33m['title', 'brand'][0m
[1;36mpooling_mode[0m = [1;33msum[0m
[1;36mloss_type[0m = [1;33mInfoNCE-quick[0m
[1;36mnumerical_features[0m = [1;33m[][0m
[1;36mdiscretization[0m = [1;33mNone[0m
[1;36mkg_reverse_r[0m = [1;33mFalse[0m
[1;36mentity_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mrelation_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mMODEL_TYPE[0m = [1;33mModelType.SEQUENTIAL[0m
[1;36mmlflow[0m = [1;33m{'enable': True, 'experiment_name': 'fine-tune', 'run_name': '0f5d1302-97f4-4127-9cee-a6a702a5625b', 'tracking_uri': 'sqlite:///mlruns.sqlite', 'auto_continue': True}[0m
[1;36mmax_grad_norm[0m = [1;33m1.0[0m
[1;36mscheduler[0m = [1;33m{'type': 'one-cycle'}[0m
[1;36mnce_temperature[0m = [1;33m1[0m
[1;36mnce_label_smoothing[0m = [1;33m0.0[0m
[1;36mnormalize_embedding[0m = [1;33mFalse[0m
[1;36mevaluation_mode[0m = [1;33msampled50000[0m
[1;36mestimate_batch_size[0m = [1;33mFalse[0m
[1;36mnce_num_negatives[0m = [1;33m300[0m
[1;36mnce_sampling_strategy[0m = [1;33mpopularity[0m
[1;36mnce_global_negatives[0m = [1;33mFalse[0m
[1;36mgradient_accumulation_steps[0m = [1;33m10[0m
[1;36meval_type[0m = [1;33mEvaluatorType.RANKING[0m
[1;36msingle_spec[0m = [1;33mTrue[0m
[1;36mlocal_rank[0m = [1;33m0[0m
[1;36mdevice[0m = [1;33mcuda[0m
[1;36mvalid_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m
[1;36mtest_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m


INFO:root:[1;35m[Training]: [0m[1;36mtrain_batch_size[0m = [1;33m[128][0m[1;36m train_neg_sample_args[0m: [1;33m[{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}][0m
INFO:root:[1;35m[Evaluation]: [0m[1;36meval_batch_size[0m = [1;33m[128][0m[1;36m eval_args[0m: [1;33m[{'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}][0m
item features
The batch_size of interaction: 504
    item_id, torch.Size([504]), cuda, torch.int64
    title, torch.Size([504, 40]), cuda, torch.int64
    brand, torch.Size([504, 7]), cuda, torch.int64


example
['‚ñÅcra' 'bt' 'ree' '‚ñÅamp' '‚ñÅevelyn' '‚ñÅgardener' '‚ñÅs' '‚ñÅultra' '‚ñÅmoistur'
 'ising' '‚ñÅhand' '‚ñÅtherapy' '‚ñÅpump' '‚ñÅ250' 'g' '‚ñÅ8' '‚ñÅ8' '‚ñÅoz' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]']
INFO:alembic.runtime.migration:Context impl SQLiteImpl.
INFO:alembic.runtime.migration:Will assume non-transactional DDL.
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 6477056 but failed
tried to log param model_non_emb_params with value -4778240 but failed
tried to log param unfreeze_n_layers with value 8 but failed
Evaluation sanity
****************************************
2024-07-10 10:49:09 pid 8233 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:49:10 pid 8233 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.62 seconds, [1;33mGPU RAM: 2.32 G/15.78 G[0m
2024-07-10 10:49:10 pid 8233 | finished [1;35mEvaluate in test   [0m. Total time: 0.62 seconds
OrderedDict([('recall@5', 0.0946), ('mrr@5', 0.0394), ('ndcg@5', 0.0534), ('hit@5', 0.0946), ('precision@5', 0.0189), ('test_loss', 6.162725925445557)])
****************************************
Freezing embeddings
Freezing layer 0
Freezing layer 1
Freezing layer 2
Freezing layer 3
Freezing layer 4
Freezing layer 5
Freezing layer 6
Freezing layer 7
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 3298048 but failed
tried to log param model_non_emb_params with value -7957248 but failed
2024-07-10 10:49:10 pid 8233 | starting to iterate Train     0 (total=3), updating every 1 seconds
2024-07-10 10:49:12 pid 8233 | 0 of 3, 0.0% of Train     0, speed: -0.00 s/it, elapsed 0.63 seconds, [1;31mGPU RAM: 5.34 G/15.78 G loss: 5.21507[0m
2024-07-10 10:49:12 pid 8233 | finished Train     0. Total time: 0.63 seconds
INFO:root:[1;32mepoch 0 training[0m [[1;34mtime[0m: 2.03s, [1;34mtrain loss[0m: 4.8543]
2024-07-10 10:49:12 pid 8233 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:49:13 pid 8233 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.34 G/15.78 G[0m
2024-07-10 10:49:13 pid 8233 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.286726951599121)])
INFO:root:[1;32mepoch 0 evaluating[0m [[1;34mtime[0m: 0.15s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.286726951599121
2024-07-10 10:49:13 pid 8233 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2266), ('mrr@5', 0.0914), ('ndcg@5', 0.1247), ('hit@5', 0.2266), ('precision@5', 0.0453)])
2024-07-10 10:49:13 pid 8233 | starting to iterate Train     1 (total=3), updating every 1 seconds
2024-07-10 10:49:15 pid 8233 | 0 of 3, 0.0% of Train     1, speed: -0.00 s/it, elapsed 0.63 seconds, [1;31mGPU RAM: 5.34 G/15.78 G loss: 5.18677[0m
2024-07-10 10:49:15 pid 8233 | finished Train     1. Total time: 0.63 seconds
INFO:root:[1;32mepoch 1 training[0m [[1;34mtime[0m: 2.00s, [1;34mtrain loss[0m: 4.6224]
2024-07-10 10:49:15 pid 8233 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:49:15 pid 8233 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.34 G/15.78 G[0m
2024-07-10 10:49:15 pid 8233 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.267533302307129)])
INFO:root:[1;32mepoch 1 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.267533302307129
2024-07-10 10:49:15 pid 8233 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2266), ('mrr@5', 0.0924), ('ndcg@5', 0.1256), ('hit@5', 0.2266), ('precision@5', 0.0453)])
2024-07-10 10:49:15 pid 8233 | starting to iterate Train     2 (total=3), updating every 1 seconds
2024-07-10 10:49:17 pid 8233 | 0 of 3, 0.0% of Train     2, speed: -0.00 s/it, elapsed 0.63 seconds, [1;31mGPU RAM: 5.34 G/15.78 G loss: 4.92503[0m
2024-07-10 10:49:17 pid 8233 | finished Train     2. Total time: 0.63 seconds
INFO:root:[1;32mepoch 2 training[0m [[1;34mtime[0m: 2.00s, [1;34mtrain loss[0m: 4.6398]
2024-07-10 10:49:17 pid 8233 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:49:17 pid 8233 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.34 G/15.78 G[0m
2024-07-10 10:49:17 pid 8233 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.344244956970215)])
INFO:root:[1;32mepoch 2 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.344244956970215
2024-07-10 10:49:17 pid 8233 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2266), ('mrr@5', 0.0924), ('ndcg@5', 0.1256), ('hit@5', 0.2266), ('precision@5', 0.0453)])
2024-07-10 10:49:17 pid 8233 | starting to iterate Train     3 (total=3), updating every 1 seconds
2024-07-10 10:49:19 pid 8233 | 0 of 3, 0.0% of Train     3, speed: -0.00 s/it, elapsed 0.63 seconds, [1;31mGPU RAM: 5.34 G/15.78 G loss: 4.98899[0m
2024-07-10 10:49:19 pid 8233 | finished Train     3. Total time: 0.63 seconds
INFO:root:[1;32mepoch 3 training[0m [[1;34mtime[0m: 2.00s, [1;34mtrain loss[0m: 4.7175]
2024-07-10 10:49:19 pid 8233 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:49:19 pid 8233 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.34 G/15.78 G[0m
2024-07-10 10:49:19 pid 8233 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.323099136352539)])
INFO:root:[1;32mepoch 3 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.323099136352539
2024-07-10 10:49:19 pid 8233 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.25), ('mrr@5', 0.0987), ('ndcg@5', 0.136), ('hit@5', 0.25), ('precision@5', 0.05)])
2024-07-10 10:49:20 pid 8233 | starting to iterate Train     4 (total=3), updating every 1 seconds
2024-07-10 10:49:22 pid 8233 | 0 of 3, 0.0% of Train     4, speed: -0.00 s/it, elapsed 0.62 seconds, [1;31mGPU RAM: 5.34 G/15.78 G loss: 5.04625[0m
2024-07-10 10:49:22 pid 8233 | finished Train     4. Total time: 0.62 seconds
INFO:root:[1;32mepoch 4 training[0m [[1;34mtime[0m: 2.01s, [1;34mtrain loss[0m: 4.9200]
2024-07-10 10:49:22 pid 8233 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:49:22 pid 8233 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.34 G/15.78 G[0m
2024-07-10 10:49:22 pid 8233 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.312039375305176)])
INFO:root:[1;32mepoch 4 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.312039375305176
2024-07-10 10:49:22 pid 8233 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.25), ('mrr@5', 0.1004), ('ndcg@5', 0.1374), ('hit@5', 0.25), ('precision@5', 0.05)])
2024-07-10 10:49:22 pid 8233 | starting to iterate Train     5 (total=3), updating every 1 seconds
2024-07-10 10:49:24 pid 8233 | 0 of 3, 0.0% of Train     5, speed: -0.00 s/it, elapsed 0.62 seconds, [1;31mGPU RAM: 5.34 G/15.78 G loss: 5.09538[0m
2024-07-10 10:49:24 pid 8233 | finished Train     5. Total time: 0.62 seconds
INFO:root:[1;32mepoch 5 training[0m [[1;34mtime[0m: 2.01s, [1;34mtrain loss[0m: 5.0554]
2024-07-10 10:49:24 pid 8233 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:49:24 pid 8233 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.34 G/15.78 G[0m
2024-07-10 10:49:24 pid 8233 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.376124382019043)])
INFO:root:[1;32mepoch 5 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.376124382019043
2024-07-10 10:49:24 pid 8233 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2578), ('mrr@5', 0.1022), ('ndcg@5', 0.1406), ('hit@5', 0.2578), ('precision@5', 0.0516)])
2024-07-10 10:49:24 pid 8233 | starting to iterate Train     6 (total=3), updating every 1 seconds
2024-07-10 10:49:26 pid 8233 | 0 of 3, 0.0% of Train     6, speed: -0.00 s/it, elapsed 0.63 seconds, [1;31mGPU RAM: 5.34 G/15.78 G loss: 5.19515[0m
2024-07-10 10:49:26 pid 8233 | finished Train     6. Total time: 0.63 seconds
INFO:root:[1;32mepoch 6 training[0m [[1;34mtime[0m: 2.03s, [1;34mtrain loss[0m: 5.0995]
2024-07-10 10:49:26 pid 8233 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:49:26 pid 8233 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.34 G/15.78 G[0m
2024-07-10 10:49:26 pid 8233 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.405272483825684)])
INFO:root:[1;32mepoch 6 evaluating[0m [[1;34mtime[0m: 0.16s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.405272483825684
2024-07-10 10:49:26 pid 8233 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2422), ('mrr@5', 0.1049), ('ndcg@5', 0.1391), ('hit@5', 0.2422), ('precision@5', 0.0484)])
2024-07-10 10:49:27 pid 8233 | starting to iterate Train     7 (total=3), updating every 1 seconds
2024-07-10 10:49:29 pid 8233 | 0 of 3, 0.0% of Train     7, speed: -0.00 s/it, elapsed 0.63 seconds, [1;31mGPU RAM: 5.34 G/15.78 G loss: 5.22030[0m
2024-07-10 10:49:29 pid 8233 | finished Train     7. Total time: 0.63 seconds
INFO:root:[1;32mepoch 7 training[0m [[1;34mtime[0m: 2.00s, [1;34mtrain loss[0m: 5.2135]
2024-07-10 10:49:29 pid 8233 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:49:29 pid 8233 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.34 G/15.78 G[0m
2024-07-10 10:49:29 pid 8233 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.297064304351807)])
INFO:root:[1;32mepoch 7 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.297064304351807
2024-07-10 10:49:29 pid 8233 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2422), ('mrr@5', 0.1082), ('ndcg@5', 0.1416), ('hit@5', 0.2422), ('precision@5', 0.0484)])
2024-07-10 10:49:29 pid 8233 | starting to iterate Train     8 (total=3), updating every 1 seconds
2024-07-10 10:49:31 pid 8233 | 0 of 3, 0.0% of Train     8, speed: -0.00 s/it, elapsed 0.62 seconds, [1;31mGPU RAM: 5.34 G/15.78 G loss: 5.19249[0m
2024-07-10 10:49:31 pid 8233 | finished Train     8. Total time: 0.62 seconds
INFO:root:[1;32mepoch 8 training[0m [[1;34mtime[0m: 2.00s, [1;34mtrain loss[0m: 5.2192]
2024-07-10 10:49:31 pid 8233 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:49:31 pid 8233 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.34 G/15.78 G[0m
2024-07-10 10:49:31 pid 8233 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.425520896911621)])
INFO:root:[1;32mepoch 8 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.425520896911621
2024-07-10 10:49:31 pid 8233 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2422), ('mrr@5', 0.1102), ('ndcg@5', 0.1432), ('hit@5', 0.2422), ('precision@5', 0.0484)])
2024-07-10 10:49:31 pid 8233 | starting to iterate Train     9 (total=3), updating every 1 seconds
2024-07-10 10:49:33 pid 8233 | 0 of 3, 0.0% of Train     9, speed: -0.00 s/it, elapsed 0.63 seconds, [1;31mGPU RAM: 5.34 G/15.78 G loss: 5.09908[0m
2024-07-10 10:49:33 pid 8233 | finished Train     9. Total time: 0.63 seconds
INFO:root:[1;32mepoch 9 training[0m [[1;34mtime[0m: 2.00s, [1;34mtrain loss[0m: 5.4082]
2024-07-10 10:49:33 pid 8233 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:49:33 pid 8233 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.34 G/15.78 G[0m
2024-07-10 10:49:33 pid 8233 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.335840702056885)])
INFO:root:[1;32mepoch 9 evaluating[0m [[1;34mtime[0m: 0.15s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.335840702056885
2024-07-10 10:49:33 pid 8233 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2422), ('mrr@5', 0.1102), ('ndcg@5', 0.1432), ('hit@5', 0.2422), ('precision@5', 0.0484)])
Saving checkpoint on /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/08.pth
INFO:root:[1;34mSaving current[0m: /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/08.pth
2024-07-10 10:49:34 pid 8233 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:49:34 pid 8233 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.34 G/15.78 G[0m
2024-07-10 10:49:34 pid 8233 | finished [1;35mEvaluate in test   [0m. Total time: 0.05 seconds
OrderedDict([('recall@5', 0.1216), ('mrr@5', 0.0455), ('ndcg@5', 0.0645), ('hit@5', 0.1216), ('precision@5', 0.0243), ('test_loss', 6.107606410980225)])
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
INFO:faiss.loader:Loading faiss.
INFO:faiss.loader:Successfully loaded faiss.
WARNING:root:command line args [-c confs/fine_tune/progressive.json -s amazon-beauty -l amazon-100K -i test.pth -p confs/pre_train/config_dict_100K.json -o fine_tuned_checkpoint.pth] will not be used in RecBole

[1;35mGeneral Hyper Parameters:
[0m[1;36mgpu_id[0m =[1;33m 0[0m
[1;36muse_gpu[0m =[1;33m True[0m
[1;36mseed[0m =[1;33m 2020[0m
[1;36mstate[0m =[1;33m INFO[0m
[1;36mreproducibility[0m =[1;33m True[0m
[1;36mdata_path[0m =[1;33m /alloc/data/srt/data/output/amazon-beauty[0m
[1;36mcheckpoint_dir[0m =[1;33m saved[0m
[1;36mshow_progress[0m =[1;33m True[0m
[1;36msave_dataset[0m =[1;33m False[0m
[1;36mdataset_save_path[0m =[1;33m None[0m
[1;36msave_dataloaders[0m =[1;33m False[0m
[1;36mdataloaders_save_path[0m =[1;33m None[0m
[1;36mlog_wandb[0m =[1;33m False[0m

[1;35mTraining Hyper Parameters:
[0m[1;36mepochs[0m =[1;33m 2[0m
[1;36mtrain_batch_size[0m =[1;33m 128[0m
[1;36mlearner[0m =[1;33m adam[0m
[1;36mlearning_rate[0m =[1;33m 0.0001[0m
[1;36mtrain_neg_sample_args[0m =[1;33m {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}[0m
[1;36meval_step[0m =[1;33m 1[0m
[1;36mstopping_step[0m =[1;33m 20[0m
[1;36mclip_grad_norm[0m =[1;33m None[0m
[1;36mweight_decay[0m =[1;33m 1e-05[0m
[1;36mloss_decimal_place[0m =[1;33m 4[0m

[1;35mEvaluation Hyper Parameters:
[0m[1;36meval_args[0m =[1;33m {'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}[0m
[1;36mrepeatable[0m =[1;33m True[0m
[1;36mmetrics[0m =[1;33m ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision'][0m
[1;36mtopk[0m =[1;33m [5][0m
[1;36mvalid_metric[0m =[1;33m mrr@5[0m
[1;36mvalid_metric_bigger[0m =[1;33m True[0m
[1;36meval_batch_size[0m =[1;33m 128[0m
[1;36mmetric_decimal_place[0m =[1;33m 4[0m

[1;35mDataset Hyper Parameters:
[0m[1;36mfield_separator[0m =[1;33m 	[0m
[1;36mseq_separator[0m =[1;33m  [0m
[1;36mUSER_ID_FIELD[0m =[1;33m user_id[0m
[1;36mITEM_ID_FIELD[0m =[1;33m item_id[0m
[1;36mRATING_FIELD[0m =[1;33m rating[0m
[1;36mTIME_FIELD[0m =[1;33m timestamp[0m
[1;36mseq_len[0m =[1;33m None[0m
[1;36mLABEL_FIELD[0m =[1;33m label[0m
[1;36mthreshold[0m =[1;33m None[0m
[1;36mNEG_PREFIX[0m =[1;33m neg_[0m
[1;36mload_col[0m =[1;33m {'inter': ['user_id', 'item_id', 'rating', 'timestamp'], 'item': ['item_id', 'title', 'brand']}[0m
[1;36munload_col[0m =[1;33m None[0m
[1;36munused_col[0m =[1;33m None[0m
[1;36madditional_feat_suffix[0m =[1;33m None[0m
[1;36mrm_dup_inter[0m =[1;33m None[0m
[1;36mval_interval[0m =[1;33m None[0m
[1;36mfilter_inter_by_user_or_item[0m =[1;33m True[0m
[1;36muser_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36mitem_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36malias_of_user_id[0m =[1;33m None[0m
[1;36malias_of_item_id[0m =[1;33m None[0m
[1;36malias_of_entity_id[0m =[1;33m None[0m
[1;36malias_of_relation_id[0m =[1;33m None[0m
[1;36mpreload_weight[0m =[1;33m None[0m
[1;36mnormalize_field[0m =[1;33m None[0m
[1;36mnormalize_all[0m =[1;33m None[0m
[1;36mITEM_LIST_LENGTH_FIELD[0m =[1;33m item_length[0m
[1;36mLIST_SUFFIX[0m =[1;33m _list[0m
[1;36mMAX_ITEM_LIST_LENGTH[0m =[1;33m 50[0m
[1;36mPOSITION_FIELD[0m =[1;33m position_id[0m
[1;36mHEAD_ENTITY_ID_FIELD[0m =[1;33m head_id[0m
[1;36mTAIL_ENTITY_ID_FIELD[0m =[1;33m tail_id[0m
[1;36mRELATION_ID_FIELD[0m =[1;33m relation_id[0m
[1;36mENTITY_ID_FIELD[0m =[1;33m entity_id[0m
[1;36mbenchmark_filename[0m =[1;33m None[0m

[1;35mOther Hyper Parameters: 
[0m[1;36mworker[0m = [1;33m0[0m
[1;36mwandb_project[0m = [1;33mrecbole[0m
[1;36mshuffle[0m = [1;33mTrue[0m
[1;36mrequire_pow[0m = [1;33mFalse[0m
[1;36menable_amp[0m = [1;33mFalse[0m
[1;36menable_scaler[0m = [1;33mFalse[0m
[1;36mtransform[0m = [1;33mNone[0m
[1;36mn_layers[0m = [1;33m16[0m
[1;36mn_heads[0m = [1;33m4[0m
[1;36mhidden_size[0m = [1;33m256[0m
[1;36minner_size[0m = [1;33m256[0m
[1;36mhidden_dropout_prob[0m = [1;33m0.5[0m
[1;36mattn_dropout_prob[0m = [1;33m0.5[0m
[1;36mhidden_act[0m = [1;33mgelu[0m
[1;36mlayer_norm_eps[0m = [1;33m1e-12[0m
[1;36minitializer_range[0m = [1;33m0.02[0m
[1;36mselected_features[0m = [1;33m['title', 'brand'][0m
[1;36mpooling_mode[0m = [1;33msum[0m
[1;36mloss_type[0m = [1;33mInfoNCE-quick[0m
[1;36mnumerical_features[0m = [1;33m[][0m
[1;36mdiscretization[0m = [1;33mNone[0m
[1;36mkg_reverse_r[0m = [1;33mFalse[0m
[1;36mentity_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mrelation_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mMODEL_TYPE[0m = [1;33mModelType.SEQUENTIAL[0m
[1;36mmlflow[0m = [1;33m{'enable': True, 'experiment_name': 'fine-tune', 'run_name': '0f5d1302-97f4-4127-9cee-a6a702a5625b', 'tracking_uri': 'sqlite:///mlruns.sqlite', 'auto_continue': True}[0m
[1;36mmax_grad_norm[0m = [1;33m1.0[0m
[1;36mscheduler[0m = [1;33m{'type': 'one-cycle'}[0m
[1;36mnce_temperature[0m = [1;33m1[0m
[1;36mnce_label_smoothing[0m = [1;33m0.0[0m
[1;36mnormalize_embedding[0m = [1;33mFalse[0m
[1;36mevaluation_mode[0m = [1;33msampled50000[0m
[1;36mestimate_batch_size[0m = [1;33mFalse[0m
[1;36mnce_num_negatives[0m = [1;33m300[0m
[1;36mnce_sampling_strategy[0m = [1;33mpopularity[0m
[1;36mnce_global_negatives[0m = [1;33mFalse[0m
[1;36mgradient_accumulation_steps[0m = [1;33m10[0m
[1;36meval_type[0m = [1;33mEvaluatorType.RANKING[0m
[1;36msingle_spec[0m = [1;33mTrue[0m
[1;36mlocal_rank[0m = [1;33m0[0m
[1;36mdevice[0m = [1;33mcuda[0m
[1;36mvalid_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m
[1;36mtest_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m


INFO:root:[1;35m[Training]: [0m[1;36mtrain_batch_size[0m = [1;33m[128][0m[1;36m train_neg_sample_args[0m: [1;33m[{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}][0m
INFO:root:[1;35m[Evaluation]: [0m[1;36meval_batch_size[0m = [1;33m[128][0m[1;36m eval_args[0m: [1;33m[{'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}][0m
item features
The batch_size of interaction: 504
    item_id, torch.Size([504]), cuda, torch.int64
    title, torch.Size([504, 40]), cuda, torch.int64
    brand, torch.Size([504, 7]), cuda, torch.int64


example
['‚ñÅcra' 'bt' 'ree' '‚ñÅamp' '‚ñÅevelyn' '‚ñÅgardener' '‚ñÅs' '‚ñÅultra' '‚ñÅmoistur'
 'ising' '‚ñÅhand' '‚ñÅtherapy' '‚ñÅpump' '‚ñÅ250' 'g' '‚ñÅ8' '‚ñÅ8' '‚ñÅoz' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]']
INFO:alembic.runtime.migration:Context impl SQLiteImpl.
INFO:alembic.runtime.migration:Will assume non-transactional DDL.
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 6477056 but failed
tried to log param model_non_emb_params with value -4778240 but failed
tried to log param unfreeze_n_layers with value 9 but failed
Evaluation sanity
****************************************
2024-07-10 10:49:37 pid 8245 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:49:38 pid 8245 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.60 seconds, [1;33mGPU RAM: 2.32 G/15.78 G[0m
2024-07-10 10:49:38 pid 8245 | finished [1;35mEvaluate in test   [0m. Total time: 0.60 seconds
OrderedDict([('recall@5', 0.1216), ('mrr@5', 0.0455), ('ndcg@5', 0.0645), ('hit@5', 0.1216), ('precision@5', 0.0243), ('test_loss', 6.159050464630127)])
****************************************
Freezing embeddings
Freezing layer 0
Freezing layer 1
Freezing layer 2
Freezing layer 3
Freezing layer 4
Freezing layer 5
Freezing layer 6
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 3693824 but failed
tried to log param model_non_emb_params with value -7561472 but failed
2024-07-10 10:49:38 pid 8245 | starting to iterate Train     0 (total=3), updating every 1 seconds
2024-07-10 10:49:40 pid 8245 | 0 of 3, 0.0% of Train     0, speed: -0.00 s/it, elapsed 0.65 seconds, [1;31mGPU RAM: 5.38 G/15.78 G loss: 5.05496[0m
2024-07-10 10:49:40 pid 8245 | finished Train     0. Total time: 0.65 seconds
INFO:root:[1;32mepoch 0 training[0m [[1;34mtime[0m: 2.09s, [1;34mtrain loss[0m: 4.6168]
2024-07-10 10:49:40 pid 8245 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:49:40 pid 8245 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.38 G/15.78 G[0m
2024-07-10 10:49:40 pid 8245 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.301908016204834)])
INFO:root:[1;32mepoch 0 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.301908016204834
2024-07-10 10:49:41 pid 8245 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2422), ('mrr@5', 0.1102), ('ndcg@5', 0.1432), ('hit@5', 0.2422), ('precision@5', 0.0484)])
2024-07-10 10:49:41 pid 8245 | starting to iterate Train     1 (total=3), updating every 1 seconds
2024-07-10 10:49:43 pid 8245 | 0 of 3, 0.0% of Train     1, speed: -0.00 s/it, elapsed 0.65 seconds, [1;31mGPU RAM: 5.38 G/15.78 G loss: 5.00936[0m
2024-07-10 10:49:43 pid 8245 | finished Train     1. Total time: 0.65 seconds
INFO:root:[1;32mepoch 1 training[0m [[1;34mtime[0m: 2.07s, [1;34mtrain loss[0m: 4.3533]
2024-07-10 10:49:43 pid 8245 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:49:43 pid 8245 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.38 G/15.78 G[0m
2024-07-10 10:49:43 pid 8245 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.281015396118164)])
INFO:root:[1;32mepoch 1 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.281015396118164
2024-07-10 10:49:43 pid 8245 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2422), ('mrr@5', 0.1108), ('ndcg@5', 0.1438), ('hit@5', 0.2422), ('precision@5', 0.0484)])
2024-07-10 10:49:43 pid 8245 | starting to iterate Train     2 (total=3), updating every 1 seconds
2024-07-10 10:49:45 pid 8245 | 0 of 3, 0.0% of Train     2, speed: -0.00 s/it, elapsed 0.66 seconds, [1;31mGPU RAM: 5.38 G/15.78 G loss: 4.72145[0m
2024-07-10 10:49:45 pid 8245 | finished Train     2. Total time: 0.66 seconds
INFO:root:[1;32mepoch 2 training[0m [[1;34mtime[0m: 2.11s, [1;34mtrain loss[0m: 4.3495]
2024-07-10 10:49:45 pid 8245 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:49:45 pid 8245 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.38 G/15.78 G[0m
2024-07-10 10:49:45 pid 8245 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.355098247528076)])
INFO:root:[1;32mepoch 2 evaluating[0m [[1;34mtime[0m: 0.15s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.355098247528076
2024-07-10 10:49:45 pid 8245 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.25), ('mrr@5', 0.1124), ('ndcg@5', 0.1468), ('hit@5', 0.25), ('precision@5', 0.05)])
2024-07-10 10:49:45 pid 8245 | starting to iterate Train     3 (total=3), updating every 1 seconds
2024-07-10 10:49:48 pid 8245 | 0 of 3, 0.0% of Train     3, speed: -0.00 s/it, elapsed 0.66 seconds, [1;31mGPU RAM: 5.38 G/15.78 G loss: 4.77986[0m
2024-07-10 10:49:48 pid 8245 | finished Train     3. Total time: 0.66 seconds
INFO:root:[1;32mepoch 3 training[0m [[1;34mtime[0m: 2.09s, [1;34mtrain loss[0m: 4.4731]
2024-07-10 10:49:48 pid 8245 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:49:48 pid 8245 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.38 G/15.78 G[0m
2024-07-10 10:49:48 pid 8245 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.332210540771484)])
INFO:root:[1;32mepoch 3 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.332210540771484
2024-07-10 10:49:48 pid 8245 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.25), ('mrr@5', 0.1137), ('ndcg@5', 0.1478), ('hit@5', 0.25), ('precision@5', 0.05)])
2024-07-10 10:49:48 pid 8245 | starting to iterate Train     4 (total=3), updating every 1 seconds
2024-07-10 10:49:50 pid 8245 | 0 of 3, 0.0% of Train     4, speed: -0.00 s/it, elapsed 0.65 seconds, [1;31mGPU RAM: 5.38 G/15.78 G loss: 4.84530[0m
2024-07-10 10:49:50 pid 8245 | finished Train     4. Total time: 0.65 seconds
INFO:root:[1;32mepoch 4 training[0m [[1;34mtime[0m: 2.07s, [1;34mtrain loss[0m: 4.6964]
2024-07-10 10:49:50 pid 8245 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:49:50 pid 8245 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.38 G/15.78 G[0m
2024-07-10 10:49:50 pid 8245 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.3242387771606445)])
INFO:root:[1;32mepoch 4 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.3242387771606445
2024-07-10 10:49:50 pid 8245 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2578), ('mrr@5', 0.1115), ('ndcg@5', 0.1481), ('hit@5', 0.2578), ('precision@5', 0.0516)])
2024-07-10 10:49:50 pid 8245 | starting to iterate Train     5 (total=3), updating every 1 seconds
2024-07-10 10:49:52 pid 8245 | 0 of 3, 0.0% of Train     5, speed: -0.00 s/it, elapsed 0.66 seconds, [1;31mGPU RAM: 5.38 G/15.78 G loss: 4.92955[0m
2024-07-10 10:49:52 pid 8245 | finished Train     5. Total time: 0.66 seconds
INFO:root:[1;32mepoch 5 training[0m [[1;34mtime[0m: 2.08s, [1;34mtrain loss[0m: 4.8572]
2024-07-10 10:49:52 pid 8245 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:49:52 pid 8245 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.38 G/15.78 G[0m
2024-07-10 10:49:52 pid 8245 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.394626617431641)])
INFO:root:[1;32mepoch 5 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.394626617431641
2024-07-10 10:49:52 pid 8245 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2578), ('mrr@5', 0.1177), ('ndcg@5', 0.1529), ('hit@5', 0.2578), ('precision@5', 0.0516)])
2024-07-10 10:49:53 pid 8245 | starting to iterate Train     6 (total=3), updating every 1 seconds
2024-07-10 10:49:55 pid 8245 | 0 of 3, 0.0% of Train     6, speed: -0.00 s/it, elapsed 0.66 seconds, [1;31mGPU RAM: 5.38 G/15.78 G loss: 5.04948[0m
2024-07-10 10:49:55 pid 8245 | finished Train     6. Total time: 0.66 seconds
INFO:root:[1;32mepoch 6 training[0m [[1;34mtime[0m: 2.11s, [1;34mtrain loss[0m: 4.9254]
2024-07-10 10:49:55 pid 8245 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:49:55 pid 8245 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.38 G/15.78 G[0m
2024-07-10 10:49:55 pid 8245 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.436420917510986)])
INFO:root:[1;32mepoch 6 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.436420917510986
2024-07-10 10:49:55 pid 8245 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2578), ('mrr@5', 0.1181), ('ndcg@5', 0.1532), ('hit@5', 0.2578), ('precision@5', 0.0516)])
2024-07-10 10:49:55 pid 8245 | starting to iterate Train     7 (total=3), updating every 1 seconds
2024-07-10 10:49:57 pid 8245 | 0 of 3, 0.0% of Train     7, speed: -0.00 s/it, elapsed 0.67 seconds, [1;31mGPU RAM: 5.38 G/15.78 G loss: 5.08700[0m
2024-07-10 10:49:57 pid 8245 | finished Train     7. Total time: 0.67 seconds
INFO:root:[1;32mepoch 7 training[0m [[1;34mtime[0m: 2.09s, [1;34mtrain loss[0m: 5.0718]
2024-07-10 10:49:57 pid 8245 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:49:57 pid 8245 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.38 G/15.78 G[0m
2024-07-10 10:49:57 pid 8245 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.321295261383057)])
INFO:root:[1;32mepoch 7 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.321295261383057
2024-07-10 10:49:57 pid 8245 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2578), ('mrr@5', 0.1181), ('ndcg@5', 0.1532), ('hit@5', 0.2578), ('precision@5', 0.0516)])
2024-07-10 10:49:57 pid 8245 | starting to iterate Train     8 (total=3), updating every 1 seconds
2024-07-10 10:49:59 pid 8245 | 0 of 3, 0.0% of Train     8, speed: -0.00 s/it, elapsed 0.65 seconds, [1;31mGPU RAM: 5.38 G/15.78 G loss: 5.06695[0m
2024-07-10 10:49:59 pid 8245 | finished Train     8. Total time: 0.65 seconds
INFO:root:[1;32mepoch 8 training[0m [[1;34mtime[0m: 2.09s, [1;34mtrain loss[0m: 5.0979]
2024-07-10 10:49:59 pid 8245 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:50:00 pid 8245 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.38 G/15.78 G[0m
2024-07-10 10:50:00 pid 8245 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.441267490386963)])
INFO:root:[1;32mepoch 8 evaluating[0m [[1;34mtime[0m: 0.16s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.441267490386963
2024-07-10 10:50:00 pid 8245 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2578), ('mrr@5', 0.1266), ('ndcg@5', 0.1595), ('hit@5', 0.2578), ('precision@5', 0.0516)])
2024-07-10 10:50:00 pid 8245 | starting to iterate Train     9 (total=3), updating every 1 seconds
2024-07-10 10:50:02 pid 8245 | 0 of 3, 0.0% of Train     9, speed: -0.00 s/it, elapsed 0.66 seconds, [1;31mGPU RAM: 5.38 G/15.78 G loss: 4.98449[0m
2024-07-10 10:50:02 pid 8245 | finished Train     9. Total time: 0.66 seconds
INFO:root:[1;32mepoch 9 training[0m [[1;34mtime[0m: 2.09s, [1;34mtrain loss[0m: 5.3000]
2024-07-10 10:50:02 pid 8245 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:50:02 pid 8245 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.38 G/15.78 G[0m
2024-07-10 10:50:02 pid 8245 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.3530802726745605)])
INFO:root:[1;32mepoch 9 evaluating[0m [[1;34mtime[0m: 0.15s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.3530802726745605
2024-07-10 10:50:02 pid 8245 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2578), ('mrr@5', 0.1331), ('ndcg@5', 0.1645), ('hit@5', 0.2578), ('precision@5', 0.0516)])
Saving checkpoint on /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/09.pth
INFO:root:[1;34mSaving current[0m: /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/09.pth
2024-07-10 10:50:02 pid 8245 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:50:02 pid 8245 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.38 G/15.78 G[0m
2024-07-10 10:50:02 pid 8245 | finished [1;35mEvaluate in test   [0m. Total time: 0.05 seconds
OrderedDict([('recall@5', 0.1216), ('mrr@5', 0.0455), ('ndcg@5', 0.0645), ('hit@5', 0.1216), ('precision@5', 0.0243), ('test_loss', 6.106021404266357)])
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
INFO:faiss.loader:Loading faiss.
INFO:faiss.loader:Successfully loaded faiss.
WARNING:root:command line args [-c confs/fine_tune/progressive.json -s amazon-beauty -l amazon-100K -i test.pth -p confs/pre_train/config_dict_100K.json -o fine_tuned_checkpoint.pth] will not be used in RecBole

[1;35mGeneral Hyper Parameters:
[0m[1;36mgpu_id[0m =[1;33m 0[0m
[1;36muse_gpu[0m =[1;33m True[0m
[1;36mseed[0m =[1;33m 2020[0m
[1;36mstate[0m =[1;33m INFO[0m
[1;36mreproducibility[0m =[1;33m True[0m
[1;36mdata_path[0m =[1;33m /alloc/data/srt/data/output/amazon-beauty[0m
[1;36mcheckpoint_dir[0m =[1;33m saved[0m
[1;36mshow_progress[0m =[1;33m True[0m
[1;36msave_dataset[0m =[1;33m False[0m
[1;36mdataset_save_path[0m =[1;33m None[0m
[1;36msave_dataloaders[0m =[1;33m False[0m
[1;36mdataloaders_save_path[0m =[1;33m None[0m
[1;36mlog_wandb[0m =[1;33m False[0m

[1;35mTraining Hyper Parameters:
[0m[1;36mepochs[0m =[1;33m 2[0m
[1;36mtrain_batch_size[0m =[1;33m 128[0m
[1;36mlearner[0m =[1;33m adam[0m
[1;36mlearning_rate[0m =[1;33m 0.0001[0m
[1;36mtrain_neg_sample_args[0m =[1;33m {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}[0m
[1;36meval_step[0m =[1;33m 1[0m
[1;36mstopping_step[0m =[1;33m 20[0m
[1;36mclip_grad_norm[0m =[1;33m None[0m
[1;36mweight_decay[0m =[1;33m 1e-05[0m
[1;36mloss_decimal_place[0m =[1;33m 4[0m

[1;35mEvaluation Hyper Parameters:
[0m[1;36meval_args[0m =[1;33m {'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}[0m
[1;36mrepeatable[0m =[1;33m True[0m
[1;36mmetrics[0m =[1;33m ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision'][0m
[1;36mtopk[0m =[1;33m [5][0m
[1;36mvalid_metric[0m =[1;33m mrr@5[0m
[1;36mvalid_metric_bigger[0m =[1;33m True[0m
[1;36meval_batch_size[0m =[1;33m 128[0m
[1;36mmetric_decimal_place[0m =[1;33m 4[0m

[1;35mDataset Hyper Parameters:
[0m[1;36mfield_separator[0m =[1;33m 	[0m
[1;36mseq_separator[0m =[1;33m  [0m
[1;36mUSER_ID_FIELD[0m =[1;33m user_id[0m
[1;36mITEM_ID_FIELD[0m =[1;33m item_id[0m
[1;36mRATING_FIELD[0m =[1;33m rating[0m
[1;36mTIME_FIELD[0m =[1;33m timestamp[0m
[1;36mseq_len[0m =[1;33m None[0m
[1;36mLABEL_FIELD[0m =[1;33m label[0m
[1;36mthreshold[0m =[1;33m None[0m
[1;36mNEG_PREFIX[0m =[1;33m neg_[0m
[1;36mload_col[0m =[1;33m {'inter': ['user_id', 'item_id', 'rating', 'timestamp'], 'item': ['item_id', 'title', 'brand']}[0m
[1;36munload_col[0m =[1;33m None[0m
[1;36munused_col[0m =[1;33m None[0m
[1;36madditional_feat_suffix[0m =[1;33m None[0m
[1;36mrm_dup_inter[0m =[1;33m None[0m
[1;36mval_interval[0m =[1;33m None[0m
[1;36mfilter_inter_by_user_or_item[0m =[1;33m True[0m
[1;36muser_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36mitem_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36malias_of_user_id[0m =[1;33m None[0m
[1;36malias_of_item_id[0m =[1;33m None[0m
[1;36malias_of_entity_id[0m =[1;33m None[0m
[1;36malias_of_relation_id[0m =[1;33m None[0m
[1;36mpreload_weight[0m =[1;33m None[0m
[1;36mnormalize_field[0m =[1;33m None[0m
[1;36mnormalize_all[0m =[1;33m None[0m
[1;36mITEM_LIST_LENGTH_FIELD[0m =[1;33m item_length[0m
[1;36mLIST_SUFFIX[0m =[1;33m _list[0m
[1;36mMAX_ITEM_LIST_LENGTH[0m =[1;33m 50[0m
[1;36mPOSITION_FIELD[0m =[1;33m position_id[0m
[1;36mHEAD_ENTITY_ID_FIELD[0m =[1;33m head_id[0m
[1;36mTAIL_ENTITY_ID_FIELD[0m =[1;33m tail_id[0m
[1;36mRELATION_ID_FIELD[0m =[1;33m relation_id[0m
[1;36mENTITY_ID_FIELD[0m =[1;33m entity_id[0m
[1;36mbenchmark_filename[0m =[1;33m None[0m

[1;35mOther Hyper Parameters: 
[0m[1;36mworker[0m = [1;33m0[0m
[1;36mwandb_project[0m = [1;33mrecbole[0m
[1;36mshuffle[0m = [1;33mTrue[0m
[1;36mrequire_pow[0m = [1;33mFalse[0m
[1;36menable_amp[0m = [1;33mFalse[0m
[1;36menable_scaler[0m = [1;33mFalse[0m
[1;36mtransform[0m = [1;33mNone[0m
[1;36mn_layers[0m = [1;33m16[0m
[1;36mn_heads[0m = [1;33m4[0m
[1;36mhidden_size[0m = [1;33m256[0m
[1;36minner_size[0m = [1;33m256[0m
[1;36mhidden_dropout_prob[0m = [1;33m0.5[0m
[1;36mattn_dropout_prob[0m = [1;33m0.5[0m
[1;36mhidden_act[0m = [1;33mgelu[0m
[1;36mlayer_norm_eps[0m = [1;33m1e-12[0m
[1;36minitializer_range[0m = [1;33m0.02[0m
[1;36mselected_features[0m = [1;33m['title', 'brand'][0m
[1;36mpooling_mode[0m = [1;33msum[0m
[1;36mloss_type[0m = [1;33mInfoNCE-quick[0m
[1;36mnumerical_features[0m = [1;33m[][0m
[1;36mdiscretization[0m = [1;33mNone[0m
[1;36mkg_reverse_r[0m = [1;33mFalse[0m
[1;36mentity_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mrelation_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mMODEL_TYPE[0m = [1;33mModelType.SEQUENTIAL[0m
[1;36mmlflow[0m = [1;33m{'enable': True, 'experiment_name': 'fine-tune', 'run_name': '0f5d1302-97f4-4127-9cee-a6a702a5625b', 'tracking_uri': 'sqlite:///mlruns.sqlite', 'auto_continue': True}[0m
[1;36mmax_grad_norm[0m = [1;33m1.0[0m
[1;36mscheduler[0m = [1;33m{'type': 'one-cycle'}[0m
[1;36mnce_temperature[0m = [1;33m1[0m
[1;36mnce_label_smoothing[0m = [1;33m0.0[0m
[1;36mnormalize_embedding[0m = [1;33mFalse[0m
[1;36mevaluation_mode[0m = [1;33msampled50000[0m
[1;36mestimate_batch_size[0m = [1;33mFalse[0m
[1;36mnce_num_negatives[0m = [1;33m300[0m
[1;36mnce_sampling_strategy[0m = [1;33mpopularity[0m
[1;36mnce_global_negatives[0m = [1;33mFalse[0m
[1;36mgradient_accumulation_steps[0m = [1;33m10[0m
[1;36meval_type[0m = [1;33mEvaluatorType.RANKING[0m
[1;36msingle_spec[0m = [1;33mTrue[0m
[1;36mlocal_rank[0m = [1;33m0[0m
[1;36mdevice[0m = [1;33mcuda[0m
[1;36mvalid_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m
[1;36mtest_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m


INFO:root:[1;35m[Training]: [0m[1;36mtrain_batch_size[0m = [1;33m[128][0m[1;36m train_neg_sample_args[0m: [1;33m[{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}][0m
INFO:root:[1;35m[Evaluation]: [0m[1;36meval_batch_size[0m = [1;33m[128][0m[1;36m eval_args[0m: [1;33m[{'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}][0m
item features
The batch_size of interaction: 504
    item_id, torch.Size([504]), cuda, torch.int64
    title, torch.Size([504, 40]), cuda, torch.int64
    brand, torch.Size([504, 7]), cuda, torch.int64


example
['‚ñÅcra' 'bt' 'ree' '‚ñÅamp' '‚ñÅevelyn' '‚ñÅgardener' '‚ñÅs' '‚ñÅultra' '‚ñÅmoistur'
 'ising' '‚ñÅhand' '‚ñÅtherapy' '‚ñÅpump' '‚ñÅ250' 'g' '‚ñÅ8' '‚ñÅ8' '‚ñÅoz' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]']
INFO:alembic.runtime.migration:Context impl SQLiteImpl.
INFO:alembic.runtime.migration:Will assume non-transactional DDL.
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 6477056 but failed
tried to log param model_non_emb_params with value -4778240 but failed
tried to log param unfreeze_n_layers with value 10 but failed
Evaluation sanity
****************************************
2024-07-10 10:50:06 pid 8258 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:50:07 pid 8258 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.60 seconds, [1;33mGPU RAM: 2.33 G/15.78 G[0m
2024-07-10 10:50:07 pid 8258 | finished [1;35mEvaluate in test   [0m. Total time: 0.60 seconds
OrderedDict([('recall@5', 0.1216), ('mrr@5', 0.0455), ('ndcg@5', 0.0645), ('hit@5', 0.1216), ('precision@5', 0.0243), ('test_loss', 6.159816741943359)])
****************************************
Freezing embeddings
Freezing layer 0
Freezing layer 1
Freezing layer 2
Freezing layer 3
Freezing layer 4
Freezing layer 5
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 4089600 but failed
tried to log param model_non_emb_params with value -7165696 but failed
2024-07-10 10:50:07 pid 8258 | starting to iterate Train     0 (total=3), updating every 1 seconds
2024-07-10 10:50:09 pid 8258 | 0 of 3, 0.0% of Train     0, speed: -0.00 s/it, elapsed 0.69 seconds, [1;31mGPU RAM: 5.39 G/15.78 G loss: 4.88265[0m
2024-07-10 10:50:09 pid 8258 | finished Train     0. Total time: 0.69 seconds
INFO:root:[1;32mepoch 0 training[0m [[1;34mtime[0m: 2.26s, [1;34mtrain loss[0m: 4.3705]
2024-07-10 10:50:09 pid 8258 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:50:09 pid 8258 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.39 G/15.78 G[0m
2024-07-10 10:50:09 pid 8258 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.3242411613464355)])
INFO:root:[1;32mepoch 0 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.3242411613464355
2024-07-10 10:50:09 pid 8258 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2578), ('mrr@5', 0.1331), ('ndcg@5', 0.1645), ('hit@5', 0.2578), ('precision@5', 0.0516)])
2024-07-10 10:50:10 pid 8258 | starting to iterate Train     1 (total=3), updating every 1 seconds
2024-07-10 10:50:12 pid 8258 | 0 of 3, 0.0% of Train     1, speed: -0.00 s/it, elapsed 0.68 seconds, [1;31mGPU RAM: 5.39 G/15.78 G loss: 4.82090[0m
2024-07-10 10:50:12 pid 8258 | finished Train     1. Total time: 0.68 seconds
INFO:root:[1;32mepoch 1 training[0m [[1;34mtime[0m: 2.18s, [1;34mtrain loss[0m: 4.0829]
2024-07-10 10:50:12 pid 8258 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:50:12 pid 8258 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.39 G/15.78 G[0m
2024-07-10 10:50:12 pid 8258 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.298839569091797)])
INFO:root:[1;32mepoch 1 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.298839569091797
2024-07-10 10:50:12 pid 8258 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2656), ('mrr@5', 0.135), ('ndcg@5', 0.1678), ('hit@5', 0.2656), ('precision@5', 0.0531)])
2024-07-10 10:50:12 pid 8258 | starting to iterate Train     2 (total=3), updating every 1 seconds
2024-07-10 10:50:14 pid 8258 | 0 of 3, 0.0% of Train     2, speed: -0.00 s/it, elapsed 0.71 seconds, [1;31mGPU RAM: 5.39 G/15.78 G loss: 4.50479[0m
2024-07-10 10:50:14 pid 8258 | finished Train     2. Total time: 0.71 seconds
INFO:root:[1;32mepoch 2 training[0m [[1;34mtime[0m: 2.20s, [1;34mtrain loss[0m: 4.0530]
2024-07-10 10:50:14 pid 8258 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:50:14 pid 8258 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.39 G/15.78 G[0m
2024-07-10 10:50:14 pid 8258 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.370931625366211)])
INFO:root:[1;32mepoch 2 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.370931625366211
2024-07-10 10:50:14 pid 8258 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2656), ('mrr@5', 0.1344), ('ndcg@5', 0.1673), ('hit@5', 0.2656), ('precision@5', 0.0531)])
2024-07-10 10:50:15 pid 8258 | starting to iterate Train     3 (total=3), updating every 1 seconds
2024-07-10 10:50:17 pid 8258 | 0 of 3, 0.0% of Train     3, speed: -0.00 s/it, elapsed 0.69 seconds, [1;31mGPU RAM: 5.39 G/15.78 G loss: 4.55913[0m
2024-07-10 10:50:17 pid 8258 | finished Train     3. Total time: 0.69 seconds
INFO:root:[1;32mepoch 3 training[0m [[1;34mtime[0m: 2.21s, [1;34mtrain loss[0m: 4.2196]
2024-07-10 10:50:17 pid 8258 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:50:17 pid 8258 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.39 G/15.78 G[0m
2024-07-10 10:50:17 pid 8258 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.347241401672363)])
INFO:root:[1;32mepoch 3 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.347241401672363
2024-07-10 10:50:17 pid 8258 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2656), ('mrr@5', 0.135), ('ndcg@5', 0.1678), ('hit@5', 0.2656), ('precision@5', 0.0531)])
2024-07-10 10:50:17 pid 8258 | starting to iterate Train     4 (total=3), updating every 1 seconds
2024-07-10 10:50:19 pid 8258 | 0 of 3, 0.0% of Train     4, speed: -0.00 s/it, elapsed 0.69 seconds, [1;31mGPU RAM: 5.39 G/15.78 G loss: 4.63421[0m
2024-07-10 10:50:19 pid 8258 | finished Train     4. Total time: 0.69 seconds
INFO:root:[1;32mepoch 4 training[0m [[1;34mtime[0m: 2.18s, [1;34mtrain loss[0m: 4.4605]
2024-07-10 10:50:19 pid 8258 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:50:19 pid 8258 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.39 G/15.78 G[0m
2024-07-10 10:50:19 pid 8258 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.343160629272461)])
INFO:root:[1;32mepoch 4 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.343160629272461
2024-07-10 10:50:19 pid 8258 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2656), ('mrr@5', 0.1366), ('ndcg@5', 0.169), ('hit@5', 0.2656), ('precision@5', 0.0531)])
2024-07-10 10:50:20 pid 8258 | starting to iterate Train     5 (total=3), updating every 1 seconds
2024-07-10 10:50:22 pid 8258 | 0 of 3, 0.0% of Train     5, speed: -0.00 s/it, elapsed 0.68 seconds, [1;31mGPU RAM: 5.39 G/15.78 G loss: 4.75336[0m
2024-07-10 10:50:22 pid 8258 | finished Train     5. Total time: 0.68 seconds
INFO:root:[1;32mepoch 5 training[0m [[1;34mtime[0m: 2.24s, [1;34mtrain loss[0m: 4.6490]
2024-07-10 10:50:22 pid 8258 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:50:22 pid 8258 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.39 G/15.78 G[0m
2024-07-10 10:50:22 pid 8258 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.418201923370361)])
INFO:root:[1;32mepoch 5 evaluating[0m [[1;34mtime[0m: 0.15s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.418201923370361
2024-07-10 10:50:22 pid 8258 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2656), ('mrr@5', 0.1376), ('ndcg@5', 0.1699), ('hit@5', 0.2656), ('precision@5', 0.0531)])
2024-07-10 10:50:22 pid 8258 | starting to iterate Train     6 (total=3), updating every 1 seconds
2024-07-10 10:50:24 pid 8258 | 0 of 3, 0.0% of Train     6, speed: -0.00 s/it, elapsed 0.69 seconds, [1;31mGPU RAM: 5.39 G/15.78 G loss: 4.89735[0m
2024-07-10 10:50:24 pid 8258 | finished Train     6. Total time: 0.69 seconds
INFO:root:[1;32mepoch 6 training[0m [[1;34mtime[0m: 2.19s, [1;34mtrain loss[0m: 4.7421]
2024-07-10 10:50:24 pid 8258 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:50:24 pid 8258 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.39 G/15.78 G[0m
2024-07-10 10:50:24 pid 8258 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.472204208374023)])
INFO:root:[1;32mepoch 6 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.472204208374023
2024-07-10 10:50:24 pid 8258 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2812), ('mrr@5', 0.1404), ('ndcg@5', 0.1756), ('hit@5', 0.2812), ('precision@5', 0.0563)])
2024-07-10 10:50:25 pid 8258 | starting to iterate Train     7 (total=3), updating every 1 seconds
2024-07-10 10:50:27 pid 8258 | 0 of 3, 0.0% of Train     7, speed: -0.00 s/it, elapsed 0.68 seconds, [1;31mGPU RAM: 5.39 G/15.78 G loss: 4.94863[0m
2024-07-10 10:50:27 pid 8258 | finished Train     7. Total time: 0.68 seconds
INFO:root:[1;32mepoch 7 training[0m [[1;34mtime[0m: 2.17s, [1;34mtrain loss[0m: 4.9263]
2024-07-10 10:50:27 pid 8258 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:50:27 pid 8258 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.39 G/15.78 G[0m
2024-07-10 10:50:27 pid 8258 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.355225563049316)])
INFO:root:[1;32mepoch 7 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.355225563049316
2024-07-10 10:50:27 pid 8258 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2812), ('mrr@5', 0.141), ('ndcg@5', 0.1762), ('hit@5', 0.2812), ('precision@5', 0.0563)])
2024-07-10 10:50:27 pid 8258 | starting to iterate Train     8 (total=3), updating every 1 seconds
2024-07-10 10:50:29 pid 8258 | 0 of 3, 0.0% of Train     8, speed: -0.00 s/it, elapsed 0.68 seconds, [1;31mGPU RAM: 5.39 G/15.78 G loss: 4.93942[0m
2024-07-10 10:50:29 pid 8258 | finished Train     8. Total time: 0.68 seconds
INFO:root:[1;32mepoch 8 training[0m [[1;34mtime[0m: 2.17s, [1;34mtrain loss[0m: 4.9749]
2024-07-10 10:50:29 pid 8258 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:50:29 pid 8258 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.39 G/15.78 G[0m
2024-07-10 10:50:29 pid 8258 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.4649248123168945)])
INFO:root:[1;32mepoch 8 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.4649248123168945
2024-07-10 10:50:29 pid 8258 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2891), ('mrr@5', 0.1426), ('ndcg@5', 0.1792), ('hit@5', 0.2891), ('precision@5', 0.0578)])
2024-07-10 10:50:29 pid 8258 | starting to iterate Train     9 (total=3), updating every 1 seconds
2024-07-10 10:50:32 pid 8258 | 0 of 3, 0.0% of Train     9, speed: -0.00 s/it, elapsed 0.68 seconds, [1;31mGPU RAM: 5.39 G/15.78 G loss: 4.86793[0m
2024-07-10 10:50:32 pid 8258 | finished Train     9. Total time: 0.68 seconds
INFO:root:[1;32mepoch 9 training[0m [[1;34mtime[0m: 2.18s, [1;34mtrain loss[0m: 5.1895]
2024-07-10 10:50:32 pid 8258 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:50:32 pid 8258 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.39 G/15.78 G[0m
2024-07-10 10:50:32 pid 8258 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.376236915588379)])
INFO:root:[1;32mepoch 9 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.376236915588379
2024-07-10 10:50:32 pid 8258 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2969), ('mrr@5', 0.1458), ('ndcg@5', 0.1836), ('hit@5', 0.2969), ('precision@5', 0.0594)])
Saving checkpoint on /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/10.pth
INFO:root:[1;34mSaving current[0m: /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/10.pth
2024-07-10 10:50:32 pid 8258 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:50:32 pid 8258 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.39 G/15.78 G[0m
2024-07-10 10:50:32 pid 8258 | finished [1;35mEvaluate in test   [0m. Total time: 0.05 seconds
OrderedDict([('recall@5', 0.1351), ('mrr@5', 0.0482), ('ndcg@5', 0.0697), ('hit@5', 0.1351), ('precision@5', 0.027), ('test_loss', 6.108094692230225)])
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
INFO:faiss.loader:Loading faiss.
INFO:faiss.loader:Successfully loaded faiss.
WARNING:root:command line args [-c confs/fine_tune/progressive.json -s amazon-beauty -l amazon-100K -i test.pth -p confs/pre_train/config_dict_100K.json -o fine_tuned_checkpoint.pth] will not be used in RecBole

[1;35mGeneral Hyper Parameters:
[0m[1;36mgpu_id[0m =[1;33m 0[0m
[1;36muse_gpu[0m =[1;33m True[0m
[1;36mseed[0m =[1;33m 2020[0m
[1;36mstate[0m =[1;33m INFO[0m
[1;36mreproducibility[0m =[1;33m True[0m
[1;36mdata_path[0m =[1;33m /alloc/data/srt/data/output/amazon-beauty[0m
[1;36mcheckpoint_dir[0m =[1;33m saved[0m
[1;36mshow_progress[0m =[1;33m True[0m
[1;36msave_dataset[0m =[1;33m False[0m
[1;36mdataset_save_path[0m =[1;33m None[0m
[1;36msave_dataloaders[0m =[1;33m False[0m
[1;36mdataloaders_save_path[0m =[1;33m None[0m
[1;36mlog_wandb[0m =[1;33m False[0m

[1;35mTraining Hyper Parameters:
[0m[1;36mepochs[0m =[1;33m 2[0m
[1;36mtrain_batch_size[0m =[1;33m 128[0m
[1;36mlearner[0m =[1;33m adam[0m
[1;36mlearning_rate[0m =[1;33m 0.0001[0m
[1;36mtrain_neg_sample_args[0m =[1;33m {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}[0m
[1;36meval_step[0m =[1;33m 1[0m
[1;36mstopping_step[0m =[1;33m 20[0m
[1;36mclip_grad_norm[0m =[1;33m None[0m
[1;36mweight_decay[0m =[1;33m 1e-05[0m
[1;36mloss_decimal_place[0m =[1;33m 4[0m

[1;35mEvaluation Hyper Parameters:
[0m[1;36meval_args[0m =[1;33m {'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}[0m
[1;36mrepeatable[0m =[1;33m True[0m
[1;36mmetrics[0m =[1;33m ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision'][0m
[1;36mtopk[0m =[1;33m [5][0m
[1;36mvalid_metric[0m =[1;33m mrr@5[0m
[1;36mvalid_metric_bigger[0m =[1;33m True[0m
[1;36meval_batch_size[0m =[1;33m 128[0m
[1;36mmetric_decimal_place[0m =[1;33m 4[0m

[1;35mDataset Hyper Parameters:
[0m[1;36mfield_separator[0m =[1;33m 	[0m
[1;36mseq_separator[0m =[1;33m  [0m
[1;36mUSER_ID_FIELD[0m =[1;33m user_id[0m
[1;36mITEM_ID_FIELD[0m =[1;33m item_id[0m
[1;36mRATING_FIELD[0m =[1;33m rating[0m
[1;36mTIME_FIELD[0m =[1;33m timestamp[0m
[1;36mseq_len[0m =[1;33m None[0m
[1;36mLABEL_FIELD[0m =[1;33m label[0m
[1;36mthreshold[0m =[1;33m None[0m
[1;36mNEG_PREFIX[0m =[1;33m neg_[0m
[1;36mload_col[0m =[1;33m {'inter': ['user_id', 'item_id', 'rating', 'timestamp'], 'item': ['item_id', 'title', 'brand']}[0m
[1;36munload_col[0m =[1;33m None[0m
[1;36munused_col[0m =[1;33m None[0m
[1;36madditional_feat_suffix[0m =[1;33m None[0m
[1;36mrm_dup_inter[0m =[1;33m None[0m
[1;36mval_interval[0m =[1;33m None[0m
[1;36mfilter_inter_by_user_or_item[0m =[1;33m True[0m
[1;36muser_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36mitem_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36malias_of_user_id[0m =[1;33m None[0m
[1;36malias_of_item_id[0m =[1;33m None[0m
[1;36malias_of_entity_id[0m =[1;33m None[0m
[1;36malias_of_relation_id[0m =[1;33m None[0m
[1;36mpreload_weight[0m =[1;33m None[0m
[1;36mnormalize_field[0m =[1;33m None[0m
[1;36mnormalize_all[0m =[1;33m None[0m
[1;36mITEM_LIST_LENGTH_FIELD[0m =[1;33m item_length[0m
[1;36mLIST_SUFFIX[0m =[1;33m _list[0m
[1;36mMAX_ITEM_LIST_LENGTH[0m =[1;33m 50[0m
[1;36mPOSITION_FIELD[0m =[1;33m position_id[0m
[1;36mHEAD_ENTITY_ID_FIELD[0m =[1;33m head_id[0m
[1;36mTAIL_ENTITY_ID_FIELD[0m =[1;33m tail_id[0m
[1;36mRELATION_ID_FIELD[0m =[1;33m relation_id[0m
[1;36mENTITY_ID_FIELD[0m =[1;33m entity_id[0m
[1;36mbenchmark_filename[0m =[1;33m None[0m

[1;35mOther Hyper Parameters: 
[0m[1;36mworker[0m = [1;33m0[0m
[1;36mwandb_project[0m = [1;33mrecbole[0m
[1;36mshuffle[0m = [1;33mTrue[0m
[1;36mrequire_pow[0m = [1;33mFalse[0m
[1;36menable_amp[0m = [1;33mFalse[0m
[1;36menable_scaler[0m = [1;33mFalse[0m
[1;36mtransform[0m = [1;33mNone[0m
[1;36mn_layers[0m = [1;33m16[0m
[1;36mn_heads[0m = [1;33m4[0m
[1;36mhidden_size[0m = [1;33m256[0m
[1;36minner_size[0m = [1;33m256[0m
[1;36mhidden_dropout_prob[0m = [1;33m0.5[0m
[1;36mattn_dropout_prob[0m = [1;33m0.5[0m
[1;36mhidden_act[0m = [1;33mgelu[0m
[1;36mlayer_norm_eps[0m = [1;33m1e-12[0m
[1;36minitializer_range[0m = [1;33m0.02[0m
[1;36mselected_features[0m = [1;33m['title', 'brand'][0m
[1;36mpooling_mode[0m = [1;33msum[0m
[1;36mloss_type[0m = [1;33mInfoNCE-quick[0m
[1;36mnumerical_features[0m = [1;33m[][0m
[1;36mdiscretization[0m = [1;33mNone[0m
[1;36mkg_reverse_r[0m = [1;33mFalse[0m
[1;36mentity_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mrelation_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mMODEL_TYPE[0m = [1;33mModelType.SEQUENTIAL[0m
[1;36mmlflow[0m = [1;33m{'enable': True, 'experiment_name': 'fine-tune', 'run_name': '0f5d1302-97f4-4127-9cee-a6a702a5625b', 'tracking_uri': 'sqlite:///mlruns.sqlite', 'auto_continue': True}[0m
[1;36mmax_grad_norm[0m = [1;33m1.0[0m
[1;36mscheduler[0m = [1;33m{'type': 'one-cycle'}[0m
[1;36mnce_temperature[0m = [1;33m1[0m
[1;36mnce_label_smoothing[0m = [1;33m0.0[0m
[1;36mnormalize_embedding[0m = [1;33mFalse[0m
[1;36mevaluation_mode[0m = [1;33msampled50000[0m
[1;36mestimate_batch_size[0m = [1;33mFalse[0m
[1;36mnce_num_negatives[0m = [1;33m300[0m
[1;36mnce_sampling_strategy[0m = [1;33mpopularity[0m
[1;36mnce_global_negatives[0m = [1;33mFalse[0m
[1;36mgradient_accumulation_steps[0m = [1;33m10[0m
[1;36meval_type[0m = [1;33mEvaluatorType.RANKING[0m
[1;36msingle_spec[0m = [1;33mTrue[0m
[1;36mlocal_rank[0m = [1;33m0[0m
[1;36mdevice[0m = [1;33mcuda[0m
[1;36mvalid_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m
[1;36mtest_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m


INFO:root:[1;35m[Training]: [0m[1;36mtrain_batch_size[0m = [1;33m[128][0m[1;36m train_neg_sample_args[0m: [1;33m[{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}][0m
INFO:root:[1;35m[Evaluation]: [0m[1;36meval_batch_size[0m = [1;33m[128][0m[1;36m eval_args[0m: [1;33m[{'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}][0m
item features
The batch_size of interaction: 504
    item_id, torch.Size([504]), cuda, torch.int64
    title, torch.Size([504, 40]), cuda, torch.int64
    brand, torch.Size([504, 7]), cuda, torch.int64


example
['‚ñÅcra' 'bt' 'ree' '‚ñÅamp' '‚ñÅevelyn' '‚ñÅgardener' '‚ñÅs' '‚ñÅultra' '‚ñÅmoistur'
 'ising' '‚ñÅhand' '‚ñÅtherapy' '‚ñÅpump' '‚ñÅ250' 'g' '‚ñÅ8' '‚ñÅ8' '‚ñÅoz' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]']
INFO:alembic.runtime.migration:Context impl SQLiteImpl.
INFO:alembic.runtime.migration:Will assume non-transactional DDL.
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 6477056 but failed
tried to log param model_non_emb_params with value -4778240 but failed
tried to log param unfreeze_n_layers with value 11 but failed
Evaluation sanity
****************************************
2024-07-10 10:50:36 pid 8271 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:50:37 pid 8271 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.60 seconds, [1;33mGPU RAM: 2.33 G/15.78 G[0m
2024-07-10 10:50:37 pid 8271 | finished [1;35mEvaluate in test   [0m. Total time: 0.60 seconds
OrderedDict([('recall@5', 0.1351), ('mrr@5', 0.0482), ('ndcg@5', 0.0697), ('hit@5', 0.1351), ('precision@5', 0.027), ('test_loss', 6.165211200714111)])
****************************************
Freezing embeddings
Freezing layer 0
Freezing layer 1
Freezing layer 2
Freezing layer 3
Freezing layer 4
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 4485376 but failed
tried to log param model_non_emb_params with value -6769920 but failed
2024-07-10 10:50:37 pid 8271 | starting to iterate Train     0 (total=3), updating every 1 seconds
2024-07-10 10:50:39 pid 8271 | 0 of 3, 0.0% of Train     0, speed: -0.00 s/it, elapsed 0.71 seconds, [1;31mGPU RAM: 5.41 G/15.78 G loss: 4.69929[0m
2024-07-10 10:50:39 pid 8271 | finished Train     0. Total time: 0.71 seconds
INFO:root:[1;32mepoch 0 training[0m [[1;34mtime[0m: 2.29s, [1;34mtrain loss[0m: 4.1182]
2024-07-10 10:50:39 pid 8271 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:50:39 pid 8271 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.41 G/15.78 G[0m
2024-07-10 10:50:39 pid 8271 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.355773448944092)])
INFO:root:[1;32mepoch 0 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.355773448944092
2024-07-10 10:50:39 pid 8271 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.2969), ('mrr@5', 0.1458), ('ndcg@5', 0.1836), ('hit@5', 0.2969), ('precision@5', 0.0594)])
2024-07-10 10:50:39 pid 8271 | starting to iterate Train     1 (total=3), updating every 1 seconds
2024-07-10 10:50:42 pid 8271 | 0 of 3, 0.0% of Train     1, speed: -0.00 s/it, elapsed 0.71 seconds, [1;31mGPU RAM: 5.41 G/15.78 G loss: 4.62056[0m
2024-07-10 10:50:42 pid 8271 | finished Train     1. Total time: 0.71 seconds
INFO:root:[1;32mepoch 1 training[0m [[1;34mtime[0m: 2.27s, [1;34mtrain loss[0m: 3.8159]
2024-07-10 10:50:42 pid 8271 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:50:42 pid 8271 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.41 G/15.78 G[0m
2024-07-10 10:50:42 pid 8271 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.320949554443359)])
INFO:root:[1;32mepoch 1 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.320949554443359
2024-07-10 10:50:42 pid 8271 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3047), ('mrr@5', 0.148), ('ndcg@5', 0.1871), ('hit@5', 0.3047), ('precision@5', 0.0609)])
2024-07-10 10:50:42 pid 8271 | starting to iterate Train     2 (total=3), updating every 1 seconds
2024-07-10 10:50:44 pid 8271 | 0 of 3, 0.0% of Train     2, speed: -0.00 s/it, elapsed 0.73 seconds, [1;31mGPU RAM: 5.41 G/15.78 G loss: 4.27567[0m
2024-07-10 10:50:44 pid 8271 | finished Train     2. Total time: 0.73 seconds
INFO:root:[1;32mepoch 2 training[0m [[1;34mtime[0m: 2.28s, [1;34mtrain loss[0m: 3.7566]
2024-07-10 10:50:44 pid 8271 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:50:44 pid 8271 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.41 G/15.78 G[0m
2024-07-10 10:50:44 pid 8271 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.39068603515625)])
INFO:root:[1;32mepoch 2 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.39068603515625
2024-07-10 10:50:44 pid 8271 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3047), ('mrr@5', 0.1497), ('ndcg@5', 0.1885), ('hit@5', 0.3047), ('precision@5', 0.0609)])
2024-07-10 10:50:45 pid 8271 | starting to iterate Train     3 (total=3), updating every 1 seconds
2024-07-10 10:50:47 pid 8271 | 0 of 3, 0.0% of Train     3, speed: -0.00 s/it, elapsed 0.72 seconds, [1;31mGPU RAM: 5.41 G/15.78 G loss: 4.32644[0m
2024-07-10 10:50:47 pid 8271 | finished Train     3. Total time: 0.72 seconds
INFO:root:[1;32mepoch 3 training[0m [[1;34mtime[0m: 2.27s, [1;34mtrain loss[0m: 3.9591]
2024-07-10 10:50:47 pid 8271 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:50:47 pid 8271 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.41 G/15.78 G[0m
2024-07-10 10:50:47 pid 8271 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.366881847381592)])
INFO:root:[1;32mepoch 3 evaluating[0m [[1;34mtime[0m: 0.15s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.366881847381592
2024-07-10 10:50:47 pid 8271 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3125), ('mrr@5', 0.1556), ('ndcg@5', 0.1948), ('hit@5', 0.3125), ('precision@5', 0.0625)])
2024-07-10 10:50:47 pid 8271 | starting to iterate Train     4 (total=3), updating every 1 seconds
2024-07-10 10:50:49 pid 8271 | 0 of 3, 0.0% of Train     4, speed: -0.00 s/it, elapsed 0.72 seconds, [1;31mGPU RAM: 5.41 G/15.78 G loss: 4.41366[0m
2024-07-10 10:50:49 pid 8271 | finished Train     4. Total time: 0.72 seconds
INFO:root:[1;32mepoch 4 training[0m [[1;34mtime[0m: 2.28s, [1;34mtrain loss[0m: 4.2138]
2024-07-10 10:50:49 pid 8271 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:50:50 pid 8271 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.41 G/15.78 G[0m
2024-07-10 10:50:50 pid 8271 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.368282318115234)])
INFO:root:[1;32mepoch 4 evaluating[0m [[1;34mtime[0m: 0.15s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.368282318115234
2024-07-10 10:50:50 pid 8271 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3203), ('mrr@5', 0.1626), ('ndcg@5', 0.2019), ('hit@5', 0.3203), ('precision@5', 0.0641)])
2024-07-10 10:50:50 pid 8271 | starting to iterate Train     5 (total=3), updating every 1 seconds
2024-07-10 10:50:52 pid 8271 | 0 of 3, 0.0% of Train     5, speed: -0.00 s/it, elapsed 0.72 seconds, [1;31mGPU RAM: 5.41 G/15.78 G loss: 4.56680[0m
2024-07-10 10:50:52 pid 8271 | finished Train     5. Total time: 0.72 seconds
INFO:root:[1;32mepoch 5 training[0m [[1;34mtime[0m: 2.27s, [1;34mtrain loss[0m: 4.4308]
2024-07-10 10:50:52 pid 8271 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:50:52 pid 8271 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.41 G/15.78 G[0m
2024-07-10 10:50:52 pid 8271 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.445178985595703)])
INFO:root:[1;32mepoch 5 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.445178985595703
2024-07-10 10:50:52 pid 8271 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3281), ('mrr@5', 0.1659), ('ndcg@5', 0.2063), ('hit@5', 0.3281), ('precision@5', 0.0656)])
2024-07-10 10:50:52 pid 8271 | starting to iterate Train     6 (total=3), updating every 1 seconds
2024-07-10 10:50:55 pid 8271 | 0 of 3, 0.0% of Train     6, speed: -0.00 s/it, elapsed 0.72 seconds, [1;31mGPU RAM: 5.41 G/15.78 G loss: 4.73871[0m
2024-07-10 10:50:55 pid 8271 | finished Train     6. Total time: 0.72 seconds
INFO:root:[1;32mepoch 6 training[0m [[1;34mtime[0m: 2.29s, [1;34mtrain loss[0m: 4.5522]
2024-07-10 10:50:55 pid 8271 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:50:55 pid 8271 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.41 G/15.78 G[0m
2024-07-10 10:50:55 pid 8271 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.512922286987305)])
INFO:root:[1;32mepoch 6 evaluating[0m [[1;34mtime[0m: 0.15s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.512922286987305
2024-07-10 10:50:55 pid 8271 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3281), ('mrr@5', 0.1659), ('ndcg@5', 0.2063), ('hit@5', 0.3281), ('precision@5', 0.0656)])
2024-07-10 10:50:55 pid 8271 | starting to iterate Train     7 (total=3), updating every 1 seconds
2024-07-10 10:50:57 pid 8271 | 0 of 3, 0.0% of Train     7, speed: -0.00 s/it, elapsed 0.72 seconds, [1;31mGPU RAM: 5.41 G/15.78 G loss: 4.80605[0m
2024-07-10 10:50:57 pid 8271 | finished Train     7. Total time: 0.72 seconds
INFO:root:[1;32mepoch 7 training[0m [[1;34mtime[0m: 2.27s, [1;34mtrain loss[0m: 4.7769]
2024-07-10 10:50:57 pid 8271 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:50:57 pid 8271 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.41 G/15.78 G[0m
2024-07-10 10:50:57 pid 8271 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.397241592407227)])
INFO:root:[1;32mepoch 7 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.397241592407227
2024-07-10 10:50:57 pid 8271 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3281), ('mrr@5', 0.162), ('ndcg@5', 0.2034), ('hit@5', 0.3281), ('precision@5', 0.0656)])
2024-07-10 10:50:57 pid 8271 | starting to iterate Train     8 (total=3), updating every 1 seconds
2024-07-10 10:51:00 pid 8271 | 0 of 3, 0.0% of Train     8, speed: -0.00 s/it, elapsed 0.72 seconds, [1;31mGPU RAM: 5.41 G/15.78 G loss: 4.81118[0m
2024-07-10 10:51:00 pid 8271 | finished Train     8. Total time: 0.72 seconds
INFO:root:[1;32mepoch 8 training[0m [[1;34mtime[0m: 2.27s, [1;34mtrain loss[0m: 4.8516]
2024-07-10 10:51:00 pid 8271 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:51:00 pid 8271 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.41 G/15.78 G[0m
2024-07-10 10:51:00 pid 8271 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.494332313537598)])
INFO:root:[1;32mepoch 8 evaluating[0m [[1;34mtime[0m: 0.15s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.494332313537598
2024-07-10 10:51:00 pid 8271 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3359), ('mrr@5', 0.1691), ('ndcg@5', 0.2107), ('hit@5', 0.3359), ('precision@5', 0.0672)])
2024-07-10 10:51:00 pid 8271 | starting to iterate Train     9 (total=3), updating every 1 seconds
2024-07-10 10:51:02 pid 8271 | 0 of 3, 0.0% of Train     9, speed: -0.00 s/it, elapsed 0.71 seconds, [1;31mGPU RAM: 5.41 G/15.78 G loss: 4.75164[0m
2024-07-10 10:51:02 pid 8271 | finished Train     9. Total time: 0.71 seconds
INFO:root:[1;32mepoch 9 training[0m [[1;34mtime[0m: 2.28s, [1;34mtrain loss[0m: 5.0773]
2024-07-10 10:51:02 pid 8271 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:51:02 pid 8271 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.41 G/15.78 G[0m
2024-07-10 10:51:02 pid 8271 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.406067848205566)])
INFO:root:[1;32mepoch 9 evaluating[0m [[1;34mtime[0m: 0.15s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.406067848205566
2024-07-10 10:51:03 pid 8271 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3438), ('mrr@5', 0.1789), ('ndcg@5', 0.2198), ('hit@5', 0.3438), ('precision@5', 0.0688)])
Saving checkpoint on /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/11.pth
INFO:root:[1;34mSaving current[0m: /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/11.pth
2024-07-10 10:51:03 pid 8271 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:51:03 pid 8271 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.41 G/15.78 G[0m
2024-07-10 10:51:03 pid 8271 | finished [1;35mEvaluate in test   [0m. Total time: 0.05 seconds
OrderedDict([('recall@5', 0.1486), ('mrr@5', 0.0538), ('ndcg@5', 0.0774), ('hit@5', 0.1486), ('precision@5', 0.0297), ('test_loss', 6.112734794616699)])
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
INFO:faiss.loader:Loading faiss.
INFO:faiss.loader:Successfully loaded faiss.
WARNING:root:command line args [-c confs/fine_tune/progressive.json -s amazon-beauty -l amazon-100K -i test.pth -p confs/pre_train/config_dict_100K.json -o fine_tuned_checkpoint.pth] will not be used in RecBole

[1;35mGeneral Hyper Parameters:
[0m[1;36mgpu_id[0m =[1;33m 0[0m
[1;36muse_gpu[0m =[1;33m True[0m
[1;36mseed[0m =[1;33m 2020[0m
[1;36mstate[0m =[1;33m INFO[0m
[1;36mreproducibility[0m =[1;33m True[0m
[1;36mdata_path[0m =[1;33m /alloc/data/srt/data/output/amazon-beauty[0m
[1;36mcheckpoint_dir[0m =[1;33m saved[0m
[1;36mshow_progress[0m =[1;33m True[0m
[1;36msave_dataset[0m =[1;33m False[0m
[1;36mdataset_save_path[0m =[1;33m None[0m
[1;36msave_dataloaders[0m =[1;33m False[0m
[1;36mdataloaders_save_path[0m =[1;33m None[0m
[1;36mlog_wandb[0m =[1;33m False[0m

[1;35mTraining Hyper Parameters:
[0m[1;36mepochs[0m =[1;33m 2[0m
[1;36mtrain_batch_size[0m =[1;33m 128[0m
[1;36mlearner[0m =[1;33m adam[0m
[1;36mlearning_rate[0m =[1;33m 0.0001[0m
[1;36mtrain_neg_sample_args[0m =[1;33m {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}[0m
[1;36meval_step[0m =[1;33m 1[0m
[1;36mstopping_step[0m =[1;33m 20[0m
[1;36mclip_grad_norm[0m =[1;33m None[0m
[1;36mweight_decay[0m =[1;33m 1e-05[0m
[1;36mloss_decimal_place[0m =[1;33m 4[0m

[1;35mEvaluation Hyper Parameters:
[0m[1;36meval_args[0m =[1;33m {'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}[0m
[1;36mrepeatable[0m =[1;33m True[0m
[1;36mmetrics[0m =[1;33m ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision'][0m
[1;36mtopk[0m =[1;33m [5][0m
[1;36mvalid_metric[0m =[1;33m mrr@5[0m
[1;36mvalid_metric_bigger[0m =[1;33m True[0m
[1;36meval_batch_size[0m =[1;33m 128[0m
[1;36mmetric_decimal_place[0m =[1;33m 4[0m

[1;35mDataset Hyper Parameters:
[0m[1;36mfield_separator[0m =[1;33m 	[0m
[1;36mseq_separator[0m =[1;33m  [0m
[1;36mUSER_ID_FIELD[0m =[1;33m user_id[0m
[1;36mITEM_ID_FIELD[0m =[1;33m item_id[0m
[1;36mRATING_FIELD[0m =[1;33m rating[0m
[1;36mTIME_FIELD[0m =[1;33m timestamp[0m
[1;36mseq_len[0m =[1;33m None[0m
[1;36mLABEL_FIELD[0m =[1;33m label[0m
[1;36mthreshold[0m =[1;33m None[0m
[1;36mNEG_PREFIX[0m =[1;33m neg_[0m
[1;36mload_col[0m =[1;33m {'inter': ['user_id', 'item_id', 'rating', 'timestamp'], 'item': ['item_id', 'title', 'brand']}[0m
[1;36munload_col[0m =[1;33m None[0m
[1;36munused_col[0m =[1;33m None[0m
[1;36madditional_feat_suffix[0m =[1;33m None[0m
[1;36mrm_dup_inter[0m =[1;33m None[0m
[1;36mval_interval[0m =[1;33m None[0m
[1;36mfilter_inter_by_user_or_item[0m =[1;33m True[0m
[1;36muser_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36mitem_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36malias_of_user_id[0m =[1;33m None[0m
[1;36malias_of_item_id[0m =[1;33m None[0m
[1;36malias_of_entity_id[0m =[1;33m None[0m
[1;36malias_of_relation_id[0m =[1;33m None[0m
[1;36mpreload_weight[0m =[1;33m None[0m
[1;36mnormalize_field[0m =[1;33m None[0m
[1;36mnormalize_all[0m =[1;33m None[0m
[1;36mITEM_LIST_LENGTH_FIELD[0m =[1;33m item_length[0m
[1;36mLIST_SUFFIX[0m =[1;33m _list[0m
[1;36mMAX_ITEM_LIST_LENGTH[0m =[1;33m 50[0m
[1;36mPOSITION_FIELD[0m =[1;33m position_id[0m
[1;36mHEAD_ENTITY_ID_FIELD[0m =[1;33m head_id[0m
[1;36mTAIL_ENTITY_ID_FIELD[0m =[1;33m tail_id[0m
[1;36mRELATION_ID_FIELD[0m =[1;33m relation_id[0m
[1;36mENTITY_ID_FIELD[0m =[1;33m entity_id[0m
[1;36mbenchmark_filename[0m =[1;33m None[0m

[1;35mOther Hyper Parameters: 
[0m[1;36mworker[0m = [1;33m0[0m
[1;36mwandb_project[0m = [1;33mrecbole[0m
[1;36mshuffle[0m = [1;33mTrue[0m
[1;36mrequire_pow[0m = [1;33mFalse[0m
[1;36menable_amp[0m = [1;33mFalse[0m
[1;36menable_scaler[0m = [1;33mFalse[0m
[1;36mtransform[0m = [1;33mNone[0m
[1;36mn_layers[0m = [1;33m16[0m
[1;36mn_heads[0m = [1;33m4[0m
[1;36mhidden_size[0m = [1;33m256[0m
[1;36minner_size[0m = [1;33m256[0m
[1;36mhidden_dropout_prob[0m = [1;33m0.5[0m
[1;36mattn_dropout_prob[0m = [1;33m0.5[0m
[1;36mhidden_act[0m = [1;33mgelu[0m
[1;36mlayer_norm_eps[0m = [1;33m1e-12[0m
[1;36minitializer_range[0m = [1;33m0.02[0m
[1;36mselected_features[0m = [1;33m['title', 'brand'][0m
[1;36mpooling_mode[0m = [1;33msum[0m
[1;36mloss_type[0m = [1;33mInfoNCE-quick[0m
[1;36mnumerical_features[0m = [1;33m[][0m
[1;36mdiscretization[0m = [1;33mNone[0m
[1;36mkg_reverse_r[0m = [1;33mFalse[0m
[1;36mentity_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mrelation_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mMODEL_TYPE[0m = [1;33mModelType.SEQUENTIAL[0m
[1;36mmlflow[0m = [1;33m{'enable': True, 'experiment_name': 'fine-tune', 'run_name': '0f5d1302-97f4-4127-9cee-a6a702a5625b', 'tracking_uri': 'sqlite:///mlruns.sqlite', 'auto_continue': True}[0m
[1;36mmax_grad_norm[0m = [1;33m1.0[0m
[1;36mscheduler[0m = [1;33m{'type': 'one-cycle'}[0m
[1;36mnce_temperature[0m = [1;33m1[0m
[1;36mnce_label_smoothing[0m = [1;33m0.0[0m
[1;36mnormalize_embedding[0m = [1;33mFalse[0m
[1;36mevaluation_mode[0m = [1;33msampled50000[0m
[1;36mestimate_batch_size[0m = [1;33mFalse[0m
[1;36mnce_num_negatives[0m = [1;33m300[0m
[1;36mnce_sampling_strategy[0m = [1;33mpopularity[0m
[1;36mnce_global_negatives[0m = [1;33mFalse[0m
[1;36mgradient_accumulation_steps[0m = [1;33m10[0m
[1;36meval_type[0m = [1;33mEvaluatorType.RANKING[0m
[1;36msingle_spec[0m = [1;33mTrue[0m
[1;36mlocal_rank[0m = [1;33m0[0m
[1;36mdevice[0m = [1;33mcuda[0m
[1;36mvalid_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m
[1;36mtest_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m


INFO:root:[1;35m[Training]: [0m[1;36mtrain_batch_size[0m = [1;33m[128][0m[1;36m train_neg_sample_args[0m: [1;33m[{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}][0m
INFO:root:[1;35m[Evaluation]: [0m[1;36meval_batch_size[0m = [1;33m[128][0m[1;36m eval_args[0m: [1;33m[{'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}][0m
item features
The batch_size of interaction: 504
    item_id, torch.Size([504]), cuda, torch.int64
    title, torch.Size([504, 40]), cuda, torch.int64
    brand, torch.Size([504, 7]), cuda, torch.int64


example
['‚ñÅcra' 'bt' 'ree' '‚ñÅamp' '‚ñÅevelyn' '‚ñÅgardener' '‚ñÅs' '‚ñÅultra' '‚ñÅmoistur'
 'ising' '‚ñÅhand' '‚ñÅtherapy' '‚ñÅpump' '‚ñÅ250' 'g' '‚ñÅ8' '‚ñÅ8' '‚ñÅoz' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]']
INFO:alembic.runtime.migration:Context impl SQLiteImpl.
INFO:alembic.runtime.migration:Will assume non-transactional DDL.
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 6477056 but failed
tried to log param model_non_emb_params with value -4778240 but failed
tried to log param unfreeze_n_layers with value 12 but failed
Evaluation sanity
****************************************
2024-07-10 10:51:07 pid 8284 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:51:07 pid 8284 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.59 seconds, [1;33mGPU RAM: 2.34 G/15.78 G[0m
2024-07-10 10:51:07 pid 8284 | finished [1;35mEvaluate in test   [0m. Total time: 0.59 seconds
OrderedDict([('recall@5', 0.1486), ('mrr@5', 0.0538), ('ndcg@5', 0.0774), ('hit@5', 0.1486), ('precision@5', 0.0297), ('test_loss', 6.174683094024658)])
****************************************
Freezing embeddings
Freezing layer 0
Freezing layer 1
Freezing layer 2
Freezing layer 3
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 4881152 but failed
tried to log param model_non_emb_params with value -6374144 but failed
2024-07-10 10:51:08 pid 8284 | starting to iterate Train     0 (total=3), updating every 1 seconds
2024-07-10 10:51:10 pid 8284 | 0 of 3, 0.0% of Train     0, speed: -0.00 s/it, elapsed 0.75 seconds, [1;31mGPU RAM: 5.42 G/15.78 G loss: 4.50559[0m
2024-07-10 10:51:10 pid 8284 | finished Train     0. Total time: 0.75 seconds
INFO:root:[1;32mepoch 0 training[0m [[1;34mtime[0m: 2.40s, [1;34mtrain loss[0m: 3.8650]
2024-07-10 10:51:10 pid 8284 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:51:10 pid 8284 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.06 seconds, [1;33mGPU RAM: 5.42 G/15.78 G[0m
2024-07-10 10:51:10 pid 8284 | finished [1;35mEvaluate in valid   [0m. Total time: 0.06 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.392392158508301)])
INFO:root:[1;32mepoch 0 evaluating[0m [[1;34mtime[0m: 0.16s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.392392158508301
2024-07-10 10:51:10 pid 8284 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3438), ('mrr@5', 0.1793), ('ndcg@5', 0.2201), ('hit@5', 0.3438), ('precision@5', 0.0688)])
2024-07-10 10:51:10 pid 8284 | starting to iterate Train     1 (total=3), updating every 1 seconds
2024-07-10 10:51:13 pid 8284 | 0 of 3, 0.0% of Train     1, speed: -0.00 s/it, elapsed 0.74 seconds, [1;31mGPU RAM: 5.42 G/15.78 G loss: 4.40705[0m
2024-07-10 10:51:13 pid 8284 | finished Train     1. Total time: 0.74 seconds
INFO:root:[1;32mepoch 1 training[0m [[1;34mtime[0m: 2.34s, [1;34mtrain loss[0m: 3.5525]
2024-07-10 10:51:13 pid 8284 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:51:13 pid 8284 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.42 G/15.78 G[0m
2024-07-10 10:51:13 pid 8284 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.347997665405273)])
INFO:root:[1;32mepoch 1 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.347997665405273
2024-07-10 10:51:13 pid 8284 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3438), ('mrr@5', 0.1803), ('ndcg@5', 0.221), ('hit@5', 0.3438), ('precision@5', 0.0688)])
2024-07-10 10:51:13 pid 8284 | starting to iterate Train     2 (total=3), updating every 1 seconds
2024-07-10 10:51:15 pid 8284 | 0 of 3, 0.0% of Train     2, speed: -0.00 s/it, elapsed 0.75 seconds, [1;31mGPU RAM: 5.42 G/15.78 G loss: 4.03434[0m
2024-07-10 10:51:15 pid 8284 | finished Train     2. Total time: 0.75 seconds
INFO:root:[1;32mepoch 2 training[0m [[1;34mtime[0m: 2.38s, [1;34mtrain loss[0m: 3.4653]
2024-07-10 10:51:15 pid 8284 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:51:15 pid 8284 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.42 G/15.78 G[0m
2024-07-10 10:51:15 pid 8284 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.414185047149658)])
INFO:root:[1;32mepoch 2 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.414185047149658
2024-07-10 10:51:16 pid 8284 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3438), ('mrr@5', 0.1764), ('ndcg@5', 0.2181), ('hit@5', 0.3438), ('precision@5', 0.0688)])
2024-07-10 10:51:16 pid 8284 | starting to iterate Train     3 (total=3), updating every 1 seconds
2024-07-10 10:51:18 pid 8284 | 0 of 3, 0.0% of Train     3, speed: -0.00 s/it, elapsed 0.75 seconds, [1;31mGPU RAM: 5.42 G/15.78 G loss: 4.08138[0m
2024-07-10 10:51:18 pid 8284 | finished Train     3. Total time: 0.75 seconds
INFO:root:[1;32mepoch 3 training[0m [[1;34mtime[0m: 2.36s, [1;34mtrain loss[0m: 3.6931]
2024-07-10 10:51:18 pid 8284 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:51:18 pid 8284 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.42 G/15.78 G[0m
2024-07-10 10:51:18 pid 8284 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.391672134399414)])
INFO:root:[1;32mepoch 3 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.391672134399414
2024-07-10 10:51:18 pid 8284 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3516), ('mrr@5', 0.1786), ('ndcg@5', 0.2217), ('hit@5', 0.3516), ('precision@5', 0.0703)])
2024-07-10 10:51:18 pid 8284 | starting to iterate Train     4 (total=3), updating every 1 seconds
2024-07-10 10:51:21 pid 8284 | 0 of 3, 0.0% of Train     4, speed: -0.00 s/it, elapsed 0.77 seconds, [1;31mGPU RAM: 5.42 G/15.78 G loss: 4.18337[0m
2024-07-10 10:51:21 pid 8284 | finished Train     4. Total time: 0.77 seconds
INFO:root:[1;32mepoch 4 training[0m [[1;34mtime[0m: 2.38s, [1;34mtrain loss[0m: 3.9579]
2024-07-10 10:51:21 pid 8284 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:51:21 pid 8284 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.42 G/15.78 G[0m
2024-07-10 10:51:21 pid 8284 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.4000372886657715)])
INFO:root:[1;32mepoch 4 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.4000372886657715
2024-07-10 10:51:21 pid 8284 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3516), ('mrr@5', 0.1835), ('ndcg@5', 0.2253), ('hit@5', 0.3516), ('precision@5', 0.0703)])
2024-07-10 10:51:21 pid 8284 | starting to iterate Train     5 (total=3), updating every 1 seconds
2024-07-10 10:51:23 pid 8284 | 0 of 3, 0.0% of Train     5, speed: -0.00 s/it, elapsed 0.76 seconds, [1;31mGPU RAM: 5.42 G/15.78 G loss: 4.36944[0m
2024-07-10 10:51:23 pid 8284 | finished Train     5. Total time: 0.76 seconds
INFO:root:[1;32mepoch 5 training[0m [[1;34mtime[0m: 2.38s, [1;34mtrain loss[0m: 4.2042]
2024-07-10 10:51:23 pid 8284 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:51:23 pid 8284 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.42 G/15.78 G[0m
2024-07-10 10:51:23 pid 8284 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.474811553955078)])
INFO:root:[1;32mepoch 5 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.474811553955078
2024-07-10 10:51:24 pid 8284 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3516), ('mrr@5', 0.1852), ('ndcg@5', 0.2266), ('hit@5', 0.3516), ('precision@5', 0.0703)])
2024-07-10 10:51:24 pid 8284 | starting to iterate Train     6 (total=3), updating every 1 seconds
2024-07-10 10:51:26 pid 8284 | 0 of 3, 0.0% of Train     6, speed: -0.00 s/it, elapsed 0.74 seconds, [1;31mGPU RAM: 5.42 G/15.78 G loss: 4.57349[0m
2024-07-10 10:51:26 pid 8284 | finished Train     6. Total time: 0.74 seconds
INFO:root:[1;32mepoch 6 training[0m [[1;34mtime[0m: 2.38s, [1;34mtrain loss[0m: 4.3579]
2024-07-10 10:51:26 pid 8284 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:51:26 pid 8284 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.42 G/15.78 G[0m
2024-07-10 10:51:26 pid 8284 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.55907678604126)])
INFO:root:[1;32mepoch 6 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.55907678604126
2024-07-10 10:51:26 pid 8284 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3594), ('mrr@5', 0.1871), ('ndcg@5', 0.23), ('hit@5', 0.3594), ('precision@5', 0.0719)])
2024-07-10 10:51:26 pid 8284 | starting to iterate Train     7 (total=3), updating every 1 seconds
2024-07-10 10:51:29 pid 8284 | 0 of 3, 0.0% of Train     7, speed: -0.00 s/it, elapsed 0.75 seconds, [1;31mGPU RAM: 5.42 G/15.78 G loss: 4.65869[0m
2024-07-10 10:51:29 pid 8284 | finished Train     7. Total time: 0.75 seconds
INFO:root:[1;32mepoch 7 training[0m [[1;34mtime[0m: 2.35s, [1;34mtrain loss[0m: 4.6236]
2024-07-10 10:51:29 pid 8284 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:51:29 pid 8284 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.42 G/15.78 G[0m
2024-07-10 10:51:29 pid 8284 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.442356586456299)])
INFO:root:[1;32mepoch 7 evaluating[0m [[1;34mtime[0m: 0.15s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.442356586456299
2024-07-10 10:51:29 pid 8284 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3594), ('mrr@5', 0.1871), ('ndcg@5', 0.23), ('hit@5', 0.3594), ('precision@5', 0.0719)])
2024-07-10 10:51:29 pid 8284 | starting to iterate Train     8 (total=3), updating every 1 seconds
2024-07-10 10:51:31 pid 8284 | 0 of 3, 0.0% of Train     8, speed: -0.00 s/it, elapsed 0.75 seconds, [1;31mGPU RAM: 5.42 G/15.78 G loss: 4.68351[0m
2024-07-10 10:51:31 pid 8284 | finished Train     8. Total time: 0.75 seconds
INFO:root:[1;32mepoch 8 training[0m [[1;34mtime[0m: 2.38s, [1;34mtrain loss[0m: 4.7287]
2024-07-10 10:51:31 pid 8284 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:51:31 pid 8284 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.42 G/15.78 G[0m
2024-07-10 10:51:31 pid 8284 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.5281982421875)])
INFO:root:[1;32mepoch 8 evaluating[0m [[1;34mtime[0m: 0.15s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.5281982421875
2024-07-10 10:51:32 pid 8284 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3672), ('mrr@5', 0.1887), ('ndcg@5', 0.233), ('hit@5', 0.3672), ('precision@5', 0.0734)])
2024-07-10 10:51:32 pid 8284 | starting to iterate Train     9 (total=3), updating every 1 seconds
2024-07-10 10:51:34 pid 8284 | 0 of 3, 0.0% of Train     9, speed: -0.00 s/it, elapsed 0.74 seconds, [1;31mGPU RAM: 5.42 G/15.78 G loss: 4.63614[0m
2024-07-10 10:51:34 pid 8284 | finished Train     9. Total time: 0.74 seconds
INFO:root:[1;32mepoch 9 training[0m [[1;34mtime[0m: 2.36s, [1;34mtrain loss[0m: 4.9639]
2024-07-10 10:51:34 pid 8284 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:51:34 pid 8284 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.42 G/15.78 G[0m
2024-07-10 10:51:34 pid 8284 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.442234516143799)])
INFO:root:[1;32mepoch 9 evaluating[0m [[1;34mtime[0m: 0.16s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.442234516143799
2024-07-10 10:51:34 pid 8284 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3672), ('mrr@5', 0.1895), ('ndcg@5', 0.2337), ('hit@5', 0.3672), ('precision@5', 0.0734)])
Saving checkpoint on /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/12.pth
INFO:root:[1;34mSaving current[0m: /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/12.pth
2024-07-10 10:51:35 pid 8284 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:51:35 pid 8284 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.06 seconds, [1;33mGPU RAM: 5.42 G/15.78 G[0m
2024-07-10 10:51:35 pid 8284 | finished [1;35mEvaluate in test   [0m. Total time: 0.06 seconds
OrderedDict([('recall@5', 0.1486), ('mrr@5', 0.0568), ('ndcg@5', 0.0798), ('hit@5', 0.1486), ('precision@5', 0.0297), ('test_loss', 6.120087623596191)])
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
INFO:faiss.loader:Loading faiss.
INFO:faiss.loader:Successfully loaded faiss.
WARNING:root:command line args [-c confs/fine_tune/progressive.json -s amazon-beauty -l amazon-100K -i test.pth -p confs/pre_train/config_dict_100K.json -o fine_tuned_checkpoint.pth] will not be used in RecBole

[1;35mGeneral Hyper Parameters:
[0m[1;36mgpu_id[0m =[1;33m 0[0m
[1;36muse_gpu[0m =[1;33m True[0m
[1;36mseed[0m =[1;33m 2020[0m
[1;36mstate[0m =[1;33m INFO[0m
[1;36mreproducibility[0m =[1;33m True[0m
[1;36mdata_path[0m =[1;33m /alloc/data/srt/data/output/amazon-beauty[0m
[1;36mcheckpoint_dir[0m =[1;33m saved[0m
[1;36mshow_progress[0m =[1;33m True[0m
[1;36msave_dataset[0m =[1;33m False[0m
[1;36mdataset_save_path[0m =[1;33m None[0m
[1;36msave_dataloaders[0m =[1;33m False[0m
[1;36mdataloaders_save_path[0m =[1;33m None[0m
[1;36mlog_wandb[0m =[1;33m False[0m

[1;35mTraining Hyper Parameters:
[0m[1;36mepochs[0m =[1;33m 2[0m
[1;36mtrain_batch_size[0m =[1;33m 128[0m
[1;36mlearner[0m =[1;33m adam[0m
[1;36mlearning_rate[0m =[1;33m 0.0001[0m
[1;36mtrain_neg_sample_args[0m =[1;33m {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}[0m
[1;36meval_step[0m =[1;33m 1[0m
[1;36mstopping_step[0m =[1;33m 20[0m
[1;36mclip_grad_norm[0m =[1;33m None[0m
[1;36mweight_decay[0m =[1;33m 1e-05[0m
[1;36mloss_decimal_place[0m =[1;33m 4[0m

[1;35mEvaluation Hyper Parameters:
[0m[1;36meval_args[0m =[1;33m {'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}[0m
[1;36mrepeatable[0m =[1;33m True[0m
[1;36mmetrics[0m =[1;33m ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision'][0m
[1;36mtopk[0m =[1;33m [5][0m
[1;36mvalid_metric[0m =[1;33m mrr@5[0m
[1;36mvalid_metric_bigger[0m =[1;33m True[0m
[1;36meval_batch_size[0m =[1;33m 128[0m
[1;36mmetric_decimal_place[0m =[1;33m 4[0m

[1;35mDataset Hyper Parameters:
[0m[1;36mfield_separator[0m =[1;33m 	[0m
[1;36mseq_separator[0m =[1;33m  [0m
[1;36mUSER_ID_FIELD[0m =[1;33m user_id[0m
[1;36mITEM_ID_FIELD[0m =[1;33m item_id[0m
[1;36mRATING_FIELD[0m =[1;33m rating[0m
[1;36mTIME_FIELD[0m =[1;33m timestamp[0m
[1;36mseq_len[0m =[1;33m None[0m
[1;36mLABEL_FIELD[0m =[1;33m label[0m
[1;36mthreshold[0m =[1;33m None[0m
[1;36mNEG_PREFIX[0m =[1;33m neg_[0m
[1;36mload_col[0m =[1;33m {'inter': ['user_id', 'item_id', 'rating', 'timestamp'], 'item': ['item_id', 'title', 'brand']}[0m
[1;36munload_col[0m =[1;33m None[0m
[1;36munused_col[0m =[1;33m None[0m
[1;36madditional_feat_suffix[0m =[1;33m None[0m
[1;36mrm_dup_inter[0m =[1;33m None[0m
[1;36mval_interval[0m =[1;33m None[0m
[1;36mfilter_inter_by_user_or_item[0m =[1;33m True[0m
[1;36muser_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36mitem_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36malias_of_user_id[0m =[1;33m None[0m
[1;36malias_of_item_id[0m =[1;33m None[0m
[1;36malias_of_entity_id[0m =[1;33m None[0m
[1;36malias_of_relation_id[0m =[1;33m None[0m
[1;36mpreload_weight[0m =[1;33m None[0m
[1;36mnormalize_field[0m =[1;33m None[0m
[1;36mnormalize_all[0m =[1;33m None[0m
[1;36mITEM_LIST_LENGTH_FIELD[0m =[1;33m item_length[0m
[1;36mLIST_SUFFIX[0m =[1;33m _list[0m
[1;36mMAX_ITEM_LIST_LENGTH[0m =[1;33m 50[0m
[1;36mPOSITION_FIELD[0m =[1;33m position_id[0m
[1;36mHEAD_ENTITY_ID_FIELD[0m =[1;33m head_id[0m
[1;36mTAIL_ENTITY_ID_FIELD[0m =[1;33m tail_id[0m
[1;36mRELATION_ID_FIELD[0m =[1;33m relation_id[0m
[1;36mENTITY_ID_FIELD[0m =[1;33m entity_id[0m
[1;36mbenchmark_filename[0m =[1;33m None[0m

[1;35mOther Hyper Parameters: 
[0m[1;36mworker[0m = [1;33m0[0m
[1;36mwandb_project[0m = [1;33mrecbole[0m
[1;36mshuffle[0m = [1;33mTrue[0m
[1;36mrequire_pow[0m = [1;33mFalse[0m
[1;36menable_amp[0m = [1;33mFalse[0m
[1;36menable_scaler[0m = [1;33mFalse[0m
[1;36mtransform[0m = [1;33mNone[0m
[1;36mn_layers[0m = [1;33m16[0m
[1;36mn_heads[0m = [1;33m4[0m
[1;36mhidden_size[0m = [1;33m256[0m
[1;36minner_size[0m = [1;33m256[0m
[1;36mhidden_dropout_prob[0m = [1;33m0.5[0m
[1;36mattn_dropout_prob[0m = [1;33m0.5[0m
[1;36mhidden_act[0m = [1;33mgelu[0m
[1;36mlayer_norm_eps[0m = [1;33m1e-12[0m
[1;36minitializer_range[0m = [1;33m0.02[0m
[1;36mselected_features[0m = [1;33m['title', 'brand'][0m
[1;36mpooling_mode[0m = [1;33msum[0m
[1;36mloss_type[0m = [1;33mInfoNCE-quick[0m
[1;36mnumerical_features[0m = [1;33m[][0m
[1;36mdiscretization[0m = [1;33mNone[0m
[1;36mkg_reverse_r[0m = [1;33mFalse[0m
[1;36mentity_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mrelation_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mMODEL_TYPE[0m = [1;33mModelType.SEQUENTIAL[0m
[1;36mmlflow[0m = [1;33m{'enable': True, 'experiment_name': 'fine-tune', 'run_name': '0f5d1302-97f4-4127-9cee-a6a702a5625b', 'tracking_uri': 'sqlite:///mlruns.sqlite', 'auto_continue': True}[0m
[1;36mmax_grad_norm[0m = [1;33m1.0[0m
[1;36mscheduler[0m = [1;33m{'type': 'one-cycle'}[0m
[1;36mnce_temperature[0m = [1;33m1[0m
[1;36mnce_label_smoothing[0m = [1;33m0.0[0m
[1;36mnormalize_embedding[0m = [1;33mFalse[0m
[1;36mevaluation_mode[0m = [1;33msampled50000[0m
[1;36mestimate_batch_size[0m = [1;33mFalse[0m
[1;36mnce_num_negatives[0m = [1;33m300[0m
[1;36mnce_sampling_strategy[0m = [1;33mpopularity[0m
[1;36mnce_global_negatives[0m = [1;33mFalse[0m
[1;36mgradient_accumulation_steps[0m = [1;33m10[0m
[1;36meval_type[0m = [1;33mEvaluatorType.RANKING[0m
[1;36msingle_spec[0m = [1;33mTrue[0m
[1;36mlocal_rank[0m = [1;33m0[0m
[1;36mdevice[0m = [1;33mcuda[0m
[1;36mvalid_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m
[1;36mtest_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m


INFO:root:[1;35m[Training]: [0m[1;36mtrain_batch_size[0m = [1;33m[128][0m[1;36m train_neg_sample_args[0m: [1;33m[{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}][0m
INFO:root:[1;35m[Evaluation]: [0m[1;36meval_batch_size[0m = [1;33m[128][0m[1;36m eval_args[0m: [1;33m[{'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}][0m
item features
The batch_size of interaction: 504
    item_id, torch.Size([504]), cuda, torch.int64
    title, torch.Size([504, 40]), cuda, torch.int64
    brand, torch.Size([504, 7]), cuda, torch.int64


example
['‚ñÅcra' 'bt' 'ree' '‚ñÅamp' '‚ñÅevelyn' '‚ñÅgardener' '‚ñÅs' '‚ñÅultra' '‚ñÅmoistur'
 'ising' '‚ñÅhand' '‚ñÅtherapy' '‚ñÅpump' '‚ñÅ250' 'g' '‚ñÅ8' '‚ñÅ8' '‚ñÅoz' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]']
INFO:alembic.runtime.migration:Context impl SQLiteImpl.
INFO:alembic.runtime.migration:Will assume non-transactional DDL.
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 6477056 but failed
tried to log param model_non_emb_params with value -4778240 but failed
tried to log param unfreeze_n_layers with value 13 but failed
Evaluation sanity
****************************************
2024-07-10 10:51:38 pid 8297 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:51:39 pid 8297 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.59 seconds, [1;33mGPU RAM: 2.35 G/15.78 G[0m
2024-07-10 10:51:39 pid 8297 | finished [1;35mEvaluate in test   [0m. Total time: 0.59 seconds
OrderedDict([('recall@5', 0.1486), ('mrr@5', 0.0568), ('ndcg@5', 0.0798), ('hit@5', 0.1486), ('precision@5', 0.0297), ('test_loss', 6.188664436340332)])
****************************************
Freezing embeddings
Freezing layer 0
Freezing layer 1
Freezing layer 2
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 5276928 but failed
tried to log param model_non_emb_params with value -5978368 but failed
2024-07-10 10:51:39 pid 8297 | starting to iterate Train     0 (total=3), updating every 1 seconds
2024-07-10 10:51:42 pid 8297 | 0 of 3, 0.0% of Train     0, speed: -0.00 s/it, elapsed 0.77 seconds, [1;31mGPU RAM: 5.44 G/15.78 G loss: 4.30102[0m
2024-07-10 10:51:42 pid 8297 | finished Train     0. Total time: 0.77 seconds
INFO:root:[1;32mepoch 0 training[0m [[1;34mtime[0m: 2.48s, [1;34mtrain loss[0m: 3.6124]
2024-07-10 10:51:42 pid 8297 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:51:42 pid 8297 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.44 G/15.78 G[0m
2024-07-10 10:51:42 pid 8297 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.432821273803711)])
INFO:root:[1;32mepoch 0 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.432821273803711
2024-07-10 10:51:42 pid 8297 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3672), ('mrr@5', 0.1895), ('ndcg@5', 0.2337), ('hit@5', 0.3672), ('precision@5', 0.0734)])
2024-07-10 10:51:42 pid 8297 | starting to iterate Train     1 (total=3), updating every 1 seconds
2024-07-10 10:51:45 pid 8297 | 0 of 3, 0.0% of Train     1, speed: -0.00 s/it, elapsed 0.77 seconds, [1;31mGPU RAM: 5.44 G/15.78 G loss: 4.17827[0m
2024-07-10 10:51:45 pid 8297 | finished Train     1. Total time: 0.77 seconds
INFO:root:[1;32mepoch 1 training[0m [[1;34mtime[0m: 2.46s, [1;34mtrain loss[0m: 3.2932]
2024-07-10 10:51:45 pid 8297 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:51:45 pid 8297 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.44 G/15.78 G[0m
2024-07-10 10:51:45 pid 8297 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.378848075866699)])
INFO:root:[1;32mepoch 1 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.378848075866699
2024-07-10 10:51:45 pid 8297 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3672), ('mrr@5', 0.1898), ('ndcg@5', 0.234), ('hit@5', 0.3672), ('precision@5', 0.0734)])
2024-07-10 10:51:45 pid 8297 | starting to iterate Train     2 (total=3), updating every 1 seconds
2024-07-10 10:51:47 pid 8297 | 0 of 3, 0.0% of Train     2, speed: -0.00 s/it, elapsed 0.77 seconds, [1;31mGPU RAM: 5.44 G/15.78 G loss: 3.78251[0m
2024-07-10 10:51:47 pid 8297 | finished Train     2. Total time: 0.77 seconds
INFO:root:[1;32mepoch 2 training[0m [[1;34mtime[0m: 2.45s, [1;34mtrain loss[0m: 3.1820]
2024-07-10 10:51:47 pid 8297 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:51:47 pid 8297 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.44 G/15.78 G[0m
2024-07-10 10:51:47 pid 8297 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.440389633178711)])
INFO:root:[1;32mepoch 2 evaluating[0m [[1;34mtime[0m: 0.15s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.440389633178711
2024-07-10 10:51:47 pid 8297 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3672), ('mrr@5', 0.1909), ('ndcg@5', 0.2349), ('hit@5', 0.3672), ('precision@5', 0.0734)])
2024-07-10 10:51:48 pid 8297 | starting to iterate Train     3 (total=3), updating every 1 seconds
2024-07-10 10:51:50 pid 8297 | 0 of 3, 0.0% of Train     3, speed: -0.00 s/it, elapsed 0.78 seconds, [1;31mGPU RAM: 5.44 G/15.78 G loss: 3.82471[0m
2024-07-10 10:51:50 pid 8297 | finished Train     3. Total time: 0.78 seconds
INFO:root:[1;32mepoch 3 training[0m [[1;34mtime[0m: 2.45s, [1;34mtrain loss[0m: 3.4247]
2024-07-10 10:51:50 pid 8297 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:51:50 pid 8297 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.44 G/15.78 G[0m
2024-07-10 10:51:50 pid 8297 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.420201301574707)])
INFO:root:[1;32mepoch 3 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.420201301574707
2024-07-10 10:51:50 pid 8297 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3672), ('mrr@5', 0.1944), ('ndcg@5', 0.2375), ('hit@5', 0.3672), ('precision@5', 0.0734)])
2024-07-10 10:51:50 pid 8297 | starting to iterate Train     4 (total=3), updating every 1 seconds
2024-07-10 10:51:53 pid 8297 | 0 of 3, 0.0% of Train     4, speed: -0.00 s/it, elapsed 0.79 seconds, [1;31mGPU RAM: 5.44 G/15.78 G loss: 3.94323[0m
2024-07-10 10:51:53 pid 8297 | finished Train     4. Total time: 0.79 seconds
INFO:root:[1;32mepoch 4 training[0m [[1;34mtime[0m: 2.47s, [1;34mtrain loss[0m: 3.6951]
2024-07-10 10:51:53 pid 8297 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:51:53 pid 8297 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.44 G/15.78 G[0m
2024-07-10 10:51:53 pid 8297 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.437690734863281)])
INFO:root:[1;32mepoch 4 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.437690734863281
2024-07-10 10:51:53 pid 8297 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.375), ('mrr@5', 0.1977), ('ndcg@5', 0.2419), ('hit@5', 0.375), ('precision@5', 0.075)])
2024-07-10 10:51:53 pid 8297 | starting to iterate Train     5 (total=3), updating every 1 seconds
2024-07-10 10:51:56 pid 8297 | 0 of 3, 0.0% of Train     5, speed: -0.00 s/it, elapsed 0.78 seconds, [1;31mGPU RAM: 5.44 G/15.78 G loss: 4.16068[0m
2024-07-10 10:51:56 pid 8297 | finished Train     5. Total time: 0.78 seconds
INFO:root:[1;32mepoch 5 training[0m [[1;34mtime[0m: 2.47s, [1;34mtrain loss[0m: 3.9711]
2024-07-10 10:51:56 pid 8297 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:51:56 pid 8297 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.44 G/15.78 G[0m
2024-07-10 10:51:56 pid 8297 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.506961822509766)])
INFO:root:[1;32mepoch 5 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.506961822509766
2024-07-10 10:51:56 pid 8297 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.375), ('mrr@5', 0.2022), ('ndcg@5', 0.2453), ('hit@5', 0.375), ('precision@5', 0.075)])
2024-07-10 10:51:56 pid 8297 | starting to iterate Train     6 (total=3), updating every 1 seconds
2024-07-10 10:51:58 pid 8297 | 0 of 3, 0.0% of Train     6, speed: -0.00 s/it, elapsed 0.77 seconds, [1;31mGPU RAM: 5.44 G/15.78 G loss: 4.40111[0m
2024-07-10 10:51:58 pid 8297 | finished Train     6. Total time: 0.77 seconds
INFO:root:[1;32mepoch 6 training[0m [[1;34mtime[0m: 2.44s, [1;34mtrain loss[0m: 4.1613]
2024-07-10 10:51:58 pid 8297 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:51:58 pid 8297 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.44 G/15.78 G[0m
2024-07-10 10:51:58 pid 8297 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.609111785888672)])
INFO:root:[1;32mepoch 6 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.609111785888672
2024-07-10 10:51:58 pid 8297 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3828), ('mrr@5', 0.2044), ('ndcg@5', 0.2489), ('hit@5', 0.3828), ('precision@5', 0.0766)])
2024-07-10 10:51:59 pid 8297 | starting to iterate Train     7 (total=3), updating every 1 seconds
2024-07-10 10:52:01 pid 8297 | 0 of 3, 0.0% of Train     7, speed: -0.00 s/it, elapsed 0.77 seconds, [1;31mGPU RAM: 5.44 G/15.78 G loss: 4.50760[0m
2024-07-10 10:52:01 pid 8297 | finished Train     7. Total time: 0.77 seconds
INFO:root:[1;32mepoch 7 training[0m [[1;34mtime[0m: 2.46s, [1;34mtrain loss[0m: 4.4666]
2024-07-10 10:52:01 pid 8297 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:52:01 pid 8297 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.44 G/15.78 G[0m
2024-07-10 10:52:01 pid 8297 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.489025592803955)])
INFO:root:[1;32mepoch 7 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.489025592803955
2024-07-10 10:52:01 pid 8297 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3828), ('mrr@5', 0.2064), ('ndcg@5', 0.2505), ('hit@5', 0.3828), ('precision@5', 0.0766)])
2024-07-10 10:52:01 pid 8297 | starting to iterate Train     8 (total=3), updating every 1 seconds
2024-07-10 10:52:04 pid 8297 | 0 of 3, 0.0% of Train     8, speed: -0.00 s/it, elapsed 0.77 seconds, [1;31mGPU RAM: 5.44 G/15.78 G loss: 4.55619[0m
2024-07-10 10:52:04 pid 8297 | finished Train     8. Total time: 0.77 seconds
INFO:root:[1;32mepoch 8 training[0m [[1;34mtime[0m: 2.44s, [1;34mtrain loss[0m: 4.6056]
2024-07-10 10:52:04 pid 8297 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:52:04 pid 8297 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.44 G/15.78 G[0m
2024-07-10 10:52:04 pid 8297 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.565670967102051)])
INFO:root:[1;32mepoch 8 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.565670967102051
2024-07-10 10:52:04 pid 8297 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3828), ('mrr@5', 0.2064), ('ndcg@5', 0.2505), ('hit@5', 0.3828), ('precision@5', 0.0766)])
2024-07-10 10:52:04 pid 8297 | starting to iterate Train     9 (total=3), updating every 1 seconds
2024-07-10 10:52:06 pid 8297 | 0 of 3, 0.0% of Train     9, speed: -0.00 s/it, elapsed 0.78 seconds, [1;31mGPU RAM: 5.44 G/15.78 G loss: 4.52325[0m
2024-07-10 10:52:06 pid 8297 | finished Train     9. Total time: 0.78 seconds
INFO:root:[1;32mepoch 9 training[0m [[1;34mtime[0m: 2.46s, [1;34mtrain loss[0m: 4.8511]
2024-07-10 10:52:07 pid 8297 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:52:07 pid 8297 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.44 G/15.78 G[0m
2024-07-10 10:52:07 pid 8297 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.485666275024414)])
INFO:root:[1;32mepoch 9 evaluating[0m [[1;34mtime[0m: 0.22s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.485666275024414
2024-07-10 10:52:07 pid 8297 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3828), ('mrr@5', 0.2068), ('ndcg@5', 0.2508), ('hit@5', 0.3828), ('precision@5', 0.0766)])
Saving checkpoint on /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/13.pth
INFO:root:[1;34mSaving current[0m: /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/13.pth
2024-07-10 10:52:07 pid 8297 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:52:07 pid 8297 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.44 G/15.78 G[0m
2024-07-10 10:52:07 pid 8297 | finished [1;35mEvaluate in test   [0m. Total time: 0.05 seconds
OrderedDict([('recall@5', 0.1486), ('mrr@5', 0.0579), ('ndcg@5', 0.0807), ('hit@5', 0.1486), ('precision@5', 0.0297), ('test_loss', 6.130954265594482)])
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
INFO:faiss.loader:Loading faiss.
INFO:faiss.loader:Successfully loaded faiss.
WARNING:root:command line args [-c confs/fine_tune/progressive.json -s amazon-beauty -l amazon-100K -i test.pth -p confs/pre_train/config_dict_100K.json -o fine_tuned_checkpoint.pth] will not be used in RecBole

[1;35mGeneral Hyper Parameters:
[0m[1;36mgpu_id[0m =[1;33m 0[0m
[1;36muse_gpu[0m =[1;33m True[0m
[1;36mseed[0m =[1;33m 2020[0m
[1;36mstate[0m =[1;33m INFO[0m
[1;36mreproducibility[0m =[1;33m True[0m
[1;36mdata_path[0m =[1;33m /alloc/data/srt/data/output/amazon-beauty[0m
[1;36mcheckpoint_dir[0m =[1;33m saved[0m
[1;36mshow_progress[0m =[1;33m True[0m
[1;36msave_dataset[0m =[1;33m False[0m
[1;36mdataset_save_path[0m =[1;33m None[0m
[1;36msave_dataloaders[0m =[1;33m False[0m
[1;36mdataloaders_save_path[0m =[1;33m None[0m
[1;36mlog_wandb[0m =[1;33m False[0m

[1;35mTraining Hyper Parameters:
[0m[1;36mepochs[0m =[1;33m 2[0m
[1;36mtrain_batch_size[0m =[1;33m 128[0m
[1;36mlearner[0m =[1;33m adam[0m
[1;36mlearning_rate[0m =[1;33m 0.0001[0m
[1;36mtrain_neg_sample_args[0m =[1;33m {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}[0m
[1;36meval_step[0m =[1;33m 1[0m
[1;36mstopping_step[0m =[1;33m 20[0m
[1;36mclip_grad_norm[0m =[1;33m None[0m
[1;36mweight_decay[0m =[1;33m 1e-05[0m
[1;36mloss_decimal_place[0m =[1;33m 4[0m

[1;35mEvaluation Hyper Parameters:
[0m[1;36meval_args[0m =[1;33m {'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}[0m
[1;36mrepeatable[0m =[1;33m True[0m
[1;36mmetrics[0m =[1;33m ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision'][0m
[1;36mtopk[0m =[1;33m [5][0m
[1;36mvalid_metric[0m =[1;33m mrr@5[0m
[1;36mvalid_metric_bigger[0m =[1;33m True[0m
[1;36meval_batch_size[0m =[1;33m 128[0m
[1;36mmetric_decimal_place[0m =[1;33m 4[0m

[1;35mDataset Hyper Parameters:
[0m[1;36mfield_separator[0m =[1;33m 	[0m
[1;36mseq_separator[0m =[1;33m  [0m
[1;36mUSER_ID_FIELD[0m =[1;33m user_id[0m
[1;36mITEM_ID_FIELD[0m =[1;33m item_id[0m
[1;36mRATING_FIELD[0m =[1;33m rating[0m
[1;36mTIME_FIELD[0m =[1;33m timestamp[0m
[1;36mseq_len[0m =[1;33m None[0m
[1;36mLABEL_FIELD[0m =[1;33m label[0m
[1;36mthreshold[0m =[1;33m None[0m
[1;36mNEG_PREFIX[0m =[1;33m neg_[0m
[1;36mload_col[0m =[1;33m {'inter': ['user_id', 'item_id', 'rating', 'timestamp'], 'item': ['item_id', 'title', 'brand']}[0m
[1;36munload_col[0m =[1;33m None[0m
[1;36munused_col[0m =[1;33m None[0m
[1;36madditional_feat_suffix[0m =[1;33m None[0m
[1;36mrm_dup_inter[0m =[1;33m None[0m
[1;36mval_interval[0m =[1;33m None[0m
[1;36mfilter_inter_by_user_or_item[0m =[1;33m True[0m
[1;36muser_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36mitem_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36malias_of_user_id[0m =[1;33m None[0m
[1;36malias_of_item_id[0m =[1;33m None[0m
[1;36malias_of_entity_id[0m =[1;33m None[0m
[1;36malias_of_relation_id[0m =[1;33m None[0m
[1;36mpreload_weight[0m =[1;33m None[0m
[1;36mnormalize_field[0m =[1;33m None[0m
[1;36mnormalize_all[0m =[1;33m None[0m
[1;36mITEM_LIST_LENGTH_FIELD[0m =[1;33m item_length[0m
[1;36mLIST_SUFFIX[0m =[1;33m _list[0m
[1;36mMAX_ITEM_LIST_LENGTH[0m =[1;33m 50[0m
[1;36mPOSITION_FIELD[0m =[1;33m position_id[0m
[1;36mHEAD_ENTITY_ID_FIELD[0m =[1;33m head_id[0m
[1;36mTAIL_ENTITY_ID_FIELD[0m =[1;33m tail_id[0m
[1;36mRELATION_ID_FIELD[0m =[1;33m relation_id[0m
[1;36mENTITY_ID_FIELD[0m =[1;33m entity_id[0m
[1;36mbenchmark_filename[0m =[1;33m None[0m

[1;35mOther Hyper Parameters: 
[0m[1;36mworker[0m = [1;33m0[0m
[1;36mwandb_project[0m = [1;33mrecbole[0m
[1;36mshuffle[0m = [1;33mTrue[0m
[1;36mrequire_pow[0m = [1;33mFalse[0m
[1;36menable_amp[0m = [1;33mFalse[0m
[1;36menable_scaler[0m = [1;33mFalse[0m
[1;36mtransform[0m = [1;33mNone[0m
[1;36mn_layers[0m = [1;33m16[0m
[1;36mn_heads[0m = [1;33m4[0m
[1;36mhidden_size[0m = [1;33m256[0m
[1;36minner_size[0m = [1;33m256[0m
[1;36mhidden_dropout_prob[0m = [1;33m0.5[0m
[1;36mattn_dropout_prob[0m = [1;33m0.5[0m
[1;36mhidden_act[0m = [1;33mgelu[0m
[1;36mlayer_norm_eps[0m = [1;33m1e-12[0m
[1;36minitializer_range[0m = [1;33m0.02[0m
[1;36mselected_features[0m = [1;33m['title', 'brand'][0m
[1;36mpooling_mode[0m = [1;33msum[0m
[1;36mloss_type[0m = [1;33mInfoNCE-quick[0m
[1;36mnumerical_features[0m = [1;33m[][0m
[1;36mdiscretization[0m = [1;33mNone[0m
[1;36mkg_reverse_r[0m = [1;33mFalse[0m
[1;36mentity_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mrelation_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mMODEL_TYPE[0m = [1;33mModelType.SEQUENTIAL[0m
[1;36mmlflow[0m = [1;33m{'enable': True, 'experiment_name': 'fine-tune', 'run_name': '0f5d1302-97f4-4127-9cee-a6a702a5625b', 'tracking_uri': 'sqlite:///mlruns.sqlite', 'auto_continue': True}[0m
[1;36mmax_grad_norm[0m = [1;33m1.0[0m
[1;36mscheduler[0m = [1;33m{'type': 'one-cycle'}[0m
[1;36mnce_temperature[0m = [1;33m1[0m
[1;36mnce_label_smoothing[0m = [1;33m0.0[0m
[1;36mnormalize_embedding[0m = [1;33mFalse[0m
[1;36mevaluation_mode[0m = [1;33msampled50000[0m
[1;36mestimate_batch_size[0m = [1;33mFalse[0m
[1;36mnce_num_negatives[0m = [1;33m300[0m
[1;36mnce_sampling_strategy[0m = [1;33mpopularity[0m
[1;36mnce_global_negatives[0m = [1;33mFalse[0m
[1;36mgradient_accumulation_steps[0m = [1;33m10[0m
[1;36meval_type[0m = [1;33mEvaluatorType.RANKING[0m
[1;36msingle_spec[0m = [1;33mTrue[0m
[1;36mlocal_rank[0m = [1;33m0[0m
[1;36mdevice[0m = [1;33mcuda[0m
[1;36mvalid_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m
[1;36mtest_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m


INFO:root:[1;35m[Training]: [0m[1;36mtrain_batch_size[0m = [1;33m[128][0m[1;36m train_neg_sample_args[0m: [1;33m[{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}][0m
INFO:root:[1;35m[Evaluation]: [0m[1;36meval_batch_size[0m = [1;33m[128][0m[1;36m eval_args[0m: [1;33m[{'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}][0m
item features
The batch_size of interaction: 504
    item_id, torch.Size([504]), cuda, torch.int64
    title, torch.Size([504, 40]), cuda, torch.int64
    brand, torch.Size([504, 7]), cuda, torch.int64


example
['‚ñÅcra' 'bt' 'ree' '‚ñÅamp' '‚ñÅevelyn' '‚ñÅgardener' '‚ñÅs' '‚ñÅultra' '‚ñÅmoistur'
 'ising' '‚ñÅhand' '‚ñÅtherapy' '‚ñÅpump' '‚ñÅ250' 'g' '‚ñÅ8' '‚ñÅ8' '‚ñÅoz' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]']
INFO:alembic.runtime.migration:Context impl SQLiteImpl.
INFO:alembic.runtime.migration:Will assume non-transactional DDL.
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 6477056 but failed
tried to log param model_non_emb_params with value -4778240 but failed
tried to log param unfreeze_n_layers with value 14 but failed
Evaluation sanity
****************************************
2024-07-10 10:52:11 pid 8310 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:52:12 pid 8310 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.59 seconds, [1;33mGPU RAM: 2.35 G/15.78 G[0m
2024-07-10 10:52:12 pid 8310 | finished [1;35mEvaluate in test   [0m. Total time: 0.59 seconds
OrderedDict([('recall@5', 0.1486), ('mrr@5', 0.0579), ('ndcg@5', 0.0807), ('hit@5', 0.1486), ('precision@5', 0.0297), ('test_loss', 6.206848621368408)])
****************************************
Freezing embeddings
Freezing layer 0
Freezing layer 1
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 5672704 but failed
tried to log param model_non_emb_params with value -5582592 but failed
2024-07-10 10:52:12 pid 8310 | starting to iterate Train     0 (total=3), updating every 1 seconds
2024-07-10 10:52:14 pid 8310 | 0 of 3, 0.0% of Train     0, speed: -0.00 s/it, elapsed 0.79 seconds, [1;31mGPU RAM: 5.45 G/15.78 G loss: 4.08664[0m
2024-07-10 10:52:14 pid 8310 | finished Train     0. Total time: 0.79 seconds
INFO:root:[1;32mepoch 0 training[0m [[1;34mtime[0m: 2.57s, [1;34mtrain loss[0m: 3.3609]
2024-07-10 10:52:14 pid 8310 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:52:15 pid 8310 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.45 G/15.78 G[0m
2024-07-10 10:52:15 pid 8310 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.475910186767578)])
INFO:root:[1;32mepoch 0 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.475910186767578
2024-07-10 10:52:15 pid 8310 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3828), ('mrr@5', 0.2068), ('ndcg@5', 0.2508), ('hit@5', 0.3828), ('precision@5', 0.0766)])
2024-07-10 10:52:15 pid 8310 | starting to iterate Train     1 (total=3), updating every 1 seconds
2024-07-10 10:52:17 pid 8310 | 0 of 3, 0.0% of Train     1, speed: -0.00 s/it, elapsed 0.80 seconds, [1;31mGPU RAM: 5.45 G/15.78 G loss: 3.93246[0m
2024-07-10 10:52:17 pid 8310 | finished Train     1. Total time: 0.80 seconds
INFO:root:[1;32mepoch 1 training[0m [[1;34mtime[0m: 2.56s, [1;34mtrain loss[0m: 3.0371]
2024-07-10 10:52:17 pid 8310 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:52:17 pid 8310 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.45 G/15.78 G[0m
2024-07-10 10:52:17 pid 8310 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.413392543792725)])
INFO:root:[1;32mepoch 1 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.413392543792725
2024-07-10 10:52:17 pid 8310 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3828), ('mrr@5', 0.2078), ('ndcg@5', 0.2517), ('hit@5', 0.3828), ('precision@5', 0.0766)])
2024-07-10 10:52:18 pid 8310 | starting to iterate Train     2 (total=3), updating every 1 seconds
2024-07-10 10:52:20 pid 8310 | 0 of 3, 0.0% of Train     2, speed: -0.00 s/it, elapsed 0.80 seconds, [1;31mGPU RAM: 5.45 G/15.78 G loss: 3.52218[0m
2024-07-10 10:52:20 pid 8310 | finished Train     2. Total time: 0.80 seconds
INFO:root:[1;32mepoch 2 training[0m [[1;34mtime[0m: 2.52s, [1;34mtrain loss[0m: 2.9077]
2024-07-10 10:52:20 pid 8310 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:52:20 pid 8310 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.45 G/15.78 G[0m
2024-07-10 10:52:20 pid 8310 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.469377040863037)])
INFO:root:[1;32mepoch 2 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.469377040863037
2024-07-10 10:52:20 pid 8310 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3828), ('mrr@5', 0.2072), ('ndcg@5', 0.2511), ('hit@5', 0.3828), ('precision@5', 0.0766)])
2024-07-10 10:52:20 pid 8310 | starting to iterate Train     3 (total=3), updating every 1 seconds
2024-07-10 10:52:23 pid 8310 | 0 of 3, 0.0% of Train     3, speed: -0.00 s/it, elapsed 0.80 seconds, [1;31mGPU RAM: 5.45 G/15.78 G loss: 3.55520[0m
2024-07-10 10:52:23 pid 8310 | finished Train     3. Total time: 0.80 seconds
INFO:root:[1;32mepoch 3 training[0m [[1;34mtime[0m: 2.52s, [1;34mtrain loss[0m: 3.1558]
2024-07-10 10:52:23 pid 8310 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:52:23 pid 8310 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.45 G/15.78 G[0m
2024-07-10 10:52:23 pid 8310 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.452474594116211)])
INFO:root:[1;32mepoch 3 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.452474594116211
2024-07-10 10:52:23 pid 8310 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3906), ('mrr@5', 0.209), ('ndcg@5', 0.2544), ('hit@5', 0.3906), ('precision@5', 0.0781)])
2024-07-10 10:52:23 pid 8310 | starting to iterate Train     4 (total=3), updating every 1 seconds
2024-07-10 10:52:26 pid 8310 | 0 of 3, 0.0% of Train     4, speed: -0.00 s/it, elapsed 0.83 seconds, [1;31mGPU RAM: 5.45 G/15.78 G loss: 3.69225[0m
2024-07-10 10:52:26 pid 8310 | finished Train     4. Total time: 0.83 seconds
INFO:root:[1;32mepoch 4 training[0m [[1;34mtime[0m: 2.55s, [1;34mtrain loss[0m: 3.4280]
2024-07-10 10:52:26 pid 8310 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:52:26 pid 8310 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.45 G/15.78 G[0m
2024-07-10 10:52:26 pid 8310 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.480678558349609)])
INFO:root:[1;32mepoch 4 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.480678558349609
2024-07-10 10:52:26 pid 8310 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3906), ('mrr@5', 0.209), ('ndcg@5', 0.2544), ('hit@5', 0.3906), ('precision@5', 0.0781)])
2024-07-10 10:52:26 pid 8310 | starting to iterate Train     5 (total=3), updating every 1 seconds
2024-07-10 10:52:28 pid 8310 | 0 of 3, 0.0% of Train     5, speed: -0.00 s/it, elapsed 0.79 seconds, [1;31mGPU RAM: 5.45 G/15.78 G loss: 3.94048[0m
2024-07-10 10:52:28 pid 8310 | finished Train     5. Total time: 0.79 seconds
INFO:root:[1;32mepoch 5 training[0m [[1;34mtime[0m: 2.51s, [1;34mtrain loss[0m: 3.7327]
2024-07-10 10:52:29 pid 8310 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:52:29 pid 8310 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.45 G/15.78 G[0m
2024-07-10 10:52:29 pid 8310 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.539360046386719)])
INFO:root:[1;32mepoch 5 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.539360046386719
2024-07-10 10:52:29 pid 8310 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3906), ('mrr@5', 0.2103), ('ndcg@5', 0.2554), ('hit@5', 0.3906), ('precision@5', 0.0781)])
2024-07-10 10:52:29 pid 8310 | starting to iterate Train     6 (total=3), updating every 1 seconds
2024-07-10 10:52:31 pid 8310 | 0 of 3, 0.0% of Train     6, speed: -0.00 s/it, elapsed 0.80 seconds, [1;31mGPU RAM: 5.45 G/15.78 G loss: 4.22067[0m
2024-07-10 10:52:31 pid 8310 | finished Train     6. Total time: 0.80 seconds
INFO:root:[1;32mepoch 6 training[0m [[1;34mtime[0m: 2.53s, [1;34mtrain loss[0m: 3.9632]
2024-07-10 10:52:31 pid 8310 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:52:31 pid 8310 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.45 G/15.78 G[0m
2024-07-10 10:52:31 pid 8310 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.660683631896973)])
INFO:root:[1;32mepoch 6 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.660683631896973
2024-07-10 10:52:32 pid 8310 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3906), ('mrr@5', 0.2112), ('ndcg@5', 0.2561), ('hit@5', 0.3906), ('precision@5', 0.0781)])
2024-07-10 10:52:32 pid 8310 | starting to iterate Train     7 (total=3), updating every 1 seconds
2024-07-10 10:52:34 pid 8310 | 0 of 3, 0.0% of Train     7, speed: -0.00 s/it, elapsed 0.79 seconds, [1;31mGPU RAM: 5.45 G/15.78 G loss: 4.35344[0m
2024-07-10 10:52:34 pid 8310 | finished Train     7. Total time: 0.79 seconds
INFO:root:[1;32mepoch 7 training[0m [[1;34mtime[0m: 2.53s, [1;34mtrain loss[0m: 4.3058]
2024-07-10 10:52:34 pid 8310 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:52:34 pid 8310 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.45 G/15.78 G[0m
2024-07-10 10:52:34 pid 8310 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.5346150398254395)])
INFO:root:[1;32mepoch 7 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.5346150398254395
2024-07-10 10:52:34 pid 8310 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.3984), ('mrr@5', 0.2132), ('ndcg@5', 0.2594), ('hit@5', 0.3984), ('precision@5', 0.0797)])
2024-07-10 10:52:34 pid 8310 | starting to iterate Train     8 (total=3), updating every 1 seconds
2024-07-10 10:52:37 pid 8310 | 0 of 3, 0.0% of Train     8, speed: -0.00 s/it, elapsed 0.81 seconds, [1;31mGPU RAM: 5.45 G/15.78 G loss: 4.42831[0m
2024-07-10 10:52:37 pid 8310 | finished Train     8. Total time: 0.81 seconds
INFO:root:[1;32mepoch 8 training[0m [[1;34mtime[0m: 2.58s, [1;34mtrain loss[0m: 4.4823]
2024-07-10 10:52:37 pid 8310 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:52:37 pid 8310 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.45 G/15.78 G[0m
2024-07-10 10:52:37 pid 8310 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.603848934173584)])
INFO:root:[1;32mepoch 8 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.603848934173584
2024-07-10 10:52:37 pid 8310 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4297), ('mrr@5', 0.2224), ('ndcg@5', 0.274), ('hit@5', 0.4297), ('precision@5', 0.0859)])
2024-07-10 10:52:37 pid 8310 | starting to iterate Train     9 (total=3), updating every 1 seconds
2024-07-10 10:52:40 pid 8310 | 0 of 3, 0.0% of Train     9, speed: -0.00 s/it, elapsed 0.80 seconds, [1;31mGPU RAM: 5.45 G/15.78 G loss: 4.41385[0m
2024-07-10 10:52:40 pid 8310 | finished Train     9. Total time: 0.80 seconds
INFO:root:[1;32mepoch 9 training[0m [[1;34mtime[0m: 2.54s, [1;34mtrain loss[0m: 4.7387]
2024-07-10 10:52:40 pid 8310 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:52:40 pid 8310 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.45 G/15.78 G[0m
2024-07-10 10:52:40 pid 8310 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.533628940582275)])
INFO:root:[1;32mepoch 9 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.533628940582275
2024-07-10 10:52:40 pid 8310 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4375), ('mrr@5', 0.2251), ('ndcg@5', 0.278), ('hit@5', 0.4375), ('precision@5', 0.0875)])
Saving checkpoint on /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/14.pth
INFO:root:[1;34mSaving current[0m: /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/14.pth
2024-07-10 10:52:40 pid 8310 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:52:41 pid 8310 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.06 seconds, [1;33mGPU RAM: 5.45 G/15.78 G[0m
2024-07-10 10:52:41 pid 8310 | finished [1;35mEvaluate in test   [0m. Total time: 0.06 seconds
OrderedDict([('recall@5', 0.1622), ('mrr@5', 0.0628), ('ndcg@5', 0.0877), ('hit@5', 0.1622), ('precision@5', 0.0324), ('test_loss', 6.146234035491943)])
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
INFO:faiss.loader:Loading faiss.
INFO:faiss.loader:Successfully loaded faiss.
WARNING:root:command line args [-c confs/fine_tune/progressive.json -s amazon-beauty -l amazon-100K -i test.pth -p confs/pre_train/config_dict_100K.json -o fine_tuned_checkpoint.pth] will not be used in RecBole

[1;35mGeneral Hyper Parameters:
[0m[1;36mgpu_id[0m =[1;33m 0[0m
[1;36muse_gpu[0m =[1;33m True[0m
[1;36mseed[0m =[1;33m 2020[0m
[1;36mstate[0m =[1;33m INFO[0m
[1;36mreproducibility[0m =[1;33m True[0m
[1;36mdata_path[0m =[1;33m /alloc/data/srt/data/output/amazon-beauty[0m
[1;36mcheckpoint_dir[0m =[1;33m saved[0m
[1;36mshow_progress[0m =[1;33m True[0m
[1;36msave_dataset[0m =[1;33m False[0m
[1;36mdataset_save_path[0m =[1;33m None[0m
[1;36msave_dataloaders[0m =[1;33m False[0m
[1;36mdataloaders_save_path[0m =[1;33m None[0m
[1;36mlog_wandb[0m =[1;33m False[0m

[1;35mTraining Hyper Parameters:
[0m[1;36mepochs[0m =[1;33m 2[0m
[1;36mtrain_batch_size[0m =[1;33m 128[0m
[1;36mlearner[0m =[1;33m adam[0m
[1;36mlearning_rate[0m =[1;33m 0.0001[0m
[1;36mtrain_neg_sample_args[0m =[1;33m {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}[0m
[1;36meval_step[0m =[1;33m 1[0m
[1;36mstopping_step[0m =[1;33m 20[0m
[1;36mclip_grad_norm[0m =[1;33m None[0m
[1;36mweight_decay[0m =[1;33m 1e-05[0m
[1;36mloss_decimal_place[0m =[1;33m 4[0m

[1;35mEvaluation Hyper Parameters:
[0m[1;36meval_args[0m =[1;33m {'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}[0m
[1;36mrepeatable[0m =[1;33m True[0m
[1;36mmetrics[0m =[1;33m ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision'][0m
[1;36mtopk[0m =[1;33m [5][0m
[1;36mvalid_metric[0m =[1;33m mrr@5[0m
[1;36mvalid_metric_bigger[0m =[1;33m True[0m
[1;36meval_batch_size[0m =[1;33m 128[0m
[1;36mmetric_decimal_place[0m =[1;33m 4[0m

[1;35mDataset Hyper Parameters:
[0m[1;36mfield_separator[0m =[1;33m 	[0m
[1;36mseq_separator[0m =[1;33m  [0m
[1;36mUSER_ID_FIELD[0m =[1;33m user_id[0m
[1;36mITEM_ID_FIELD[0m =[1;33m item_id[0m
[1;36mRATING_FIELD[0m =[1;33m rating[0m
[1;36mTIME_FIELD[0m =[1;33m timestamp[0m
[1;36mseq_len[0m =[1;33m None[0m
[1;36mLABEL_FIELD[0m =[1;33m label[0m
[1;36mthreshold[0m =[1;33m None[0m
[1;36mNEG_PREFIX[0m =[1;33m neg_[0m
[1;36mload_col[0m =[1;33m {'inter': ['user_id', 'item_id', 'rating', 'timestamp'], 'item': ['item_id', 'title', 'brand']}[0m
[1;36munload_col[0m =[1;33m None[0m
[1;36munused_col[0m =[1;33m None[0m
[1;36madditional_feat_suffix[0m =[1;33m None[0m
[1;36mrm_dup_inter[0m =[1;33m None[0m
[1;36mval_interval[0m =[1;33m None[0m
[1;36mfilter_inter_by_user_or_item[0m =[1;33m True[0m
[1;36muser_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36mitem_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36malias_of_user_id[0m =[1;33m None[0m
[1;36malias_of_item_id[0m =[1;33m None[0m
[1;36malias_of_entity_id[0m =[1;33m None[0m
[1;36malias_of_relation_id[0m =[1;33m None[0m
[1;36mpreload_weight[0m =[1;33m None[0m
[1;36mnormalize_field[0m =[1;33m None[0m
[1;36mnormalize_all[0m =[1;33m None[0m
[1;36mITEM_LIST_LENGTH_FIELD[0m =[1;33m item_length[0m
[1;36mLIST_SUFFIX[0m =[1;33m _list[0m
[1;36mMAX_ITEM_LIST_LENGTH[0m =[1;33m 50[0m
[1;36mPOSITION_FIELD[0m =[1;33m position_id[0m
[1;36mHEAD_ENTITY_ID_FIELD[0m =[1;33m head_id[0m
[1;36mTAIL_ENTITY_ID_FIELD[0m =[1;33m tail_id[0m
[1;36mRELATION_ID_FIELD[0m =[1;33m relation_id[0m
[1;36mENTITY_ID_FIELD[0m =[1;33m entity_id[0m
[1;36mbenchmark_filename[0m =[1;33m None[0m

[1;35mOther Hyper Parameters: 
[0m[1;36mworker[0m = [1;33m0[0m
[1;36mwandb_project[0m = [1;33mrecbole[0m
[1;36mshuffle[0m = [1;33mTrue[0m
[1;36mrequire_pow[0m = [1;33mFalse[0m
[1;36menable_amp[0m = [1;33mFalse[0m
[1;36menable_scaler[0m = [1;33mFalse[0m
[1;36mtransform[0m = [1;33mNone[0m
[1;36mn_layers[0m = [1;33m16[0m
[1;36mn_heads[0m = [1;33m4[0m
[1;36mhidden_size[0m = [1;33m256[0m
[1;36minner_size[0m = [1;33m256[0m
[1;36mhidden_dropout_prob[0m = [1;33m0.5[0m
[1;36mattn_dropout_prob[0m = [1;33m0.5[0m
[1;36mhidden_act[0m = [1;33mgelu[0m
[1;36mlayer_norm_eps[0m = [1;33m1e-12[0m
[1;36minitializer_range[0m = [1;33m0.02[0m
[1;36mselected_features[0m = [1;33m['title', 'brand'][0m
[1;36mpooling_mode[0m = [1;33msum[0m
[1;36mloss_type[0m = [1;33mInfoNCE-quick[0m
[1;36mnumerical_features[0m = [1;33m[][0m
[1;36mdiscretization[0m = [1;33mNone[0m
[1;36mkg_reverse_r[0m = [1;33mFalse[0m
[1;36mentity_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mrelation_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mMODEL_TYPE[0m = [1;33mModelType.SEQUENTIAL[0m
[1;36mmlflow[0m = [1;33m{'enable': True, 'experiment_name': 'fine-tune', 'run_name': '0f5d1302-97f4-4127-9cee-a6a702a5625b', 'tracking_uri': 'sqlite:///mlruns.sqlite', 'auto_continue': True}[0m
[1;36mmax_grad_norm[0m = [1;33m1.0[0m
[1;36mscheduler[0m = [1;33m{'type': 'one-cycle'}[0m
[1;36mnce_temperature[0m = [1;33m1[0m
[1;36mnce_label_smoothing[0m = [1;33m0.0[0m
[1;36mnormalize_embedding[0m = [1;33mFalse[0m
[1;36mevaluation_mode[0m = [1;33msampled50000[0m
[1;36mestimate_batch_size[0m = [1;33mFalse[0m
[1;36mnce_num_negatives[0m = [1;33m300[0m
[1;36mnce_sampling_strategy[0m = [1;33mpopularity[0m
[1;36mnce_global_negatives[0m = [1;33mFalse[0m
[1;36mgradient_accumulation_steps[0m = [1;33m10[0m
[1;36meval_type[0m = [1;33mEvaluatorType.RANKING[0m
[1;36msingle_spec[0m = [1;33mTrue[0m
[1;36mlocal_rank[0m = [1;33m0[0m
[1;36mdevice[0m = [1;33mcuda[0m
[1;36mvalid_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m
[1;36mtest_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m


INFO:root:[1;35m[Training]: [0m[1;36mtrain_batch_size[0m = [1;33m[128][0m[1;36m train_neg_sample_args[0m: [1;33m[{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}][0m
INFO:root:[1;35m[Evaluation]: [0m[1;36meval_batch_size[0m = [1;33m[128][0m[1;36m eval_args[0m: [1;33m[{'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}][0m
item features
The batch_size of interaction: 504
    item_id, torch.Size([504]), cuda, torch.int64
    title, torch.Size([504, 40]), cuda, torch.int64
    brand, torch.Size([504, 7]), cuda, torch.int64


example
['‚ñÅcra' 'bt' 'ree' '‚ñÅamp' '‚ñÅevelyn' '‚ñÅgardener' '‚ñÅs' '‚ñÅultra' '‚ñÅmoistur'
 'ising' '‚ñÅhand' '‚ñÅtherapy' '‚ñÅpump' '‚ñÅ250' 'g' '‚ñÅ8' '‚ñÅ8' '‚ñÅoz' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]']
INFO:alembic.runtime.migration:Context impl SQLiteImpl.
INFO:alembic.runtime.migration:Will assume non-transactional DDL.
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 6477056 but failed
tried to log param model_non_emb_params with value -4778240 but failed
tried to log param unfreeze_n_layers with value 15 but failed
Evaluation sanity
****************************************
2024-07-10 10:52:44 pid 8323 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:52:45 pid 8323 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.59 seconds, [1;33mGPU RAM: 2.36 G/15.78 G[0m
2024-07-10 10:52:45 pid 8323 | finished [1;35mEvaluate in test   [0m. Total time: 0.59 seconds
OrderedDict([('recall@5', 0.1622), ('mrr@5', 0.0628), ('ndcg@5', 0.0877), ('hit@5', 0.1622), ('precision@5', 0.0324), ('test_loss', 6.228250980377197)])
****************************************
Freezing embeddings
Freezing layer 0
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 6068480 but failed
tried to log param model_non_emb_params with value -5186816 but failed
2024-07-10 10:52:45 pid 8323 | starting to iterate Train     0 (total=3), updating every 1 seconds
2024-07-10 10:52:48 pid 8323 | 0 of 3, 0.0% of Train     0, speed: -0.00 s/it, elapsed 0.83 seconds, [1;31mGPU RAM: 5.47 G/15.78 G loss: 3.86215[0m
2024-07-10 10:52:48 pid 8323 | finished Train     0. Total time: 0.83 seconds
INFO:root:[1;32mepoch 0 training[0m [[1;34mtime[0m: 2.70s, [1;34mtrain loss[0m: 3.1105]
2024-07-10 10:52:48 pid 8323 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:52:48 pid 8323 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.47 G/15.78 G[0m
2024-07-10 10:52:48 pid 8323 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.520054340362549)])
INFO:root:[1;32mepoch 0 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.520054340362549
2024-07-10 10:52:48 pid 8323 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4375), ('mrr@5', 0.2251), ('ndcg@5', 0.278), ('hit@5', 0.4375), ('precision@5', 0.0875)])
2024-07-10 10:52:48 pid 8323 | starting to iterate Train     1 (total=3), updating every 1 seconds
2024-07-10 10:52:51 pid 8323 | 0 of 3, 0.0% of Train     1, speed: -0.00 s/it, elapsed 0.85 seconds, [1;31mGPU RAM: 5.47 G/15.78 G loss: 3.67101[0m
2024-07-10 10:52:51 pid 8323 | finished Train     1. Total time: 0.85 seconds
INFO:root:[1;32mepoch 1 training[0m [[1;34mtime[0m: 2.65s, [1;34mtrain loss[0m: 2.7846]
2024-07-10 10:52:51 pid 8323 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:52:51 pid 8323 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.47 G/15.78 G[0m
2024-07-10 10:52:51 pid 8323 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.449314117431641)])
INFO:root:[1;32mepoch 1 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.449314117431641
2024-07-10 10:52:51 pid 8323 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4375), ('mrr@5', 0.2251), ('ndcg@5', 0.278), ('hit@5', 0.4375), ('precision@5', 0.0875)])
2024-07-10 10:52:51 pid 8323 | starting to iterate Train     2 (total=3), updating every 1 seconds
2024-07-10 10:52:54 pid 8323 | 0 of 3, 0.0% of Train     2, speed: -0.00 s/it, elapsed 0.82 seconds, [1;31mGPU RAM: 5.47 G/15.78 G loss: 3.25392[0m
2024-07-10 10:52:54 pid 8323 | finished Train     2. Total time: 0.82 seconds
INFO:root:[1;32mepoch 2 training[0m [[1;34mtime[0m: 2.61s, [1;34mtrain loss[0m: 2.6419]
2024-07-10 10:52:54 pid 8323 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:52:54 pid 8323 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.47 G/15.78 G[0m
2024-07-10 10:52:54 pid 8323 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.4999542236328125)])
INFO:root:[1;32mepoch 2 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.4999542236328125
2024-07-10 10:52:54 pid 8323 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4375), ('mrr@5', 0.2293), ('ndcg@5', 0.281), ('hit@5', 0.4375), ('precision@5', 0.0875)])
2024-07-10 10:52:54 pid 8323 | starting to iterate Train     3 (total=3), updating every 1 seconds
2024-07-10 10:52:57 pid 8323 | 0 of 3, 0.0% of Train     3, speed: -0.00 s/it, elapsed 0.83 seconds, [1;31mGPU RAM: 5.47 G/15.78 G loss: 3.27538[0m
2024-07-10 10:52:57 pid 8323 | finished Train     3. Total time: 0.83 seconds
INFO:root:[1;32mepoch 3 training[0m [[1;34mtime[0m: 2.65s, [1;34mtrain loss[0m: 2.8882]
2024-07-10 10:52:57 pid 8323 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:52:57 pid 8323 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.47 G/15.78 G[0m
2024-07-10 10:52:57 pid 8323 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.486675262451172)])
INFO:root:[1;32mepoch 3 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.486675262451172
2024-07-10 10:52:57 pid 8323 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4375), ('mrr@5', 0.2388), ('ndcg@5', 0.2882), ('hit@5', 0.4375), ('precision@5', 0.0875)])
2024-07-10 10:52:57 pid 8323 | starting to iterate Train     4 (total=3), updating every 1 seconds
2024-07-10 10:52:59 pid 8323 | 0 of 3, 0.0% of Train     4, speed: -0.00 s/it, elapsed 0.82 seconds, [1;31mGPU RAM: 5.47 G/15.78 G loss: 3.43224[0m
2024-07-10 10:52:59 pid 8323 | finished Train     4. Total time: 0.82 seconds
INFO:root:[1;32mepoch 4 training[0m [[1;34mtime[0m: 2.61s, [1;34mtrain loss[0m: 3.1609]
2024-07-10 10:53:00 pid 8323 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:53:00 pid 8323 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.47 G/15.78 G[0m
2024-07-10 10:53:00 pid 8323 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.529208660125732)])
INFO:root:[1;32mepoch 4 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.529208660125732
2024-07-10 10:53:00 pid 8323 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4375), ('mrr@5', 0.2388), ('ndcg@5', 0.2882), ('hit@5', 0.4375), ('precision@5', 0.0875)])
2024-07-10 10:53:00 pid 8323 | starting to iterate Train     5 (total=3), updating every 1 seconds
2024-07-10 10:53:02 pid 8323 | 0 of 3, 0.0% of Train     5, speed: -0.00 s/it, elapsed 0.83 seconds, [1;31mGPU RAM: 5.47 G/15.78 G loss: 3.70801[0m
2024-07-10 10:53:02 pid 8323 | finished Train     5. Total time: 0.83 seconds
INFO:root:[1;32mepoch 5 training[0m [[1;34mtime[0m: 2.62s, [1;34mtrain loss[0m: 3.4894]
2024-07-10 10:53:02 pid 8323 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:53:03 pid 8323 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.47 G/15.78 G[0m
2024-07-10 10:53:03 pid 8323 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.573838233947754)])
INFO:root:[1;32mepoch 5 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.573838233947754
2024-07-10 10:53:03 pid 8323 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4375), ('mrr@5', 0.2382), ('ndcg@5', 0.2877), ('hit@5', 0.4375), ('precision@5', 0.0875)])
2024-07-10 10:53:03 pid 8323 | starting to iterate Train     6 (total=3), updating every 1 seconds
2024-07-10 10:53:05 pid 8323 | 0 of 3, 0.0% of Train     6, speed: -0.00 s/it, elapsed 0.83 seconds, [1;31mGPU RAM: 5.47 G/15.78 G loss: 4.03108[0m
2024-07-10 10:53:05 pid 8323 | finished Train     6. Total time: 0.83 seconds
INFO:root:[1;32mepoch 6 training[0m [[1;34mtime[0m: 2.62s, [1;34mtrain loss[0m: 3.7631]
2024-07-10 10:53:05 pid 8323 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:53:05 pid 8323 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.47 G/15.78 G[0m
2024-07-10 10:53:05 pid 8323 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.7166852951049805)])
INFO:root:[1;32mepoch 6 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.7166852951049805
2024-07-10 10:53:05 pid 8323 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4375), ('mrr@5', 0.2401), ('ndcg@5', 0.2893), ('hit@5', 0.4375), ('precision@5', 0.0875)])
2024-07-10 10:53:06 pid 8323 | starting to iterate Train     7 (total=3), updating every 1 seconds
2024-07-10 10:53:08 pid 8323 | 0 of 3, 0.0% of Train     7, speed: -0.00 s/it, elapsed 0.84 seconds, [1;31mGPU RAM: 5.47 G/15.78 G loss: 4.19537[0m
2024-07-10 10:53:08 pid 8323 | finished Train     7. Total time: 0.84 seconds
INFO:root:[1;32mepoch 7 training[0m [[1;34mtime[0m: 2.68s, [1;34mtrain loss[0m: 4.1404]
2024-07-10 10:53:08 pid 8323 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:53:08 pid 8323 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.47 G/15.78 G[0m
2024-07-10 10:53:08 pid 8323 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.581578254699707)])
INFO:root:[1;32mepoch 7 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.581578254699707
2024-07-10 10:53:08 pid 8323 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4375), ('mrr@5', 0.2418), ('ndcg@5', 0.2906), ('hit@5', 0.4375), ('precision@5', 0.0875)])
2024-07-10 10:53:09 pid 8323 | starting to iterate Train     8 (total=3), updating every 1 seconds
2024-07-10 10:53:11 pid 8323 | 0 of 3, 0.0% of Train     8, speed: -0.00 s/it, elapsed 0.83 seconds, [1;31mGPU RAM: 5.47 G/15.78 G loss: 4.29887[0m
2024-07-10 10:53:11 pid 8323 | finished Train     8. Total time: 0.83 seconds
INFO:root:[1;32mepoch 8 training[0m [[1;34mtime[0m: 2.66s, [1;34mtrain loss[0m: 4.3592]
2024-07-10 10:53:11 pid 8323 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:53:11 pid 8323 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.47 G/15.78 G[0m
2024-07-10 10:53:11 pid 8323 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.6454243659973145)])
INFO:root:[1;32mepoch 8 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.6454243659973145
2024-07-10 10:53:11 pid 8323 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4375), ('mrr@5', 0.2441), ('ndcg@5', 0.2925), ('hit@5', 0.4375), ('precision@5', 0.0875)])
2024-07-10 10:53:12 pid 8323 | starting to iterate Train     9 (total=3), updating every 1 seconds
2024-07-10 10:53:14 pid 8323 | 0 of 3, 0.0% of Train     9, speed: -0.00 s/it, elapsed 0.85 seconds, [1;31mGPU RAM: 5.47 G/15.78 G loss: 4.30826[0m
2024-07-10 10:53:14 pid 8323 | finished Train     9. Total time: 0.85 seconds
INFO:root:[1;32mepoch 9 training[0m [[1;34mtime[0m: 2.64s, [1;34mtrain loss[0m: 4.6288]
2024-07-10 10:53:14 pid 8323 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:53:14 pid 8323 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.47 G/15.78 G[0m
2024-07-10 10:53:14 pid 8323 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.5895843505859375)])
INFO:root:[1;32mepoch 9 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.5895843505859375
2024-07-10 10:53:14 pid 8323 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4375), ('mrr@5', 0.252), ('ndcg@5', 0.2983), ('hit@5', 0.4375), ('precision@5', 0.0875)])
Saving checkpoint on /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/15.pth
INFO:root:[1;34mSaving current[0m: /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/15.pth
2024-07-10 10:53:15 pid 8323 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:53:15 pid 8323 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.47 G/15.78 G[0m
2024-07-10 10:53:15 pid 8323 | finished [1;35mEvaluate in test   [0m. Total time: 0.05 seconds
OrderedDict([('recall@5', 0.1622), ('mrr@5', 0.0628), ('ndcg@5', 0.0877), ('hit@5', 0.1622), ('precision@5', 0.0324), ('test_loss', 6.164614200592041)])
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
INFO:faiss.loader:Loading faiss.
INFO:faiss.loader:Successfully loaded faiss.
WARNING:root:command line args [-c confs/fine_tune/progressive.json -s amazon-beauty -l amazon-100K -i test.pth -p confs/pre_train/config_dict_100K.json -o fine_tuned_checkpoint.pth] will not be used in RecBole

[1;35mGeneral Hyper Parameters:
[0m[1;36mgpu_id[0m =[1;33m 0[0m
[1;36muse_gpu[0m =[1;33m True[0m
[1;36mseed[0m =[1;33m 2020[0m
[1;36mstate[0m =[1;33m INFO[0m
[1;36mreproducibility[0m =[1;33m True[0m
[1;36mdata_path[0m =[1;33m /alloc/data/srt/data/output/amazon-beauty[0m
[1;36mcheckpoint_dir[0m =[1;33m saved[0m
[1;36mshow_progress[0m =[1;33m True[0m
[1;36msave_dataset[0m =[1;33m False[0m
[1;36mdataset_save_path[0m =[1;33m None[0m
[1;36msave_dataloaders[0m =[1;33m False[0m
[1;36mdataloaders_save_path[0m =[1;33m None[0m
[1;36mlog_wandb[0m =[1;33m False[0m

[1;35mTraining Hyper Parameters:
[0m[1;36mepochs[0m =[1;33m 2[0m
[1;36mtrain_batch_size[0m =[1;33m 128[0m
[1;36mlearner[0m =[1;33m adam[0m
[1;36mlearning_rate[0m =[1;33m 0.0001[0m
[1;36mtrain_neg_sample_args[0m =[1;33m {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}[0m
[1;36meval_step[0m =[1;33m 1[0m
[1;36mstopping_step[0m =[1;33m 20[0m
[1;36mclip_grad_norm[0m =[1;33m None[0m
[1;36mweight_decay[0m =[1;33m 1e-05[0m
[1;36mloss_decimal_place[0m =[1;33m 4[0m

[1;35mEvaluation Hyper Parameters:
[0m[1;36meval_args[0m =[1;33m {'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}[0m
[1;36mrepeatable[0m =[1;33m True[0m
[1;36mmetrics[0m =[1;33m ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision'][0m
[1;36mtopk[0m =[1;33m [5][0m
[1;36mvalid_metric[0m =[1;33m mrr@5[0m
[1;36mvalid_metric_bigger[0m =[1;33m True[0m
[1;36meval_batch_size[0m =[1;33m 128[0m
[1;36mmetric_decimal_place[0m =[1;33m 4[0m

[1;35mDataset Hyper Parameters:
[0m[1;36mfield_separator[0m =[1;33m 	[0m
[1;36mseq_separator[0m =[1;33m  [0m
[1;36mUSER_ID_FIELD[0m =[1;33m user_id[0m
[1;36mITEM_ID_FIELD[0m =[1;33m item_id[0m
[1;36mRATING_FIELD[0m =[1;33m rating[0m
[1;36mTIME_FIELD[0m =[1;33m timestamp[0m
[1;36mseq_len[0m =[1;33m None[0m
[1;36mLABEL_FIELD[0m =[1;33m label[0m
[1;36mthreshold[0m =[1;33m None[0m
[1;36mNEG_PREFIX[0m =[1;33m neg_[0m
[1;36mload_col[0m =[1;33m {'inter': ['user_id', 'item_id', 'rating', 'timestamp'], 'item': ['item_id', 'title', 'brand']}[0m
[1;36munload_col[0m =[1;33m None[0m
[1;36munused_col[0m =[1;33m None[0m
[1;36madditional_feat_suffix[0m =[1;33m None[0m
[1;36mrm_dup_inter[0m =[1;33m None[0m
[1;36mval_interval[0m =[1;33m None[0m
[1;36mfilter_inter_by_user_or_item[0m =[1;33m True[0m
[1;36muser_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36mitem_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36malias_of_user_id[0m =[1;33m None[0m
[1;36malias_of_item_id[0m =[1;33m None[0m
[1;36malias_of_entity_id[0m =[1;33m None[0m
[1;36malias_of_relation_id[0m =[1;33m None[0m
[1;36mpreload_weight[0m =[1;33m None[0m
[1;36mnormalize_field[0m =[1;33m None[0m
[1;36mnormalize_all[0m =[1;33m None[0m
[1;36mITEM_LIST_LENGTH_FIELD[0m =[1;33m item_length[0m
[1;36mLIST_SUFFIX[0m =[1;33m _list[0m
[1;36mMAX_ITEM_LIST_LENGTH[0m =[1;33m 50[0m
[1;36mPOSITION_FIELD[0m =[1;33m position_id[0m
[1;36mHEAD_ENTITY_ID_FIELD[0m =[1;33m head_id[0m
[1;36mTAIL_ENTITY_ID_FIELD[0m =[1;33m tail_id[0m
[1;36mRELATION_ID_FIELD[0m =[1;33m relation_id[0m
[1;36mENTITY_ID_FIELD[0m =[1;33m entity_id[0m
[1;36mbenchmark_filename[0m =[1;33m None[0m

[1;35mOther Hyper Parameters: 
[0m[1;36mworker[0m = [1;33m0[0m
[1;36mwandb_project[0m = [1;33mrecbole[0m
[1;36mshuffle[0m = [1;33mTrue[0m
[1;36mrequire_pow[0m = [1;33mFalse[0m
[1;36menable_amp[0m = [1;33mFalse[0m
[1;36menable_scaler[0m = [1;33mFalse[0m
[1;36mtransform[0m = [1;33mNone[0m
[1;36mn_layers[0m = [1;33m16[0m
[1;36mn_heads[0m = [1;33m4[0m
[1;36mhidden_size[0m = [1;33m256[0m
[1;36minner_size[0m = [1;33m256[0m
[1;36mhidden_dropout_prob[0m = [1;33m0.5[0m
[1;36mattn_dropout_prob[0m = [1;33m0.5[0m
[1;36mhidden_act[0m = [1;33mgelu[0m
[1;36mlayer_norm_eps[0m = [1;33m1e-12[0m
[1;36minitializer_range[0m = [1;33m0.02[0m
[1;36mselected_features[0m = [1;33m['title', 'brand'][0m
[1;36mpooling_mode[0m = [1;33msum[0m
[1;36mloss_type[0m = [1;33mInfoNCE-quick[0m
[1;36mnumerical_features[0m = [1;33m[][0m
[1;36mdiscretization[0m = [1;33mNone[0m
[1;36mkg_reverse_r[0m = [1;33mFalse[0m
[1;36mentity_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mrelation_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mMODEL_TYPE[0m = [1;33mModelType.SEQUENTIAL[0m
[1;36mmlflow[0m = [1;33m{'enable': True, 'experiment_name': 'fine-tune', 'run_name': '0f5d1302-97f4-4127-9cee-a6a702a5625b', 'tracking_uri': 'sqlite:///mlruns.sqlite', 'auto_continue': True}[0m
[1;36mmax_grad_norm[0m = [1;33m1.0[0m
[1;36mscheduler[0m = [1;33m{'type': 'one-cycle'}[0m
[1;36mnce_temperature[0m = [1;33m1[0m
[1;36mnce_label_smoothing[0m = [1;33m0.0[0m
[1;36mnormalize_embedding[0m = [1;33mFalse[0m
[1;36mevaluation_mode[0m = [1;33msampled50000[0m
[1;36mestimate_batch_size[0m = [1;33mFalse[0m
[1;36mnce_num_negatives[0m = [1;33m300[0m
[1;36mnce_sampling_strategy[0m = [1;33mpopularity[0m
[1;36mnce_global_negatives[0m = [1;33mFalse[0m
[1;36mgradient_accumulation_steps[0m = [1;33m10[0m
[1;36meval_type[0m = [1;33mEvaluatorType.RANKING[0m
[1;36msingle_spec[0m = [1;33mTrue[0m
[1;36mlocal_rank[0m = [1;33m0[0m
[1;36mdevice[0m = [1;33mcuda[0m
[1;36mvalid_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m
[1;36mtest_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m


INFO:root:[1;35m[Training]: [0m[1;36mtrain_batch_size[0m = [1;33m[128][0m[1;36m train_neg_sample_args[0m: [1;33m[{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}][0m
INFO:root:[1;35m[Evaluation]: [0m[1;36meval_batch_size[0m = [1;33m[128][0m[1;36m eval_args[0m: [1;33m[{'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}][0m
item features
The batch_size of interaction: 504
    item_id, torch.Size([504]), cuda, torch.int64
    title, torch.Size([504, 40]), cuda, torch.int64
    brand, torch.Size([504, 7]), cuda, torch.int64


example
['‚ñÅcra' 'bt' 'ree' '‚ñÅamp' '‚ñÅevelyn' '‚ñÅgardener' '‚ñÅs' '‚ñÅultra' '‚ñÅmoistur'
 'ising' '‚ñÅhand' '‚ñÅtherapy' '‚ñÅpump' '‚ñÅ250' 'g' '‚ñÅ8' '‚ñÅ8' '‚ñÅoz' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]']
INFO:alembic.runtime.migration:Context impl SQLiteImpl.
INFO:alembic.runtime.migration:Will assume non-transactional DDL.
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 6477056 but failed
tried to log param model_non_emb_params with value -4778240 but failed
tried to log param unfreeze_n_layers with value 16 but failed
Evaluation sanity
****************************************
2024-07-10 10:53:19 pid 8336 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:53:19 pid 8336 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.59 seconds, [1;33mGPU RAM: 2.37 G/15.78 G[0m
2024-07-10 10:53:19 pid 8336 | finished [1;35mEvaluate in test   [0m. Total time: 0.59 seconds
OrderedDict([('recall@5', 0.1622), ('mrr@5', 0.0628), ('ndcg@5', 0.0877), ('hit@5', 0.1622), ('precision@5', 0.0324), ('test_loss', 6.252571105957031)])
****************************************
Freezing embeddings
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 6464256 but failed
tried to log param model_non_emb_params with value -4791040 but failed
2024-07-10 10:53:19 pid 8336 | starting to iterate Train     0 (total=3), updating every 1 seconds
2024-07-10 10:53:22 pid 8336 | 0 of 3, 0.0% of Train     0, speed: -0.00 s/it, elapsed 0.86 seconds, [1;31mGPU RAM: 5.48 G/15.78 G loss: 3.62926[0m
2024-07-10 10:53:22 pid 8336 | finished Train     0. Total time: 0.86 seconds
INFO:root:[1;32mepoch 0 training[0m [[1;34mtime[0m: 2.78s, [1;34mtrain loss[0m: 2.8619]
2024-07-10 10:53:22 pid 8336 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:53:22 pid 8336 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.48 G/15.78 G[0m
2024-07-10 10:53:22 pid 8336 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.5690226554870605)])
INFO:root:[1;32mepoch 0 evaluating[0m [[1;34mtime[0m: 0.15s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.5690226554870605
2024-07-10 10:53:22 pid 8336 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4375), ('mrr@5', 0.248), ('ndcg@5', 0.2954), ('hit@5', 0.4375), ('precision@5', 0.0875)])
2024-07-10 10:53:23 pid 8336 | starting to iterate Train     1 (total=3), updating every 1 seconds
2024-07-10 10:53:25 pid 8336 | 0 of 3, 0.0% of Train     1, speed: -0.00 s/it, elapsed 0.86 seconds, [1;31mGPU RAM: 5.48 G/15.78 G loss: 3.39637[0m
2024-07-10 10:53:25 pid 8336 | finished Train     1. Total time: 0.86 seconds
INFO:root:[1;32mepoch 1 training[0m [[1;34mtime[0m: 2.73s, [1;34mtrain loss[0m: 2.5364]
2024-07-10 10:53:25 pid 8336 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:53:25 pid 8336 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.48 G/15.78 G[0m
2024-07-10 10:53:25 pid 8336 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.48732328414917)])
INFO:root:[1;32mepoch 1 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.48732328414917
2024-07-10 10:53:25 pid 8336 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4453), ('mrr@5', 0.2496), ('ndcg@5', 0.2984), ('hit@5', 0.4453), ('precision@5', 0.0891)])
2024-07-10 10:53:26 pid 8336 | starting to iterate Train     2 (total=3), updating every 1 seconds
2024-07-10 10:53:28 pid 8336 | 0 of 3, 0.0% of Train     2, speed: -0.00 s/it, elapsed 0.85 seconds, [1;31mGPU RAM: 5.48 G/15.78 G loss: 2.98253[0m
2024-07-10 10:53:28 pid 8336 | finished Train     2. Total time: 0.85 seconds
INFO:root:[1;32mepoch 2 training[0m [[1;34mtime[0m: 2.72s, [1;34mtrain loss[0m: 2.3853]
2024-07-10 10:53:28 pid 8336 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:53:28 pid 8336 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.48 G/15.78 G[0m
2024-07-10 10:53:28 pid 8336 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.535139083862305)])
INFO:root:[1;32mepoch 2 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.535139083862305
2024-07-10 10:53:28 pid 8336 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4531), ('mrr@5', 0.2555), ('ndcg@5', 0.3047), ('hit@5', 0.4531), ('precision@5', 0.0906)])
2024-07-10 10:53:29 pid 8336 | starting to iterate Train     3 (total=3), updating every 1 seconds
2024-07-10 10:53:31 pid 8336 | 0 of 3, 0.0% of Train     3, speed: -0.00 s/it, elapsed 0.86 seconds, [1;31mGPU RAM: 5.48 G/15.78 G loss: 2.98790[0m
2024-07-10 10:53:31 pid 8336 | finished Train     3. Total time: 0.86 seconds
INFO:root:[1;32mepoch 3 training[0m [[1;34mtime[0m: 2.72s, [1;34mtrain loss[0m: 2.6240]
2024-07-10 10:53:31 pid 8336 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:53:31 pid 8336 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.48 G/15.78 G[0m
2024-07-10 10:53:31 pid 8336 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.525211334228516)])
INFO:root:[1;32mepoch 3 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.525211334228516
2024-07-10 10:53:31 pid 8336 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4688), ('mrr@5', 0.2549), ('ndcg@5', 0.308), ('hit@5', 0.4688), ('precision@5', 0.0937)])
2024-07-10 10:53:32 pid 8336 | starting to iterate Train     4 (total=3), updating every 1 seconds
2024-07-10 10:53:34 pid 8336 | 0 of 3, 0.0% of Train     4, speed: -0.00 s/it, elapsed 0.86 seconds, [1;31mGPU RAM: 5.48 G/15.78 G loss: 3.16383[0m
2024-07-10 10:53:34 pid 8336 | finished Train     4. Total time: 0.86 seconds
INFO:root:[1;32mepoch 4 training[0m [[1;34mtime[0m: 2.72s, [1;34mtrain loss[0m: 2.8973]
2024-07-10 10:53:34 pid 8336 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:53:34 pid 8336 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.48 G/15.78 G[0m
2024-07-10 10:53:34 pid 8336 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.582859516143799)])
INFO:root:[1;32mepoch 4 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.582859516143799
2024-07-10 10:53:34 pid 8336 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4609), ('mrr@5', 0.2538), ('ndcg@5', 0.3054), ('hit@5', 0.4609), ('precision@5', 0.0922)])
2024-07-10 10:53:35 pid 8336 | starting to iterate Train     5 (total=3), updating every 1 seconds
2024-07-10 10:53:37 pid 8336 | 0 of 3, 0.0% of Train     5, speed: -0.00 s/it, elapsed 0.88 seconds, [1;31mGPU RAM: 5.48 G/15.78 G loss: 3.46469[0m
2024-07-10 10:53:37 pid 8336 | finished Train     5. Total time: 0.88 seconds
INFO:root:[1;32mepoch 5 training[0m [[1;34mtime[0m: 2.76s, [1;34mtrain loss[0m: 3.2424]
2024-07-10 10:53:37 pid 8336 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:53:37 pid 8336 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.48 G/15.78 G[0m
2024-07-10 10:53:37 pid 8336 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.609184741973877)])
INFO:root:[1;32mepoch 5 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.609184741973877
2024-07-10 10:53:38 pid 8336 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4609), ('mrr@5', 0.2555), ('ndcg@5', 0.3067), ('hit@5', 0.4609), ('precision@5', 0.0922)])
2024-07-10 10:53:38 pid 8336 | starting to iterate Train     6 (total=3), updating every 1 seconds
2024-07-10 10:53:40 pid 8336 | 0 of 3, 0.0% of Train     6, speed: -0.00 s/it, elapsed 0.86 seconds, [1;31mGPU RAM: 5.48 G/15.78 G loss: 3.83089[0m
2024-07-10 10:53:40 pid 8336 | finished Train     6. Total time: 0.86 seconds
INFO:root:[1;32mepoch 6 training[0m [[1;34mtime[0m: 2.73s, [1;34mtrain loss[0m: 3.5603]
2024-07-10 10:53:40 pid 8336 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:53:40 pid 8336 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.48 G/15.78 G[0m
2024-07-10 10:53:40 pid 8336 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.776572227478027)])
INFO:root:[1;32mepoch 6 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.776572227478027
2024-07-10 10:53:41 pid 8336 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4688), ('mrr@5', 0.259), ('ndcg@5', 0.3113), ('hit@5', 0.4688), ('precision@5', 0.0937)])
2024-07-10 10:53:41 pid 8336 | starting to iterate Train     7 (total=3), updating every 1 seconds
2024-07-10 10:53:43 pid 8336 | 0 of 3, 0.0% of Train     7, speed: -0.00 s/it, elapsed 0.85 seconds, [1;31mGPU RAM: 5.48 G/15.78 G loss: 4.03267[0m
2024-07-10 10:53:43 pid 8336 | finished Train     7. Total time: 0.85 seconds
INFO:root:[1;32mepoch 7 training[0m [[1;34mtime[0m: 2.70s, [1;34mtrain loss[0m: 3.9720]
2024-07-10 10:53:43 pid 8336 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:53:43 pid 8336 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.48 G/15.78 G[0m
2024-07-10 10:53:43 pid 8336 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.628758430480957)])
INFO:root:[1;32mepoch 7 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.628758430480957
2024-07-10 10:53:44 pid 8336 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4609), ('mrr@5', 0.2626), ('ndcg@5', 0.3122), ('hit@5', 0.4609), ('precision@5', 0.0922)])
2024-07-10 10:53:44 pid 8336 | starting to iterate Train     8 (total=3), updating every 1 seconds
2024-07-10 10:53:46 pid 8336 | 0 of 3, 0.0% of Train     8, speed: -0.00 s/it, elapsed 0.85 seconds, [1;31mGPU RAM: 5.48 G/15.78 G loss: 4.16721[0m
2024-07-10 10:53:46 pid 8336 | finished Train     8. Total time: 0.85 seconds
INFO:root:[1;32mepoch 8 training[0m [[1;34mtime[0m: 2.70s, [1;34mtrain loss[0m: 4.2367]
2024-07-10 10:53:46 pid 8336 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:53:46 pid 8336 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.48 G/15.78 G[0m
2024-07-10 10:53:46 pid 8336 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.691884517669678)])
INFO:root:[1;32mepoch 8 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.691884517669678
2024-07-10 10:53:47 pid 8336 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4609), ('mrr@5', 0.2715), ('ndcg@5', 0.3189), ('hit@5', 0.4609), ('precision@5', 0.0922)])
2024-07-10 10:53:47 pid 8336 | starting to iterate Train     9 (total=3), updating every 1 seconds
2024-07-10 10:53:49 pid 8336 | 0 of 3, 0.0% of Train     9, speed: -0.00 s/it, elapsed 0.85 seconds, [1;31mGPU RAM: 5.48 G/15.78 G loss: 4.20632[0m
2024-07-10 10:53:49 pid 8336 | finished Train     9. Total time: 0.85 seconds
INFO:root:[1;32mepoch 9 training[0m [[1;34mtime[0m: 2.71s, [1;34mtrain loss[0m: 4.5222]
2024-07-10 10:53:49 pid 8336 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:53:49 pid 8336 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.48 G/15.78 G[0m
2024-07-10 10:53:49 pid 8336 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.652445316314697)])
INFO:root:[1;32mepoch 9 evaluating[0m [[1;34mtime[0m: 0.15s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.652445316314697
2024-07-10 10:53:50 pid 8336 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4688), ('mrr@5', 0.2743), ('ndcg@5', 0.323), ('hit@5', 0.4688), ('precision@5', 0.0937)])
Saving checkpoint on /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/16.pth
INFO:root:[1;34mSaving current[0m: /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/checkpoints/16.pth
2024-07-10 10:53:50 pid 8336 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:53:50 pid 8336 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.48 G/15.78 G[0m
2024-07-10 10:53:50 pid 8336 | finished [1;35mEvaluate in test   [0m. Total time: 0.05 seconds
OrderedDict([('recall@5', 0.1622), ('mrr@5', 0.0646), ('ndcg@5', 0.0892), ('hit@5', 0.1622), ('precision@5', 0.0324), ('test_loss', 6.1875715255737305)])
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
INFO:faiss.loader:Loading faiss.
INFO:faiss.loader:Successfully loaded faiss.
WARNING:root:command line args [-c confs/fine_tune/progressive.json -s amazon-beauty -l amazon-100K -i test.pth -p confs/pre_train/config_dict_100K.json -o fine_tuned_checkpoint.pth] will not be used in RecBole

[1;35mGeneral Hyper Parameters:
[0m[1;36mgpu_id[0m =[1;33m 0[0m
[1;36muse_gpu[0m =[1;33m True[0m
[1;36mseed[0m =[1;33m 2020[0m
[1;36mstate[0m =[1;33m INFO[0m
[1;36mreproducibility[0m =[1;33m True[0m
[1;36mdata_path[0m =[1;33m /alloc/data/srt/data/output/amazon-beauty[0m
[1;36mcheckpoint_dir[0m =[1;33m saved[0m
[1;36mshow_progress[0m =[1;33m True[0m
[1;36msave_dataset[0m =[1;33m False[0m
[1;36mdataset_save_path[0m =[1;33m None[0m
[1;36msave_dataloaders[0m =[1;33m False[0m
[1;36mdataloaders_save_path[0m =[1;33m None[0m
[1;36mlog_wandb[0m =[1;33m False[0m

[1;35mTraining Hyper Parameters:
[0m[1;36mepochs[0m =[1;33m 2[0m
[1;36mtrain_batch_size[0m =[1;33m 128[0m
[1;36mlearner[0m =[1;33m adam[0m
[1;36mlearning_rate[0m =[1;33m 0.0001[0m
[1;36mtrain_neg_sample_args[0m =[1;33m {'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}[0m
[1;36meval_step[0m =[1;33m 1[0m
[1;36mstopping_step[0m =[1;33m 20[0m
[1;36mclip_grad_norm[0m =[1;33m None[0m
[1;36mweight_decay[0m =[1;33m 1e-05[0m
[1;36mloss_decimal_place[0m =[1;33m 4[0m

[1;35mEvaluation Hyper Parameters:
[0m[1;36meval_args[0m =[1;33m {'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}[0m
[1;36mrepeatable[0m =[1;33m True[0m
[1;36mmetrics[0m =[1;33m ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision'][0m
[1;36mtopk[0m =[1;33m [5][0m
[1;36mvalid_metric[0m =[1;33m mrr@5[0m
[1;36mvalid_metric_bigger[0m =[1;33m True[0m
[1;36meval_batch_size[0m =[1;33m 128[0m
[1;36mmetric_decimal_place[0m =[1;33m 4[0m

[1;35mDataset Hyper Parameters:
[0m[1;36mfield_separator[0m =[1;33m 	[0m
[1;36mseq_separator[0m =[1;33m  [0m
[1;36mUSER_ID_FIELD[0m =[1;33m user_id[0m
[1;36mITEM_ID_FIELD[0m =[1;33m item_id[0m
[1;36mRATING_FIELD[0m =[1;33m rating[0m
[1;36mTIME_FIELD[0m =[1;33m timestamp[0m
[1;36mseq_len[0m =[1;33m None[0m
[1;36mLABEL_FIELD[0m =[1;33m label[0m
[1;36mthreshold[0m =[1;33m None[0m
[1;36mNEG_PREFIX[0m =[1;33m neg_[0m
[1;36mload_col[0m =[1;33m {'inter': ['user_id', 'item_id', 'rating', 'timestamp'], 'item': ['item_id', 'title', 'brand']}[0m
[1;36munload_col[0m =[1;33m None[0m
[1;36munused_col[0m =[1;33m None[0m
[1;36madditional_feat_suffix[0m =[1;33m None[0m
[1;36mrm_dup_inter[0m =[1;33m None[0m
[1;36mval_interval[0m =[1;33m None[0m
[1;36mfilter_inter_by_user_or_item[0m =[1;33m True[0m
[1;36muser_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36mitem_inter_num_interval[0m =[1;33m [0,inf)[0m
[1;36malias_of_user_id[0m =[1;33m None[0m
[1;36malias_of_item_id[0m =[1;33m None[0m
[1;36malias_of_entity_id[0m =[1;33m None[0m
[1;36malias_of_relation_id[0m =[1;33m None[0m
[1;36mpreload_weight[0m =[1;33m None[0m
[1;36mnormalize_field[0m =[1;33m None[0m
[1;36mnormalize_all[0m =[1;33m None[0m
[1;36mITEM_LIST_LENGTH_FIELD[0m =[1;33m item_length[0m
[1;36mLIST_SUFFIX[0m =[1;33m _list[0m
[1;36mMAX_ITEM_LIST_LENGTH[0m =[1;33m 50[0m
[1;36mPOSITION_FIELD[0m =[1;33m position_id[0m
[1;36mHEAD_ENTITY_ID_FIELD[0m =[1;33m head_id[0m
[1;36mTAIL_ENTITY_ID_FIELD[0m =[1;33m tail_id[0m
[1;36mRELATION_ID_FIELD[0m =[1;33m relation_id[0m
[1;36mENTITY_ID_FIELD[0m =[1;33m entity_id[0m
[1;36mbenchmark_filename[0m =[1;33m None[0m

[1;35mOther Hyper Parameters: 
[0m[1;36mworker[0m = [1;33m0[0m
[1;36mwandb_project[0m = [1;33mrecbole[0m
[1;36mshuffle[0m = [1;33mTrue[0m
[1;36mrequire_pow[0m = [1;33mFalse[0m
[1;36menable_amp[0m = [1;33mFalse[0m
[1;36menable_scaler[0m = [1;33mFalse[0m
[1;36mtransform[0m = [1;33mNone[0m
[1;36mn_layers[0m = [1;33m16[0m
[1;36mn_heads[0m = [1;33m4[0m
[1;36mhidden_size[0m = [1;33m256[0m
[1;36minner_size[0m = [1;33m256[0m
[1;36mhidden_dropout_prob[0m = [1;33m0.5[0m
[1;36mattn_dropout_prob[0m = [1;33m0.5[0m
[1;36mhidden_act[0m = [1;33mgelu[0m
[1;36mlayer_norm_eps[0m = [1;33m1e-12[0m
[1;36minitializer_range[0m = [1;33m0.02[0m
[1;36mselected_features[0m = [1;33m['title', 'brand'][0m
[1;36mpooling_mode[0m = [1;33msum[0m
[1;36mloss_type[0m = [1;33mInfoNCE-quick[0m
[1;36mnumerical_features[0m = [1;33m[][0m
[1;36mdiscretization[0m = [1;33mNone[0m
[1;36mkg_reverse_r[0m = [1;33mFalse[0m
[1;36mentity_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mrelation_kg_num_interval[0m = [1;33m[0,inf)[0m
[1;36mMODEL_TYPE[0m = [1;33mModelType.SEQUENTIAL[0m
[1;36mmlflow[0m = [1;33m{'enable': True, 'experiment_name': 'fine-tune', 'run_name': '0f5d1302-97f4-4127-9cee-a6a702a5625b', 'tracking_uri': 'sqlite:///mlruns.sqlite', 'auto_continue': True}[0m
[1;36mmax_grad_norm[0m = [1;33m1.0[0m
[1;36mscheduler[0m = [1;33m{'type': 'one-cycle'}[0m
[1;36mnce_temperature[0m = [1;33m1[0m
[1;36mnce_label_smoothing[0m = [1;33m0.0[0m
[1;36mnormalize_embedding[0m = [1;33mFalse[0m
[1;36mevaluation_mode[0m = [1;33msampled50000[0m
[1;36mestimate_batch_size[0m = [1;33mFalse[0m
[1;36mnce_num_negatives[0m = [1;33m300[0m
[1;36mnce_sampling_strategy[0m = [1;33mpopularity[0m
[1;36mnce_global_negatives[0m = [1;33mFalse[0m
[1;36mgradient_accumulation_steps[0m = [1;33m10[0m
[1;36meval_type[0m = [1;33mEvaluatorType.RANKING[0m
[1;36msingle_spec[0m = [1;33mTrue[0m
[1;36mlocal_rank[0m = [1;33m0[0m
[1;36mdevice[0m = [1;33mcuda[0m
[1;36mvalid_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m
[1;36mtest_neg_sample_args[0m = [1;33m{'distribution': 'uniform', 'sample_num': 'none'}[0m


INFO:root:[1;35m[Training]: [0m[1;36mtrain_batch_size[0m = [1;33m[128][0m[1;36m train_neg_sample_args[0m: [1;33m[{'distribution': 'none', 'sample_num': 'none', 'alpha': 'none', 'dynamic': False, 'candidate_num': 0}][0m
INFO:root:[1;35m[Evaluation]: [0m[1;36meval_batch_size[0m = [1;33m[128][0m[1;36m eval_args[0m: [1;33m[{'split': {'LS': 'valid_and_test'}, 'order': 'TO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full', 'train': 'full'}}][0m
item features
The batch_size of interaction: 504
    item_id, torch.Size([504]), cuda, torch.int64
    title, torch.Size([504, 40]), cuda, torch.int64
    brand, torch.Size([504, 7]), cuda, torch.int64


example
['‚ñÅcra' 'bt' 'ree' '‚ñÅamp' '‚ñÅevelyn' '‚ñÅgardener' '‚ñÅs' '‚ñÅultra' '‚ñÅmoistur'
 'ising' '‚ñÅhand' '‚ñÅtherapy' '‚ñÅpump' '‚ñÅ250' 'g' '‚ñÅ8' '‚ñÅ8' '‚ñÅoz' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]' '[PAD]'
 '[PAD]' '[PAD]' '[PAD]']
INFO:alembic.runtime.migration:Context impl SQLiteImpl.
INFO:alembic.runtime.migration:Will assume non-transactional DDL.
Continuing run e881606f1e3a48a18e06b815e9d7c501
tried to log param model_total_params with value 6477056 but failed
tried to log param model_non_emb_params with value -4778240 but failed
tried to log param freeze_embeddings with value False but failed
tried to log param unfreeze_n_layers with value -1 but failed
Evaluation sanity
****************************************
2024-07-10 10:53:54 pid 8350 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:53:55 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.59 seconds, [1;33mGPU RAM: 2.37 G/15.78 G[0m
2024-07-10 10:53:55 pid 8350 | finished [1;35mEvaluate in test   [0m. Total time: 0.59 seconds
OrderedDict([('recall@5', 0.1622), ('mrr@5', 0.0646), ('ndcg@5', 0.0892), ('hit@5', 0.1622), ('precision@5', 0.0324), ('test_loss', 6.281162738800049)])
****************************************
Continuing run e881606f1e3a48a18e06b815e9d7c501
2024-07-10 10:53:55 pid 8350 | starting to iterate Train     0 (total=3), updating every 1 seconds
2024-07-10 10:53:58 pid 8350 | 0 of 3, 0.0% of Train     0, speed: -0.00 s/it, elapsed 0.88 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 3.39002[0m
2024-07-10 10:53:58 pid 8350 | finished Train     0. Total time: 0.88 seconds
INFO:root:[1;32mepoch 0 training[0m [[1;34mtime[0m: 2.90s, [1;34mtrain loss[0m: 2.6163]
2024-07-10 10:53:58 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:53:58 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:53:58 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.621706008911133)])
INFO:root:[1;32mepoch 0 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.621706008911133
2024-07-10 10:53:58 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4688), ('mrr@5', 0.273), ('ndcg@5', 0.3219), ('hit@5', 0.4688), ('precision@5', 0.0937)])
2024-07-10 10:53:58 pid 8350 | starting to iterate Train     1 (total=3), updating every 1 seconds
2024-07-10 10:54:01 pid 8350 | 0 of 3, 0.0% of Train     1, speed: -0.00 s/it, elapsed 0.88 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 3.11266[0m
2024-07-10 10:54:01 pid 8350 | finished Train     1. Total time: 0.88 seconds
INFO:root:[1;32mepoch 1 training[0m [[1;34mtime[0m: 2.85s, [1;34mtrain loss[0m: 2.2934]
2024-07-10 10:54:01 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:54:01 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:54:01 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.5311994552612305)])
INFO:root:[1;32mepoch 1 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.5311994552612305
2024-07-10 10:54:01 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4766), ('mrr@5', 0.2753), ('ndcg@5', 0.3254), ('hit@5', 0.4766), ('precision@5', 0.0953)])
2024-07-10 10:54:01 pid 8350 | starting to iterate Train     2 (total=3), updating every 1 seconds
2024-07-10 10:54:04 pid 8350 | 0 of 3, 0.0% of Train     2, speed: -0.00 s/it, elapsed 0.88 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 2.71251[0m
2024-07-10 10:54:04 pid 8350 | finished Train     2. Total time: 0.88 seconds
INFO:root:[1;32mepoch 2 training[0m [[1;34mtime[0m: 2.83s, [1;34mtrain loss[0m: 2.1416]
2024-07-10 10:54:04 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:54:04 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:54:04 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.572595596313477)])
INFO:root:[1;32mepoch 2 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.572595596313477
2024-07-10 10:54:04 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4766), ('mrr@5', 0.2753), ('ndcg@5', 0.3254), ('hit@5', 0.4766), ('precision@5', 0.0953)])
2024-07-10 10:54:04 pid 8350 | starting to iterate Train     3 (total=3), updating every 1 seconds
2024-07-10 10:54:07 pid 8350 | 0 of 3, 0.0% of Train     3, speed: -0.00 s/it, elapsed 0.93 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 2.70391[0m
2024-07-10 10:54:07 pid 8350 | finished Train     3. Total time: 0.93 seconds
INFO:root:[1;32mepoch 3 training[0m [[1;34mtime[0m: 2.87s, [1;34mtrain loss[0m: 2.3722]
2024-07-10 10:54:07 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:54:07 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:54:07 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.552153587341309)])
INFO:root:[1;32mepoch 3 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.552153587341309
2024-07-10 10:54:07 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4688), ('mrr@5', 0.2737), ('ndcg@5', 0.3224), ('hit@5', 0.4688), ('precision@5', 0.0937)])
2024-07-10 10:54:07 pid 8350 | starting to iterate Train     4 (total=3), updating every 1 seconds
2024-07-10 10:54:10 pid 8350 | 0 of 3, 0.0% of Train     4, speed: -0.00 s/it, elapsed 0.89 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 2.89955[0m
2024-07-10 10:54:10 pid 8350 | finished Train     4. Total time: 0.89 seconds
INFO:root:[1;32mepoch 4 training[0m [[1;34mtime[0m: 2.86s, [1;34mtrain loss[0m: 2.6485]
2024-07-10 10:54:10 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:54:10 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:54:10 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.6119065284729)])
INFO:root:[1;32mepoch 4 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.6119065284729
2024-07-10 10:54:10 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4766), ('mrr@5', 0.2753), ('ndcg@5', 0.3254), ('hit@5', 0.4766), ('precision@5', 0.0953)])
2024-07-10 10:54:11 pid 8350 | starting to iterate Train     5 (total=3), updating every 1 seconds
2024-07-10 10:54:13 pid 8350 | 0 of 3, 0.0% of Train     5, speed: -0.00 s/it, elapsed 0.88 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 3.21990[0m
2024-07-10 10:54:13 pid 8350 | finished Train     5. Total time: 0.88 seconds
INFO:root:[1;32mepoch 5 training[0m [[1;34mtime[0m: 2.85s, [1;34mtrain loss[0m: 3.0035]
2024-07-10 10:54:13 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:54:14 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:54:14 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.631728172302246)])
INFO:root:[1;32mepoch 5 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.631728172302246
2024-07-10 10:54:14 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4688), ('mrr@5', 0.2783), ('ndcg@5', 0.3258), ('hit@5', 0.4688), ('precision@5', 0.0937)])
2024-07-10 10:54:14 pid 8350 | starting to iterate Train     6 (total=3), updating every 1 seconds
2024-07-10 10:54:17 pid 8350 | 0 of 3, 0.0% of Train     6, speed: -0.00 s/it, elapsed 0.88 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 3.62756[0m
2024-07-10 10:54:17 pid 8350 | finished Train     6. Total time: 0.88 seconds
INFO:root:[1;32mepoch 6 training[0m [[1;34mtime[0m: 2.83s, [1;34mtrain loss[0m: 3.3632]
2024-07-10 10:54:17 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:54:17 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:54:17 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.814406394958496)])
INFO:root:[1;32mepoch 6 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.814406394958496
2024-07-10 10:54:17 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4688), ('mrr@5', 0.2796), ('ndcg@5', 0.3269), ('hit@5', 0.4688), ('precision@5', 0.0937)])
2024-07-10 10:54:17 pid 8350 | starting to iterate Train     7 (total=3), updating every 1 seconds
2024-07-10 10:54:20 pid 8350 | 0 of 3, 0.0% of Train     7, speed: -0.00 s/it, elapsed 1.03 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 3.87467[0m
2024-07-10 10:54:20 pid 8350 | finished Train     7. Total time: 1.03 seconds
INFO:root:[1;32mepoch 7 training[0m [[1;34mtime[0m: 2.98s, [1;34mtrain loss[0m: 3.7969]
2024-07-10 10:54:20 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:54:20 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:54:20 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.663121223449707)])
INFO:root:[1;32mepoch 7 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.663121223449707
2024-07-10 10:54:20 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4766), ('mrr@5', 0.2811), ('ndcg@5', 0.3299), ('hit@5', 0.4766), ('precision@5', 0.0953)])
2024-07-10 10:54:20 pid 8350 | starting to iterate Train     8 (total=3), updating every 1 seconds
2024-07-10 10:54:23 pid 8350 | 0 of 3, 0.0% of Train     8, speed: -0.00 s/it, elapsed 0.89 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 4.02906[0m
2024-07-10 10:54:23 pid 8350 | finished Train     8. Total time: 0.89 seconds
INFO:root:[1;32mepoch 8 training[0m [[1;34mtime[0m: 2.84s, [1;34mtrain loss[0m: 4.0950]
2024-07-10 10:54:23 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:54:23 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:54:23 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.7208685874938965)])
INFO:root:[1;32mepoch 8 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.7208685874938965
2024-07-10 10:54:23 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4844), ('mrr@5', 0.2879), ('ndcg@5', 0.3368), ('hit@5', 0.4844), ('precision@5', 0.0969)])
2024-07-10 10:54:23 pid 8350 | starting to iterate Train     9 (total=3), updating every 1 seconds
2024-07-10 10:54:26 pid 8350 | 0 of 3, 0.0% of Train     9, speed: -0.00 s/it, elapsed 0.87 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 4.07814[0m
2024-07-10 10:54:26 pid 8350 | finished Train     9. Total time: 0.87 seconds
INFO:root:[1;32mepoch 9 training[0m [[1;34mtime[0m: 2.83s, [1;34mtrain loss[0m: 4.3808]
2024-07-10 10:54:26 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:54:26 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:54:26 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.704305171966553)])
INFO:root:[1;32mepoch 9 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.704305171966553
2024-07-10 10:54:26 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.4922), ('mrr@5', 0.2951), ('ndcg@5', 0.3441), ('hit@5', 0.4922), ('precision@5', 0.0984)])
2024-07-10 10:54:26 pid 8350 | starting to iterate Train    10 (total=3), updating every 1 seconds
2024-07-10 10:54:29 pid 8350 | 0 of 3, 0.0% of Train    10, speed: -0.00 s/it, elapsed 0.87 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 4.38239[0m
2024-07-10 10:54:29 pid 8350 | finished Train    10. Total time: 0.87 seconds
INFO:root:[1;32mepoch 10 training[0m [[1;34mtime[0m: 2.85s, [1;34mtrain loss[0m: 4.1848]
2024-07-10 10:54:29 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:54:29 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:54:29 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.589193820953369)])
INFO:root:[1;32mepoch 10 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.589193820953369
2024-07-10 10:54:29 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.5078), ('mrr@5', 0.3104), ('ndcg@5', 0.3596), ('hit@5', 0.5078), ('precision@5', 0.1016)])
2024-07-10 10:54:30 pid 8350 | starting to iterate Train    11 (total=3), updating every 1 seconds
2024-07-10 10:54:32 pid 8350 | 0 of 3, 0.0% of Train    11, speed: -0.00 s/it, elapsed 0.88 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 4.13708[0m
2024-07-10 10:54:32 pid 8350 | finished Train    11. Total time: 0.88 seconds
INFO:root:[1;32mepoch 11 training[0m [[1;34mtime[0m: 2.86s, [1;34mtrain loss[0m: 4.1446]
2024-07-10 10:54:32 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:54:32 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:54:32 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0431), ('ndcg@5', 0.0749), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.424233436584473)])
INFO:root:[1;32mepoch 11 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.043100]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0431    ndcg@5 : 0.0749    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.424233436584473
2024-07-10 10:54:33 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.5156), ('mrr@5', 0.3124), ('ndcg@5', 0.3629), ('hit@5', 0.5156), ('precision@5', 0.1031)])
2024-07-10 10:54:33 pid 8350 | starting to iterate Train    12 (total=3), updating every 1 seconds
2024-07-10 10:54:35 pid 8350 | 0 of 3, 0.0% of Train    12, speed: -0.00 s/it, elapsed 0.88 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 4.21661[0m
2024-07-10 10:54:35 pid 8350 | finished Train    12. Total time: 0.88 seconds
INFO:root:[1;32mepoch 12 training[0m [[1;34mtime[0m: 2.83s, [1;34mtrain loss[0m: 4.2459]
2024-07-10 10:54:36 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:54:36 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:54:36 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1765), ('mrr@5', 0.0529), ('ndcg@5', 0.0826), ('hit@5', 0.1765), ('precision@5', 0.0353), ('valid_loss', 6.503111362457275)])
INFO:root:[1;32mepoch 12 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.052900]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1765    mrr@5 : 0.0529    ndcg@5 : 0.0826    hit@5 : 0.1765    precision@5 : 0.0353    valid_loss : 6.503111362457275
2024-07-10 10:54:36 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.5078), ('mrr@5', 0.3141), ('ndcg@5', 0.3624), ('hit@5', 0.5078), ('precision@5', 0.1016)])
2024-07-10 10:54:36 pid 8350 | starting to iterate Train    13 (total=3), updating every 1 seconds
2024-07-10 10:54:39 pid 8350 | 0 of 3, 0.0% of Train    13, speed: -0.00 s/it, elapsed 0.88 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 4.04202[0m
2024-07-10 10:54:39 pid 8350 | finished Train    13. Total time: 0.88 seconds
INFO:root:[1;32mepoch 13 training[0m [[1;34mtime[0m: 2.90s, [1;34mtrain loss[0m: 4.0219]
2024-07-10 10:54:39 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:54:39 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:54:39 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0412), ('ndcg@5', 0.0599), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.490060806274414)])
INFO:root:[1;32mepoch 13 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.041200]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0412    ndcg@5 : 0.0599    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.490060806274414
2024-07-10 10:54:39 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.5156), ('mrr@5', 0.326), ('ndcg@5', 0.3731), ('hit@5', 0.5156), ('precision@5', 0.1031)])
2024-07-10 10:54:39 pid 8350 | starting to iterate Train    14 (total=3), updating every 1 seconds
2024-07-10 10:54:42 pid 8350 | 0 of 3, 0.0% of Train    14, speed: -0.00 s/it, elapsed 0.88 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 4.01189[0m
2024-07-10 10:54:42 pid 8350 | finished Train    14. Total time: 0.88 seconds
INFO:root:[1;32mepoch 14 training[0m [[1;34mtime[0m: 2.83s, [1;34mtrain loss[0m: 4.0430]
2024-07-10 10:54:42 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:54:42 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:54:42 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.5357890129089355)])
INFO:root:[1;32mepoch 14 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.5357890129089355
2024-07-10 10:54:42 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.5391), ('mrr@5', 0.3441), ('ndcg@5', 0.3924), ('hit@5', 0.5391), ('precision@5', 0.1078)])
2024-07-10 10:54:42 pid 8350 | starting to iterate Train    15 (total=3), updating every 1 seconds
2024-07-10 10:54:45 pid 8350 | 0 of 3, 0.0% of Train    15, speed: -0.00 s/it, elapsed 0.88 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 3.94631[0m
2024-07-10 10:54:45 pid 8350 | finished Train    15. Total time: 0.88 seconds
INFO:root:[1;32mepoch 15 training[0m [[1;34mtime[0m: 2.82s, [1;34mtrain loss[0m: 3.9603]
2024-07-10 10:54:45 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:54:45 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:54:45 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0314), ('ndcg@5', 0.0522), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.779070854187012)])
INFO:root:[1;32mepoch 15 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.031400]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0314    ndcg@5 : 0.0522    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.779070854187012
2024-07-10 10:54:45 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.5625), ('mrr@5', 0.3529), ('ndcg@5', 0.4046), ('hit@5', 0.5625), ('precision@5', 0.1125)])
2024-07-10 10:54:45 pid 8350 | starting to iterate Train    16 (total=3), updating every 1 seconds
2024-07-10 10:54:48 pid 8350 | 0 of 3, 0.0% of Train    16, speed: -0.00 s/it, elapsed 0.89 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 3.98396[0m
2024-07-10 10:54:48 pid 8350 | finished Train    16. Total time: 0.89 seconds
INFO:root:[1;32mepoch 16 training[0m [[1;34mtime[0m: 2.85s, [1;34mtrain loss[0m: 4.0248]
2024-07-10 10:54:48 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:54:48 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:54:48 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.66882848739624)])
INFO:root:[1;32mepoch 16 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.66882848739624
2024-07-10 10:54:48 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.5625), ('mrr@5', 0.3566), ('ndcg@5', 0.4075), ('hit@5', 0.5625), ('precision@5', 0.1125)])
2024-07-10 10:54:48 pid 8350 | starting to iterate Train    17 (total=3), updating every 1 seconds
2024-07-10 10:54:51 pid 8350 | 0 of 3, 0.0% of Train    17, speed: -0.00 s/it, elapsed 0.89 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 3.64733[0m
2024-07-10 10:54:51 pid 8350 | finished Train    17. Total time: 0.89 seconds
INFO:root:[1;32mepoch 17 training[0m [[1;34mtime[0m: 2.85s, [1;34mtrain loss[0m: 3.8964]
2024-07-10 10:54:51 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:54:51 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:54:51 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0343), ('ndcg@5', 0.0547), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.534302234649658)])
INFO:root:[1;32mepoch 17 evaluating[0m [[1;34mtime[0m: 0.13s, [1;34mvalid_score[0m: 0.034300]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0343    ndcg@5 : 0.0547    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.534302234649658
2024-07-10 10:54:51 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.5859), ('mrr@5', 0.359), ('ndcg@5', 0.415), ('hit@5', 0.5859), ('precision@5', 0.1172)])
2024-07-10 10:54:51 pid 8350 | starting to iterate Train    18 (total=3), updating every 1 seconds
2024-07-10 10:54:54 pid 8350 | 0 of 3, 0.0% of Train    18, speed: -0.00 s/it, elapsed 0.87 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 3.88755[0m
2024-07-10 10:54:54 pid 8350 | finished Train    18. Total time: 0.87 seconds
INFO:root:[1;32mepoch 18 training[0m [[1;34mtime[0m: 2.82s, [1;34mtrain loss[0m: 3.8559]
2024-07-10 10:54:54 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:54:54 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:54:54 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0392), ('ndcg@5', 0.0588), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.883029460906982)])
INFO:root:[1;32mepoch 18 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.039200]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0392    ndcg@5 : 0.0588    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.883029460906982
2024-07-10 10:54:54 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.5938), ('mrr@5', 0.3685), ('ndcg@5', 0.4242), ('hit@5', 0.5938), ('precision@5', 0.1187)])
2024-07-10 10:54:55 pid 8350 | starting to iterate Train    19 (total=3), updating every 1 seconds
2024-07-10 10:54:57 pid 8350 | 0 of 3, 0.0% of Train    19, speed: -0.00 s/it, elapsed 0.90 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 3.76554[0m
2024-07-10 10:54:57 pid 8350 | finished Train    19. Total time: 0.90 seconds
INFO:root:[1;32mepoch 19 training[0m [[1;34mtime[0m: 2.85s, [1;34mtrain loss[0m: 3.7053]
2024-07-10 10:54:57 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:54:58 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:54:58 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0392), ('ndcg@5', 0.0588), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.700685977935791)])
INFO:root:[1;32mepoch 19 evaluating[0m [[1;34mtime[0m: 0.15s, [1;34mvalid_score[0m: 0.039200]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0392    ndcg@5 : 0.0588    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.700685977935791
2024-07-10 10:54:58 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.6016), ('mrr@5', 0.3786), ('ndcg@5', 0.4339), ('hit@5', 0.6016), ('precision@5', 0.1203)])
2024-07-10 10:54:58 pid 8350 | starting to iterate Train    20 (total=3), updating every 1 seconds
2024-07-10 10:55:01 pid 8350 | 0 of 3, 0.0% of Train    20, speed: -0.00 s/it, elapsed 1.04 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 3.79579[0m
2024-07-10 10:55:01 pid 8350 | finished Train    20. Total time: 1.04 seconds
INFO:root:[1;32mepoch 20 training[0m [[1;34mtime[0m: 3.01s, [1;34mtrain loss[0m: 3.7685]
2024-07-10 10:55:01 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:55:01 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:55:01 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0392), ('ndcg@5', 0.0588), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.610528945922852)])
INFO:root:[1;32mepoch 20 evaluating[0m [[1;34mtime[0m: 0.15s, [1;34mvalid_score[0m: 0.039200]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0392    ndcg@5 : 0.0588    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.610528945922852
2024-07-10 10:55:01 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.5938), ('mrr@5', 0.3823), ('ndcg@5', 0.4351), ('hit@5', 0.5938), ('precision@5', 0.1187)])
2024-07-10 10:55:01 pid 8350 | starting to iterate Train    21 (total=3), updating every 1 seconds
2024-07-10 10:55:04 pid 8350 | 0 of 3, 0.0% of Train    21, speed: -0.00 s/it, elapsed 0.89 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 3.71487[0m
2024-07-10 10:55:04 pid 8350 | finished Train    21. Total time: 0.89 seconds
INFO:root:[1;32mepoch 21 training[0m [[1;34mtime[0m: 2.85s, [1;34mtrain loss[0m: 3.7123]
2024-07-10 10:55:04 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:55:04 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:55:04 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0392), ('ndcg@5', 0.0588), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.907464981079102)])
INFO:root:[1;32mepoch 21 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.039200]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0392    ndcg@5 : 0.0588    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.907464981079102
2024-07-10 10:55:04 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.6172), ('mrr@5', 0.3863), ('ndcg@5', 0.4437), ('hit@5', 0.6172), ('precision@5', 0.1234)])
2024-07-10 10:55:04 pid 8350 | starting to iterate Train    22 (total=3), updating every 1 seconds
2024-07-10 10:55:07 pid 8350 | 0 of 3, 0.0% of Train    22, speed: -0.00 s/it, elapsed 0.88 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 3.66449[0m
2024-07-10 10:55:07 pid 8350 | finished Train    22. Total time: 0.88 seconds
INFO:root:[1;32mepoch 22 training[0m [[1;34mtime[0m: 2.83s, [1;34mtrain loss[0m: 3.6130]
2024-07-10 10:55:07 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:55:07 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:55:07 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.0392), ('ndcg@5', 0.0588), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.818894386291504)])
INFO:root:[1;32mepoch 22 evaluating[0m [[1;34mtime[0m: 0.15s, [1;34mvalid_score[0m: 0.039200]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.0392    ndcg@5 : 0.0588    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.818894386291504
2024-07-10 10:55:07 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.625), ('mrr@5', 0.4018), ('ndcg@5', 0.4571), ('hit@5', 0.625), ('precision@5', 0.125)])
2024-07-10 10:55:07 pid 8350 | starting to iterate Train    23 (total=3), updating every 1 seconds
2024-07-10 10:55:10 pid 8350 | 0 of 3, 0.0% of Train    23, speed: -0.00 s/it, elapsed 0.89 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 3.47123[0m
2024-07-10 10:55:10 pid 8350 | finished Train    23. Total time: 0.89 seconds
INFO:root:[1;32mepoch 23 training[0m [[1;34mtime[0m: 2.85s, [1;34mtrain loss[0m: 3.5119]
2024-07-10 10:55:10 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:55:10 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:55:10 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.049), ('ndcg@5', 0.0665), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.589221000671387)])
INFO:root:[1;32mepoch 23 evaluating[0m [[1;34mtime[0m: 0.15s, [1;34mvalid_score[0m: 0.049000]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.049    ndcg@5 : 0.0665    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.589221000671387
2024-07-10 10:55:10 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.625), ('mrr@5', 0.4085), ('ndcg@5', 0.4624), ('hit@5', 0.625), ('precision@5', 0.125)])
2024-07-10 10:55:11 pid 8350 | starting to iterate Train    24 (total=3), updating every 1 seconds
2024-07-10 10:55:13 pid 8350 | 0 of 3, 0.0% of Train    24, speed: -0.00 s/it, elapsed 0.88 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 3.57288[0m
2024-07-10 10:55:13 pid 8350 | finished Train    24. Total time: 0.88 seconds
INFO:root:[1;32mepoch 24 training[0m [[1;34mtime[0m: 2.85s, [1;34mtrain loss[0m: 3.5577]
2024-07-10 10:55:13 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:55:13 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:55:13 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.049), ('ndcg@5', 0.0665), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.657270431518555)])
INFO:root:[1;32mepoch 24 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.049000]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.049    ndcg@5 : 0.0665    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.657270431518555
2024-07-10 10:55:14 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.6406), ('mrr@5', 0.4126), ('ndcg@5', 0.4693), ('hit@5', 0.6406), ('precision@5', 0.1281)])
2024-07-10 10:55:14 pid 8350 | starting to iterate Train    25 (total=3), updating every 1 seconds
2024-07-10 10:55:16 pid 8350 | 0 of 3, 0.0% of Train    25, speed: -0.00 s/it, elapsed 0.89 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 3.44895[0m
2024-07-10 10:55:16 pid 8350 | finished Train    25. Total time: 0.89 seconds
INFO:root:[1;32mepoch 25 training[0m [[1;34mtime[0m: 2.86s, [1;34mtrain loss[0m: 3.4711]
2024-07-10 10:55:17 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:55:17 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:55:17 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.049), ('ndcg@5', 0.0665), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.7675957679748535)])
INFO:root:[1;32mepoch 25 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.049000]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.049    ndcg@5 : 0.0665    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.7675957679748535
2024-07-10 10:55:17 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.6562), ('mrr@5', 0.4178), ('ndcg@5', 0.4771), ('hit@5', 0.6562), ('precision@5', 0.1312)])
2024-07-10 10:55:17 pid 8350 | starting to iterate Train    26 (total=3), updating every 1 seconds
2024-07-10 10:55:20 pid 8350 | 0 of 3, 0.0% of Train    26, speed: -0.00 s/it, elapsed 0.88 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 3.37466[0m
2024-07-10 10:55:20 pid 8350 | finished Train    26. Total time: 0.88 seconds
INFO:root:[1;32mepoch 26 training[0m [[1;34mtime[0m: 2.86s, [1;34mtrain loss[0m: 3.4270]
2024-07-10 10:55:20 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:55:20 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:55:20 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.049), ('ndcg@5', 0.0665), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.88186502456665)])
INFO:root:[1;32mepoch 26 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.049000]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.049    ndcg@5 : 0.0665    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.88186502456665
2024-07-10 10:55:20 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.6562), ('mrr@5', 0.4178), ('ndcg@5', 0.4771), ('hit@5', 0.6562), ('precision@5', 0.1312)])
2024-07-10 10:55:20 pid 8350 | starting to iterate Train    27 (total=3), updating every 1 seconds
2024-07-10 10:55:23 pid 8350 | 0 of 3, 0.0% of Train    27, speed: -0.00 s/it, elapsed 0.89 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 3.38597[0m
2024-07-10 10:55:23 pid 8350 | finished Train    27. Total time: 0.89 seconds
INFO:root:[1;32mepoch 27 training[0m [[1;34mtime[0m: 2.86s, [1;34mtrain loss[0m: 3.3514]
2024-07-10 10:55:23 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:55:23 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:55:23 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.049), ('ndcg@5', 0.0665), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.794556617736816)])
INFO:root:[1;32mepoch 27 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.049000]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.049    ndcg@5 : 0.0665    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.794556617736816
2024-07-10 10:55:23 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.6484), ('mrr@5', 0.4163), ('ndcg@5', 0.4743), ('hit@5', 0.6484), ('precision@5', 0.1297)])
2024-07-10 10:55:23 pid 8350 | starting to iterate Train    28 (total=3), updating every 1 seconds
2024-07-10 10:55:26 pid 8350 | 0 of 3, 0.0% of Train    28, speed: -0.00 s/it, elapsed 0.88 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 3.26231[0m
2024-07-10 10:55:26 pid 8350 | finished Train    28. Total time: 0.88 seconds
INFO:root:[1;32mepoch 28 training[0m [[1;34mtime[0m: 2.85s, [1;34mtrain loss[0m: 3.4060]
2024-07-10 10:55:26 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:55:26 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:55:26 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.049), ('ndcg@5', 0.0665), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.827244281768799)])
INFO:root:[1;32mepoch 28 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.049000]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.049    ndcg@5 : 0.0665    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.827244281768799
2024-07-10 10:55:26 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.6484), ('mrr@5', 0.4215), ('ndcg@5', 0.4783), ('hit@5', 0.6484), ('precision@5', 0.1297)])
2024-07-10 10:55:26 pid 8350 | starting to iterate Train    29 (total=3), updating every 1 seconds
2024-07-10 10:55:29 pid 8350 | 0 of 3, 0.0% of Train    29, speed: -0.00 s/it, elapsed 0.87 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 3.36474[0m
2024-07-10 10:55:29 pid 8350 | finished Train    29. Total time: 0.87 seconds
INFO:root:[1;32mepoch 29 training[0m [[1;34mtime[0m: 2.84s, [1;34mtrain loss[0m: 3.2756]
2024-07-10 10:55:29 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:55:29 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:55:29 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.049), ('ndcg@5', 0.0665), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.6913042068481445)])
INFO:root:[1;32mepoch 29 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.049000]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.049    ndcg@5 : 0.0665    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.6913042068481445
2024-07-10 10:55:29 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.6641), ('mrr@5', 0.4391), ('ndcg@5', 0.4953), ('hit@5', 0.6641), ('precision@5', 0.1328)])
2024-07-10 10:55:29 pid 8350 | starting to iterate Train    30 (total=3), updating every 1 seconds
2024-07-10 10:55:32 pid 8350 | 0 of 3, 0.0% of Train    30, speed: -0.00 s/it, elapsed 0.89 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 3.38912[0m
2024-07-10 10:55:32 pid 8350 | finished Train    30. Total time: 0.89 seconds
INFO:root:[1;32mepoch 30 training[0m [[1;34mtime[0m: 2.86s, [1;34mtrain loss[0m: 3.3222]
2024-07-10 10:55:32 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:55:32 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:55:32 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.049), ('ndcg@5', 0.0665), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.630240440368652)])
INFO:root:[1;32mepoch 30 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.049000]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.049    ndcg@5 : 0.0665    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.630240440368652
2024-07-10 10:55:32 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.6797), ('mrr@5', 0.4478), ('ndcg@5', 0.5055), ('hit@5', 0.6797), ('precision@5', 0.1359)])
2024-07-10 10:55:33 pid 8350 | starting to iterate Train    31 (total=3), updating every 1 seconds
2024-07-10 10:55:35 pid 8350 | 0 of 3, 0.0% of Train    31, speed: -0.00 s/it, elapsed 0.87 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 3.36956[0m
2024-07-10 10:55:35 pid 8350 | finished Train    31. Total time: 0.87 seconds
INFO:root:[1;32mepoch 31 training[0m [[1;34mtime[0m: 2.80s, [1;34mtrain loss[0m: 3.2043]
2024-07-10 10:55:35 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:55:35 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:55:35 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.049), ('ndcg@5', 0.0665), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.871692657470703)])
INFO:root:[1;32mepoch 31 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.049000]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.049    ndcg@5 : 0.0665    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.871692657470703
2024-07-10 10:55:35 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.7031), ('mrr@5', 0.4531), ('ndcg@5', 0.5152), ('hit@5', 0.7031), ('precision@5', 0.1406)])
2024-07-10 10:55:36 pid 8350 | starting to iterate Train    32 (total=3), updating every 1 seconds
2024-07-10 10:55:38 pid 8350 | 0 of 3, 0.0% of Train    32, speed: -0.00 s/it, elapsed 0.90 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 3.13108[0m
2024-07-10 10:55:38 pid 8350 | finished Train    32. Total time: 0.90 seconds
INFO:root:[1;32mepoch 32 training[0m [[1;34mtime[0m: 2.85s, [1;34mtrain loss[0m: 3.2898]
2024-07-10 10:55:38 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:55:39 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:55:39 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.049), ('ndcg@5', 0.0665), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 7.063464164733887)])
INFO:root:[1;32mepoch 32 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.049000]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.049    ndcg@5 : 0.0665    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 7.063464164733887
2024-07-10 10:55:39 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.7031), ('mrr@5', 0.4503), ('ndcg@5', 0.5132), ('hit@5', 0.7031), ('precision@5', 0.1406)])
2024-07-10 10:55:39 pid 8350 | starting to iterate Train    33 (total=3), updating every 1 seconds
2024-07-10 10:55:42 pid 8350 | 0 of 3, 0.0% of Train    33, speed: -0.00 s/it, elapsed 0.88 seconds, [1;31mGPU RAM: 5.49 G/15.78 G loss: 3.30265[0m
2024-07-10 10:55:42 pid 8350 | finished Train    33. Total time: 0.88 seconds
INFO:root:[1;32mepoch 33 training[0m [[1;34mtime[0m: 3.00s, [1;34mtrain loss[0m: 3.1754]
2024-07-10 10:55:42 pid 8350 | starting to iterate [1;35mEvaluate in valid   [0m (total=1), updating every 1 seconds
2024-07-10 10:55:42 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in valid   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:55:42 pid 8350 | finished [1;35mEvaluate in valid   [0m. Total time: 0.05 seconds
valid evaluation
OrderedDict([('recall@5', 0.1176), ('mrr@5', 0.049), ('ndcg@5', 0.0665), ('hit@5', 0.1176), ('precision@5', 0.0235), ('valid_loss', 6.798990726470947)])
INFO:root:[1;32mepoch 33 evaluating[0m [[1;34mtime[0m: 0.14s, [1;34mvalid_score[0m: 0.049000]
INFO:root:[1;34mvalid result[0m: 
recall@5 : 0.1176    mrr@5 : 0.049    ndcg@5 : 0.0665    hit@5 : 0.1176    precision@5 : 0.0235    valid_loss : 6.798990726470947
2024-07-10 10:55:42 pid 8350 | starting to iterate [1;35mEvaluate in train   [0m (total=3), updating every 1 seconds
train evaluation
OrderedDict([('recall@5', 0.7109), ('mrr@5', 0.4598), ('ndcg@5', 0.5224), ('hit@5', 0.7109), ('precision@5', 0.1422)])
INFO:root:Finished training, best eval result in epoch 12
Saving checkpoint on /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/final.pth
INFO:root:[1;34mSaving current[0m: /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b/final.pth
2024-07-10 10:55:42 pid 8350 | starting to iterate [1;35mEvaluate in test   [0m (total=1), updating every 1 seconds
2024-07-10 10:55:43 pid 8350 | 0 of 1, 0.0% of [1;35mEvaluate in test   [0m, speed: -0.00 s/it, elapsed 0.05 seconds, [1;33mGPU RAM: 5.49 G/15.78 G[0m
2024-07-10 10:55:43 pid 8350 | finished [1;35mEvaluate in test   [0m. Total time: 0.05 seconds
OrderedDict([('recall@5', 0.1351), ('mrr@5', 0.068), ('ndcg@5', 0.0848), ('hit@5', 0.1351), ('precision@5', 0.027), ('test_loss', 6.383182525634766)])
INFO:alembic.runtime.migration:Context impl SQLiteImpl.
INFO:alembic.runtime.migration:Will assume non-transactional DDL.
Fine-tuning done. All checkpoints saved at /alloc/data/srt/working_dir/0f5d1302-97f4-4127-9cee-a6a702a5625b
Final checkpoint saved at fine_tuned_checkpoint.pth
